{"version":3,"sources":["QuantityPricing.View.ts"],"names":[],"mappings":"AAAA;;;;;EAKE;;;IAYF,oDAAoD;IACpD,IAAM,mBAAmB,GAAQ,YAAY,CAAC,MAAM,CAAC;QACjD,gCAAgC;QAChC,QAAQ,EAAE,oBAAoB;QAE9B,4BAA4B;QAC5B,MAAM,EAAE;YACJ,8BAA8B,EAAE,iBAAiB;SACpD;QAED,qBAAqB;QACrB,sDAAsD;QACtD,iBAAiB;QACjB,UAAU,EAAE;YACR,IAAI,CAAC,YAAY,GAAG,4BAAY,CAAC,WAAW,EAAE,CAAC;YAE/C,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,CAAC;YAElD,IAAI,CAAC,cAAc,GAAG,oBAAoB,CAAC,yBAAyB,CAChE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,EACtB,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,uBAAuB,CAAC;gBAC5C,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,uBAAuB,EAAE;gBACtC,CAAC,CAAC,EAAE,CACX,CAAC;YAEF,IAAI,CAAC,KAAK,CAAC,EAAE,CACT,QAAQ,EACR;gBACI,IAAM,kBAAkB,GAAG,oBAAoB,CAAC,yBAAyB,CACrE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,EACtB,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,uBAAuB,CAAC;oBAC5C,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,uBAAuB,EAAE;oBACtC,CAAC,CAAC,EAAE,CACX,CAAC;gBAEF,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,kBAAkB,CAAC,EAAE;oBACrD,IAAI,CAAC,cAAc,GAAG,kBAAkB,CAAC;oBACzC,IAAI,CAAC,MAAM,EAAE,CAAC;iBACjB;YACL,CAAC,EACD,IAAI,CACP,CAAC;YAEF,IAAI,CAAC,QAAQ,GAAG,KAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,EAAE,GAAG,IAAI,IAAI,EAAE,CAAC,eAAe,EAAI,CAAC;QAClF,CAAC;QAED,0FAA0F;QAC1F,UAAU,EAAE,KAAK;QAEjB,8EAA8E;QAC9E,OAAO,EAAE,KAAK;QAEd,2DAA2D;QAC3D,iBAAiB;QACjB,eAAe,EAAE;YACb,IAAI,CAAC,OAAO,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC;QACjC,CAAC;QAED,qBAAqB;QACrB,yCAAyC;QACzC,UAAU,EAAE;YACR,sCAAsC;YACtC,OAAO;gBACH,kCAAkC;gBAClC,WAAW,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,eAAe;gBAC1C,kCAAkC;gBAClC,WAAW,EAAE,IAAI,CAAC,UAAU,IAAI,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM;gBAC5D,kCAAkC;gBAClC,aAAa,EAAE,IAAI,CAAC,cAAc;gBAClC,6BAA6B;gBAC7B,MAAM,EAAE,IAAI,CAAC,OAAO;gBACpB,8BAA8B;gBAC9B,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO;gBAC7B,6BAA6B;gBAC7B,OAAO,EAAE,IAAI,CAAC,QAAQ;gBACtB,2BAA2B;gBAC3B,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,IAAI,KAAK,CAAC,SAAS,CAAC,8BAA8B,CAAC;aAC/E,CAAC;YACF,8BAA8B;QAClC,CAAC;KACJ,CAAC,CAAC;IAEH,OAAS,mBAAmB,CAAC;;AAC7B,4CAA4C;AAC5C,2DAA2D;AAC3D,sCAAsC","file":"QuantityPricing.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"QuantityPricing.View\"/>\n\nimport * as _ from 'underscore';\nimport * as quantity_pricing_tpl from 'quantity_pricing.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport { ProfileModel } from '../../../Commons/Profile/JavaScript/Profile.Model';\n\nimport QuantityPricingUtils = require('./QuantityPricing.Utils');\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\n\n// @class QuantityPricing.View @extend Backbone.View\nconst QuantityPricingView: any = BackboneView.extend({\n    // @property {Function} template\n    template: quantity_pricing_tpl,\n\n    // @property {Object} events\n    events: {\n        'click [data-action=\"toggle\"]': 'toggleAccordion'\n    },\n\n    // @method initialize\n    // @param {QuantityPricing.Initialize.Options} options\n    // @return {Void}\n    initialize: function() {\n        this.profileModel = ProfileModel.getInstance();\n\n        this._isEnabled = !this.profileModel.hidePrices();\n\n        this.price_schedule = QuantityPricingUtils.rearrangeQuantitySchedule(\n            this.model.get('item'),\n            _.isFunction(this.model.getSelectedMatrixChilds)\n                ? this.model.getSelectedMatrixChilds()\n                : []\n        );\n\n        this.model.on(\n            'change',\n            function() {\n                const new_price_schedule = QuantityPricingUtils.rearrangeQuantitySchedule(\n                    this.model.get('item'),\n                    _.isFunction(this.model.getSelectedMatrixChilds)\n                        ? this.model.getSelectedMatrixChilds()\n                        : []\n                );\n\n                if (!_.isEqual(this.price_schedule, new_price_schedule)) {\n                    this.price_schedule = new_price_schedule;\n                    this.render();\n                }\n            },\n            this\n        );\n\n        this.item_key = `${this.model.get('item').id}${new Date().getMilliseconds()}`;\n    },\n\n    // @property {Boolean} _isEnabled Boolean flag that shows if we are able to show this view\n    _isEnabled: false,\n\n    // @property {Boolean} _isOpen Boolean flag about if accordion is open or not.\n    _isOpen: false,\n\n    // @method toggleAccordion Toggle the _isOpen internal flag\n    // @return {Void}\n    toggleAccordion: function() {\n        this._isOpen = !this._isOpen;\n    },\n\n    // @method getContext\n    // @return {QuantityPricing.View.Context}\n    getContext: function() {\n        // @class QuantityPricing.View.Context\n        return {\n            // @property {Boolean} isAccordion\n            isAccordion: !this.options.notUseAccordion,\n            // @property {Boolean} showContent\n            showContent: this._isEnabled && !!this.price_schedule.length,\n            // @property {Array} priceSchedule\n            priceSchedule: this.price_schedule,\n            // @property {Boolean} isOpen\n            isOpen: this._isOpen,\n            // @property {Boolean} isModal\n            isModal: this.options.isModal,\n            // @property {String} itemKey\n            itemKey: this.item_key,\n            // @property {String} title\n            title: this.options.title || Utils.translate('Quantity discounts available')\n        };\n        // @class QuantityPricing.View\n    }\n});\n\nexport = QuantityPricingView;\n// @class QuantityPricing.Initialize.Options\n// @property {Product.Model | Transaction.Line.Model} model\n// @property {Boolean} notUseAccordion\n"]}