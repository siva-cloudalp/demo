{"version":3,"sources":["GlobalViews.HostSelector.View.ts"],"names":[],"mappings":"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","file":"GlobalViews.HostSelector.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"GlobalViews.HostSelector.View\"/>\n\nimport * as _ from 'underscore';\nimport * as global_views_host_selector_tpl from 'global_views_host_selector.tpl';\nimport * as Utils from '../../Utilities/JavaScript/Utils';\nimport * as jQuery from '../../Core/JavaScript/jQuery';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\n\nimport BackboneView = require('../../BackboneExtras/JavaScript/Backbone.View');\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\n\n// @class GlobalViews.HostSelector.View @extends Backbone.View\nconst GlobalViewsHostSelectorView: any = BackboneView.extend({\n    template: global_views_host_selector_tpl,\n\n    events: {\n        'change select[data-toggle=\"host-selector\"]': 'selectHost',\n        'click select[data-toggle=\"host-selector\"]': 'selectHostClick'\n    },\n\n    // @method selectHostClick @param {HTMLEvent} e\n    selectHostClick: function(e) {\n        e.stopPropagation();\n    },\n\n    // @method selectHost @param {HTMLEvent} e\n    selectHost: function(e) {\n        this.setHost(e);\n    },\n\n    // @method setHref @param {String} url\n    setHref: function(url) {\n        window.location.href = Utils.getAbsoluteUrl(\n            `redirections.ssp?location=${!Utils.isHttpsSupported() ? 'http:' : 'https:'}//${url}`\n        );\n    },\n\n    // @method getCurrentPath @returns {String}\n    getCurrentPath: function() {\n        return location.pathname;\n    },\n\n    // @method setHost @param {HTMLEvent} e\n    setHost: function(e) {\n        const host = jQuery(e.target).val();\n        const BackboneHistory: any = Backbone.History;\n        // if _hasPushState is true\n        // Seo Engine is on, send him to the host\n        const url =\n            !BackboneHistory._hasPushState && SC.ENVIRONMENT.SCTouchpoint === 'shopping'\n                ? host + this.getCurrentPath()\n                : host;\n        // redirects to url\n        this.setHref(url);\n    },\n\n    // @method getContext @return GlobalViews.HostSelector.View.Context\n    getContext: function() {\n        const is_home_touchpoint = Configuration.currentTouchpoint === 'home';\n\n        const use_parameter = !is_home_touchpoint;\n        const current_host = is_home_touchpoint\n            ? SC.ENVIRONMENT.currentHostString\n            : SC.ENVIRONMENT.currentLanguage.locale;\n        const available_hosts: any = _.map(SC.ENVIRONMENT.availableHosts, function(host: any) {\n            // @class GlobalViews.HostSelector.View.Context.Host\n            return {\n                // @property {Boolean} hasLanguages\n                hasLanguages: host.languages && host.languages.length,\n                // @property {String} title\n                title: host.title,\n                // @property {Array<GlobalViews.HostSelector.View.Context.Host.Language>} languages\n                languages: _.map(host.languages, function(language: any) {\n                    // @class GlobalViews.HostSelector.View.Context.Host.Language\n                    return {\n                        // @property {String} host\n                        host: language.host,\n                        // @property {String} displayName\n                        displayName: language.title || language.name,\n                        // @property {Boolean} isSelected\n                        isSelected: !!(\n                            (use_parameter && language.locale === current_host) ||\n                            language.host === current_host\n                        )\n                    };\n                })\n            };\n        });\n\n        // @class GlobalViews.HostSelector.View.Context\n        return {\n            // @property {Boolean} showHosts\n            showHosts: !!(available_hosts && available_hosts.length > 1),\n            // @property {Array<GlobalViews.HostSelector.View.Context.Host>} availableHosts\n            availableHosts: available_hosts,\n            // @property {String} currentHost\n            currentHost: current_host,\n            // @param {Boolean} useParameter\n            useParameter: use_parameter\n        };\n    }\n});\n\nexport = GlobalViewsHostSelectorView;\n"]}