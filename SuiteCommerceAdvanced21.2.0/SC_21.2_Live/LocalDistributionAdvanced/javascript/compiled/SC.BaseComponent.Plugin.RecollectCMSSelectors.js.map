{"version":3,"sources":["SC.BaseComponent.Plugin.RecollectCMSSelectors.ts"],"names":[],"mappings":"AAAA;;;;;EAKE;;;;;IAYF,SAAgB,mDAAmD,CAC/D,OAAe,EACf,IAA0B;QAE1B,IAAM,KAAK,GAAG,4CAA4C,CAAC;QAC3D,IAAI,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAChC,IAAM,aAAa,GAAe,EAAE,CAAC;QACrC,IAAI,QAAkB,CAAC;QACvB,IAAM,OAAO,GAAG,UAAS,GAAa;YAClC,OAAO,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;QACpC,CAAC,CAAC;QAEF,yEAAkC,CAAC,6BAA6B,CAAC,IAAI,CAAC,CAAC;QAEvE,OAAO,KAAK,KAAK,IAAI,EAAE;YACnB,QAAQ,GAAG;gBACP,eAAe,EAAE,KAAK,CAAC,CAAC,CAAC;aAC5B,CAAC;YAEF,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,EAAE,OAAO,CAAC,EAAE;gBACjC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAChC;iBAAM;gBACH,OAAO,CAAC,IAAI,CACR,uBAAqB,yEAAkC,CAAC,gBAAgB,CACpE,QAAQ,CACX,qBAAgB,IAAI,CAAC,eAAe,EAAI,CAC5C,CAAC;aACL;YAED,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SAC/B;QAED,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1B,yEAAkC,CAAC,0BAA0B,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;SACtF;QAED,OAAO,OAAO,CAAC;IACnB,CAAC;IArCD,kHAqCC","file":"SC.BaseComponent.Plugin.RecollectCMSSelectors.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"SC.BaseComponent.Plugin.RecollectCMSSelectors\"/>\n\nimport * as _ from 'underscore';\n\nimport {\n    SCBaseComponentChildViewsComponent,\n    Selector\n} from './SC.BaseComponent.ChildViewsComponent';\nimport { View } from '../../Core/JavaScript/View';\n\nexport function scBaseComponentPluginRecollectCMSSelectorsGenerator(\n    tmplStr: string,\n    view: View<object, object>\n): string {\n    const regex = /<[^>]*(data-cms-area)=\\\"([^\"\\s]+)\\\"[^>]*>/g;\n    let match = regex.exec(tmplStr);\n    const selectorsOnUi: Selector[] = [];\n    let selector: Selector;\n    const isEqual = function(obj: Selector) {\n        return _.isEqual(obj, selector);\n    };\n\n    SCBaseComponentChildViewsComponent.unregisterViewForPlaceholders(view);\n\n    while (match !== null) {\n        selector = {\n            'data-cms-area': match[2]\n        };\n\n        if (!_.find(selectorsOnUi, isEqual)) {\n            selectorsOnUi.push(selector);\n        } else {\n            console.warn(\n                `Repeated selector ${SCBaseComponentChildViewsComponent.selectorToString(\n                    selector\n                )} in template ${view.getTemplateName()}`\n            );\n        }\n\n        match = regex.exec(tmplStr);\n    }\n\n    if (selectorsOnUi.length > 0) {\n        SCBaseComponentChildViewsComponent.registerViewForPlaceholder(selectorsOnUi, view);\n    }\n\n    return tmplStr;\n}\n"]}