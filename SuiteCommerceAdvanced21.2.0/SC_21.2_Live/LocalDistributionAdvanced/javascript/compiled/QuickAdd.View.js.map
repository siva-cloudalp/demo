{"version":3,"sources":["QuickAdd.View.ts"],"names":[],"mappings":"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","file":"QuickAdd.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"QuickAdd.View\"/>\n\nimport * as _ from 'underscore';\nimport * as quick_add_tpl from 'quick_add.tpl';\nimport * as quick_add_item_tpl from 'quick_add_item.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport { Configuration } from '../../SCA/JavaScript/Configuration';\n\nimport ItemsSearcherView = require('../../ItemsSearcher/JavaScript/ItemsSearcher.View');\nimport QuickAddModel = require('./QuickAdd.Model');\nimport QuickAddItemView = require('./QuickAdd.Item.View');\nimport QuickAddItemsSearcherPlugins = require('./QuickAdd.ItemsSearcher.Plugins');\nimport TransactionLineViewsOptionsSelectedView = require('../../../Commons/Transaction.Line.Views/JavaScript/Transaction.Line.Views.Options.Selected.View');\nimport ProductViewsPriceView = require('../../../Commons/ProductViews/JavaScript/ProductViews.Price.View');\nimport ProductLineStockView = require('../../../Commons/ProductLine/JavaScript/ProductLine.Stock.View');\nimport ProductLineSkuView = require('../../../Commons/ProductLine/JavaScript/ProductLine.Sku.View');\nimport TransactionLineModel = require('../../../Commons/Transaction/JavaScript/Transaction.Line.Model');\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\nimport BackboneFormView = require('../../../Commons/Backbone.FormView/JavaScript/Backbone.FormView');\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\n\n// @class QuickAdd.View @extends Backbone.View\nconst QuickAddView: any = BackboneView.extend({\n    // @property {Function} template\n    template: quick_add_tpl,\n\n    // @property {Object} events\n    events: {\n        'click [data-type=\"quick-add-reset\"]': 'resetHandle',\n        'submit form': 'saveForm',\n\n        'click [data-action=\"plus\"]': 'addQuantity',\n        'click [data-action=\"minus\"]': 'subQuantity',\n        'change [data-type=\"quantity-input\"]': 'setQuantity',\n        'click [data-type=\"quantity-input\"]': 'selectAll',\n        'keypress [name=\"quantity\"]': 'submitOnEnter',\n        'keydown [name=\"quantity\"]': 'onKeyDown'\n    },\n\n    // @method initialize Override default initialization method to configure inner itemsSearcher component\n    // @param {QuickAdd.View.Initialize.Options?} options\n    // @return {Void}\n    initialize: function() {\n        this.itemsSearcherComponent = new ItemsSearcherView({\n            placeholderLabel: Utils.translate('Enter SKU or Item Name'),\n            showBackorderables: this.options.showBackorderable,\n            minLength: Configuration.get('typeahead.minLength', 3),\n            maxLength: Configuration.get('searchPrefs.maxLength', 0),\n            limit: Configuration.get('typeahead.maxResults', 10),\n            sort: Configuration.get('typeahead.sort', 'relevance:desc'),\n            highlight: Configuration.get('typeahead.highlight', true),\n            componentId: 'quickaddSearch',\n            componentName: 'quickaddSearch',\n            showMenuOnClick: true,\n            showSeeAll: false,\n            collectionOptions: {\n                searcherAPIConfiguration: 'searchApiMasterOptions.itemsSearcher'\n            },\n            itemView: QuickAddItemView,\n            itemViewOptions: {\n                template: quick_add_item_tpl,\n                childViews: {\n                    'Item.Options': function(options) {\n                        return function() {\n                            return new TransactionLineViewsOptionsSelectedView({\n                                model: options.model\n                            });\n                        };\n                    },\n                    'Item.Price': function(options) {\n                        return function() {\n                            return new ProductViewsPriceView({\n                                model: options.model\n                            });\n                        };\n                    },\n                    'Item.Stock': function(options) {\n                        return function() {\n                            return new ProductLineStockView({\n                                model: options.model\n                            });\n                        };\n                    },\n                    'Item.Sku': function(options) {\n                        return function() {\n                            return new ProductLineSkuView({\n                                model: options.model\n                            });\n                        };\n                    }\n                }\n            },\n            getItemDisplayName: function(item, query) {\n                return item ? item.getSku() : query;\n            }\n        });\n        this.itemsSearcherComponent.postItemsSuggestionObtained.install(\n            QuickAddItemsSearcherPlugins.flatItemsMatrixResult\n        );\n\n        this.model = new QuickAddModel();\n        this.model.setOptions({\n            getItemQuantitySet: this.options.getItemQuantitySet,\n            validateMaxQty: this.options.validateMaxQty\n        });\n\n        this.itemsSearcherComponent.on('itemSelected', this.onItemSelected, this);\n        this.itemsSearcherComponent.on('keyUp', this.showReset, this);\n        this.itemsSearcherComponent.on('keyDown', this.cleanSearchOnEnter, this);\n\n        const original_save_form = this.saveForm;\n        BackboneFormView.add(this);\n        this.saveForm = original_save_form;\n    },\n\n    // @method saveForm Handle the current form validation and triggers the event selectedLien\n    // @param {jQueryEvent} e\n    // @return {Void}\n    saveForm: function(e) {\n        e.preventDefault();\n\n        Backbone.Validation.bind(this);\n\n        this.model.set(this.$('form').serializeObject());\n\n        const product = this.model.get('selectedProduct');\n\n        if (this.model.isValid(true) && product) {\n            product.set('quantity', parseInt(this.model.get('quantity'), 10));\n\n            const selected_line = new TransactionLineModel(product.toJSON());\n\n            selected_line.set('internalid', _.uniqueId('item_line'));\n            selected_line.set('item', product.getItem().clone());\n            selected_line.set('options', product.get('options').clone());\n\n            // if the item is a matrix we add the parent so when saving the item in a product list (request a quote case)\n            // we have the parent\n            if (product.get('item').get('_matrixChilds').length) {\n                selected_line.get('item').set('_matrixParent', product.get('item'));\n            }\n            selected_line.unset('selectedProduct');\n            selected_line.unset('quickaddSearch');\n\n            // @event {QuickAdd.View.SelectedLine.Properties} selectedLine\n            this.trigger(\n                'selectedLine',\n                // @class QuickAdd.View.SelectedLine.Properties\n                {\n                    // @property {Transaction.Line.Model} selectedLine\n                    selectedLine: selected_line\n                }\n            );\n            // @class QuickAdd.View\n\n            this.$('[name=\"quantity\"]').val('');\n            this.$('[name=\"quantity\"]').attr({ min: 1 });\n            this.$('[data-type=\"quick-add-reset\"]').hide();\n            this.itemsSearcherComponent.cleanSearch();\n            this.itemsSearcherComponent.setFocus();\n        }\n    },\n\n    // @method setQuantity Update by removing 1 to the current quantity of the current line\n    // @param {jQuery.Event} e\n    // @return {Void}\n    setQuantity: function(e) {\n        if (this.model.get('selectedProduct')) {\n            const str_quantity = this.$(e.target).val();\n            const quantity = parseInt(str_quantity, 10);\n            const minimum_quantity = this.model\n                .get('selectedProduct')\n                .get('item')\n                .get('_minimumQuantity', true);\n            const maximum_quantity = this.model\n                .get('selectedProduct')\n                .get('item')\n                .get('_maximumQuantity', true);\n            let quantity_already_set = 0;\n\n            if (_.isFunction(this.options.getItemQuantitySet)) {\n                quantity_already_set =\n                    this.options.getItemQuantitySet(\n                        this.model.get('selectedProduct').getItemId()\n                    ) || 0;\n            }\n\n            if (!_.isNaN(quantity) && _.isNumber(quantity)) {\n                if (quantity_already_set + quantity < minimum_quantity) {\n                    if (\n                        !maximum_quantity ||\n                        (!!maximum_quantity && quantity + quantity_already_set < maximum_quantity)\n                    ) {\n                        this.$('[data-type=\"quantity-input\"]').val(minimum_quantity);\n                    }\n                }\n            }\n        }\n    },\n\n    // @method addQuantity Increase the product's Quantity by 1\n    // @param {jQuery.Event} e\n    // @return {Void}\n    addQuantity: function(e) {\n        e.preventDefault();\n\n        const $element = this.$(e.target);\n        const quantity_input = $element.parent().find('input');\n        const old_value = quantity_input.val();\n        const max_quantity = this.model\n            .get('selectedProduct')\n            .get('item')\n            .get('_maximumQuantity', true);\n        let new_val = parseFloat(old_value) + 1;\n\n        new_val = !!max_quantity && new_val > max_quantity ? max_quantity : new_val;\n\n        quantity_input.val(new_val);\n        quantity_input.change();\n    },\n\n    // @method subQuantity Decreases the product's Quantity by 1\n    // @param {jQuery.Event} e\n    // @return {Void}\n    subQuantity: function(e) {\n        e.preventDefault();\n\n        const $element = this.$(e.target);\n        const quantity_input = $element.parent().find('input');\n        const old_value = quantity_input.val();\n        let new_val = parseFloat(old_value) - 1;\n\n        new_val = Math.max(\n            this.model\n                .get('selectedProduct')\n                .get('item')\n                .get('_minimumQuantity', true),\n            new_val\n        );\n\n        quantity_input.val(new_val);\n        quantity_input.change();\n    },\n\n    // @method showReset Handle when to show or hide the reset button\n    // @param {ItemsSearcher.View.KeyDown.Properties} event_properties\n    // @return {Void}\n    showReset: function(event_properties) {\n        if (event_properties.currentQuery) {\n            this.$('[data-type=\"quick-add-reset\"]').show();\n        } else {\n            this.$('[data-type=\"quick-add-reset\"]').hide();\n        }\n    },\n\n    // @method cleanSearchOnEnter Cleans the current search status\n    // @param {ItemsSearcher.View.KeyDown.Properties} event_properties\n    // @return {Void}\n    cleanSearchOnEnter: function(event_properties) {\n        if (event_properties.eventObject.keyCode === 27) {\n            this.$('[data-type=\"quick-add-reset\"]').hide();\n            this.itemsSearcherComponent.cleanSearch();\n        }\n    },\n\n    // @method onKeyDown Prevent letter e & other characters in \"type=number\" and allow arrows\n    // @param {jQueryEvent} e\n    // @return {Void}\n    onKeyDown: function(e) {\n        const jq_event: any = event;\n        const key_code = e.which ? e.which : jq_event.keyCode;\n\n        if (\n            key_code > 31 &&\n            (key_code < 48 || key_code > 57) &&\n            !(key_code >= 37 || key_code <= 40)\n        ) {\n            e.preventDefault();\n        }\n    },\n\n    // @method submitOnEnter Submit the form when user presses enter in the quantity input text\n    // @param {jQuery.Event} e\n    // @return {Void}\n    submitOnEnter: function(e) {\n        if (e.keyCode === 13) {\n            this.itemsSearcherComponent.setFocus();\n        }\n    },\n\n    // @method resetHandle Handle the reset action by hiding it and cleaning the current search status\n    // @return {Void}\n    resetHandle: function() {\n        this.$('[data-type=\"quick-add-reset\"]').hide();\n        this.itemsSearcherComponent.cleanSearch();\n        this.$('[name=\"quantity\"]').val('');\n    },\n\n    // @method selectAll on focus select all input value\n    // @return {Void}\n    selectAll: function() {\n        this.$('[name=\"quantity\"]').select();\n    },\n\n    // @method onItemSelected Handle the selection of an item of the type-ahead result\n    // @param {ItemsSearcher.View.itemSelected.Properties} result\n    // @return {Void}\n    onItemSelected: function(result) {\n        // As the item searcher has been thought to work with items the property is called selectedItem, but we changed in the installed\n        // plugin to use Products\n        const product = result.selectedItem;\n        let item;\n\n        if (product) {\n            item = product.getItem();\n\n            this.model.set('quickaddSearch', item.get('_name'));\n            this.model.set('selectedProduct', product);\n\n            this.setDefaultQuantity(item.get('_minimumQuantity', true), item.get('internalid'));\n            this.$('[name=\"quantity\"]').focus();\n            this.selectAll();\n\n            const minimum_quantity = item.get('_minimumQuantity', true);\n\n            if (minimum_quantity > 1) {\n                this.$('[data-type=\"minimum-quantity\"]').html(\n                    Utils.translate('Minimum of $(0) required', minimum_quantity)\n                );\n            }\n\n            this.$('[data-validation-error=\"block\"]').remove();\n        } else {\n            this.model.unset('selectedProduct');\n            this.$('[data-type=\"minimum-quantity\"]').empty();\n        }\n    },\n\n    // @method setDefaultQuantity Set the default quantity based on the minimum quantity for the selected item and\n    // also validate the other items into the \"cart\" or cart-like\n    // @param {Number} minimum_quantity\n    // @param {Number} item_id\n    // @return {Void}\n    setDefaultQuantity: function(minimum_quantity, item_id) {\n        const current_quantity = parseInt(this.$('[name=\"quantity\"]').val(), 10);\n\n        this.$('[name=\"quantity\"]').select();\n\n        if (_.isFunction(this.options.getItemQuantitySet)) {\n            minimum_quantity -= this.options.getItemQuantitySet(item_id) || 0;\n        }\n\n        minimum_quantity = minimum_quantity <= 0 ? 1 : minimum_quantity;\n\n        if (\n            !_.isNumber(current_quantity) ||\n            _.isNaN(current_quantity) ||\n            current_quantity < minimum_quantity\n        ) {\n            this.model.set('quantity', minimum_quantity);\n            this.$('[name=\"quantity\"]').val(minimum_quantity);\n            this.$('[name=\"quantity\"]').attr('min', minimum_quantity);\n        }\n    },\n\n    // @property {ChildViews} childViews\n    childViews: {\n        ItemsSearcher: function() {\n            return this.itemsSearcherComponent;\n        }\n    },\n\n    // @method getContext\n    // @return {QuickAdd.View.Context}\n    getContext: function() {\n        // @class QuickAdd.View.Context\n        return {\n            // @property {String} itemTitle\n            itemTitle:\n                this.options.itemTitle || Utils.translate('Which item(s) would you like to add?'),\n            // @property {String} quantityTitle\n            quantityTitle: this.options.quantityTitle || Utils.translate('Quantity')\n        };\n        // @class QuickAdd.View\n    }\n});\n\nexport = QuickAddView;\n\n// @class QuickAdd.View.Initialize.Options\n// @property {String?} itemTitle Allows to specify the title used for the items sub-component\n// @property {String?} quantityTitle Allows to specify the title used for the quantity input\n// @property {Function<Number,Number>} getItemQuantitySet Function that given an item id returns how many item already are present in the cart-like.\n// This work to decouple this component of any other concrete implementation.\n// IMPORTANT: If the passed in item id is not in the cart-like this function must return 0 (the number zero).\n"]}