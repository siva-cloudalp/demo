{"version":3,"sources":["PaymentWizard.Module.ShowInvoices.ts"],"names":[],"mappings":"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","file":"PaymentWizard.Module.ShowInvoices.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"PaymentWizard.Module.ShowInvoices\"/>\n\nimport * as _ from 'underscore';\nimport * as payment_wizard_showinvoices_module_tpl from 'payment_wizard_showinvoices_module.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { WizardStepModule } from '../../Wizard/JavaScript/Wizard.StepModule';\n\nimport InvoiceCollection = require('../../Invoice/JavaScript/Invoice.Collection');\n\n// @class PaymentWizard.Module.ShowInvoices @extend Wizard.Module\nconst PaymentWizardModuleShowInvoices: any = WizardStepModule.extend({\n    template: payment_wizard_showinvoices_module_tpl,\n\n    className: 'PaymentWizard.Module.ShowInvoices',\n\n    initialize: function(options) {\n        this.wizard = options.wizard;\n        this.wizard.model.on('change:confirmation', jQuery.proxy(this, 'render'));\n    },\n\n    render: function() {\n        if (this.wizard.model.get('confirmation')) {\n            this.invoices = new InvoiceCollection(\n                _.where(this.wizard.model.get('confirmation').invoices, { apply: true })\n            );\n        } else {\n            this.invoices = this.wizard.model.getSelectedInvoices();\n            this.wizard.model.calculeTotal();\n        }\n        this._render();\n    },\n\n    // @method getContext @return {PaymentWizard.Module.ShowInvoices.Context}\n    getContext: function() {\n        const self = this;\n\n        if (this.wizard.model.get('currency_symbol')) {\n            this.currencySymbol = this.wizard.model.get('currency_symbol');\n        } else {\n            const invoices = this.wizard.model.get('invoices');\n\n            if (invoices.length) {\n                const currency = Utils.getCurrencyByName(invoices.first().get('currency'));\n                if (currency) {\n                    this.currencySymbol = currency.symbol;\n                }\n            }\n        }\n\n        const invoices_to_show = this.invoices.map(function(invoice) {\n            const invoice_number = invoice.get('tranid') || invoice.get('refnum');\n            // @class PaymentWizard.Module.ShowInvoices.Invoice.Record\n            return {\n                // @property {String} title\n                title: invoice_number\n                    ? Utils.translate('Invoice #$(0)', invoice_number)\n                    : Utils.translate('Invoice'),\n                // @property {String} id\n                id: invoice.get('internalid'),\n                // @property {String} amountFormatted\n                amountFormatted: Utils.formatCurrency(invoice.get('amount'), self.currencySymbol)\n            };\n        });\n\n        // @class PaymentWizard.Module.ShowInvoices.Context\n        return {\n            // @property {Number} invoicesLength\n            invoicesLength: this.invoices.length,\n            // @property {String} invoicesTotalFormatted\n            invoicesTotalFormatted: this.wizard.model.get('confirmation')\n                ? Utils.formatCurrency(\n                      this.wizard.model.get('confirmation').invoices_total,\n                      self.currencySymbol\n                  )\n                : Utils.formatCurrency(\n                      this.wizard.model.get('invoices_total'),\n                      self.currencySymbol\n                  ),\n            // @property {Array<PaymentWizard.Module.ShowInvoices.Invoice.Record>} invoices\n            invoices: invoices_to_show,\n            // @property {Boolean} showOpenedAccordion\n            showOpenedAccordion: Utils.isTabletDevice() || Utils.isDesktopDevice()\n        };\n    }\n});\n\nexport = PaymentWizardModuleShowInvoices;\n"]}