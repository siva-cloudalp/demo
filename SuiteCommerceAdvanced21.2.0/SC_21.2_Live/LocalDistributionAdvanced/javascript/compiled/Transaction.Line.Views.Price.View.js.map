{"version":3,"sources":["Transaction.Line.Views.Price.View.ts"],"names":[],"mappings":"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","file":"Transaction.Line.Views.Price.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Transaction.Line.Views.Price.View\"/>\n\nimport * as transaction_line_views_price_tpl from 'transaction_line_views_price.tpl';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\nimport { ProfileModel } from '../../Profile/JavaScript/Profile.Model';\n\nimport Backbone = require('../../Utilities/JavaScript/backbone.custom');\nimport BackboneView = require('../../BackboneExtras/JavaScript/Backbone.View');\nimport Session = require('../../Session/JavaScript/Session');\n\nconst TransactionLineViewsPriceView: any = BackboneView.extend({\n    // @property {Function} template\n    template: transaction_line_views_price_tpl,\n\n    // @method initialize\n    // @param {Transaction.Line.Views.Price.View.Options} options\n    // @return {Void}\n    initialize: function() {\n        this.profileModel = ProfileModel.getInstance();\n\n        const isPriceVisible =\n            !!this.options.ignorePriceVisibility ||\n            (this.model.get('item') && this.model.get('item').get('ispricevisible') !== false);\n\n        this.isPriceEnabled = !ProfileModel.getInstance().hidePrices() && isPriceVisible;\n\n        if (this.isPriceEnabled) {\n            this.model.on(\n                'change:quantity',\n                function() {\n                    this.render();\n                },\n                this\n            );\n        }\n    },\n\n    // @method getUrlLogin Get the login URL contains an origin hash parameter indicating the current URL to came back after login\n    // @return {String}\n    getUrlLogin: function() {\n        const url = `${Session.get('touchpoints.login')}&origin=${Configuration.get(\n            'currentTouchpoint'\n        ) || 'home'}&origin_hash=`;\n\n        return (\n            url +\n            encodeURIComponent(\n                this.options.origin === 'PDPQUICK'\n                    ? this.model.generateURL().replace('/', '')\n                    : Backbone.history.fragment\n            )\n        );\n    },\n\n    // @method getContext\n    // @returns {Transaction.Line.Views.Price.View.Context}\n    getContext: function() {\n        const price_container_object = this.model.getPrice();\n        let showComparePrice =\n            this.options.showComparePrice &&\n            price_container_object.price < price_container_object.compare_price;\n\n        const item = this.model.get('item') || this.model;\n        const quantity = this.model.get('quantity');\n        const betterPrice = item && item.getBetterPrice(quantity);\n        if (betterPrice) {\n            showComparePrice = true;\n        }\n\n        // @class Transaction.Line.Views.Price.View.Context\n        return {\n            // @property {Transaction.Line.Model} model\n            model: this.model,\n            // @property {Boolean} showComparePrice\n            showComparePrice: showComparePrice,\n            // @property {Boolean} isInStock\n            isInStock: !!this.model.getStockInfo().isInStock,\n            // @property {String} currencyCode\n            currencyCode:\n                (SC.getSessionInfo('currency') && SC.getSessionInfo('currency').code) ||\n                SC.ENVIRONMENT.currencyCodeSpecifiedOnUrl,\n            // @property {String} comparePriceFormatted\n            comparePriceFormatted: betterPrice\n                ? betterPrice.defaultItemPrice\n                : price_container_object.compare_price_formatted || '',\n            // @property {Number} price\n            price: price_container_object.price || 0,\n            // @property {String} rateFormatted\n            rateFormatted: betterPrice\n                ? betterPrice.betterItemPrice\n                : this.model.get('rate_formatted') || price_container_object.price_formatted || '',\n            // @property {Boolean} isPriceEnabled\n            isPriceEnabled: this.isPriceEnabled,\n            // @property {String} urlLogin\n            urlLogin: this.getUrlLogin(),\n            // @property {Boolean} isLoggedIn\n            isLoggedIn: this.profileModel.isLoggedIn()\n        };\n        // @class Transaction.Line.Views.Price.View\n    }\n});\n\nexport = TransactionLineViewsPriceView;\n"]}