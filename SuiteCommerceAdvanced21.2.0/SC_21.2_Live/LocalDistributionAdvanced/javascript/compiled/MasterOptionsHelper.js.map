{"version":3,"sources":["MasterOptionsHelper.ts"],"names":[],"mappings":"AAAA;;;;;EAKE;;;;;;;;;;;;;;;;IAgBF;QAAA;QAgCA,CAAC;QA7BiB,4CAAwB,GAAtC,UAAuC,uBAA+B;YAClE,gIAAgI;YAChI,OAAO,IAAI,CAAC,0BAA0B,CAAC,uBAAuB,CAAC,OAAO,CAAC,2BAA2B,EAAE,EAAE,CAAC,CAAC,CAAC;QAC7G,CAAC;QAEc,8CAA0B,GAAzC,UAA0C,uBAA+B;YACrE,IAAM,oBAAoB,GAAG,6BAAa,CAAC,sBAAsB,CAAC,uBAAuB,CAAC,CAAC;YAC3F,IAAI,oBAAoB,gBAAO,oBAAoB,CAAC,CAAC;YAErD,IAAI,IAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAAC,EAAE;gBACxD,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAAC,EAAE,UAAC,QAA8B;oBAC1F,IAAI;wBACD,oBAAoB,GAAG,QAAQ,CAAC,oBAAoB,eAAM,oBAAoB,EAAE,CAAC;qBACnF;oBAAC,OAAO,CAAC,EAAE;wBACT,OAAO,CAAC,IAAI,CAAC,oDAAoD,EAAE,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC;qBAC1F;gBACL,CAAC,CAAC,CAAC;aACN;YACD,OAAO,oBAAoB,CAAC;QAChC,CAAC;QAEa,iDAA6B,GAA3C,UAA4C,uBAA+B,EAAE,QAA8B;YACvG,IAAM,sBAAsB,GAAG,6BAAa,CAAC,sBAAsB,CAAC;YACpE,IAAG,CAAC,sBAAsB,CAAC,uBAAuB,CAAC,EAAE;gBACjD,MAAM,IAAI,4BAA4B,CAAC,uBAAuB,EAAE,kCAAkC,CAAC,CAAC;aACvG;YACD,IAAI,CAAC,IAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAAC;gBAAE,IAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAAC,GAAG,EAAE,CAAC;YACzH,IAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC1E,CAAC;QA9Bc,4CAAwB,GAA2C,EAAE,CAAC;QA+BzF,0BAAC;KAhCD,AAgCC,IAAA;IAhCY,kDAAmB;IAkChC,SAAS,4BAA4B,CAAE,KAAK,EAAE,OAAO;QACjD,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;IAC3B,CAAC","file":"MasterOptionsHelper.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name = \"MasterOptionsHelper\"/>\n\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\nimport * as _ from 'underscore';\n\ninterface MasterOption {\n    fieldset?: string;\n    include?: string;\n    'facet.exclude'?: string;\n    [key: string]: string | boolean;\n}\n\ntype MasterOptionModifier = (modifiedMasterOption: MasterOption, nativeMasterOption: MasterOption) => MasterOption;\n\nexport class MasterOptionsHelper {\n    private static masterOptionModifiersMap: Record<string, MasterOptionModifier[]> = {};\n\n    public static getSearchAPIMasterOption(searchApiMasterOptionId: string): MasterOption {\n        // The replace is done for backwards compatibility, some modules use searchApiMasterOptions.masterOption instead of masterOption\n        return this.applyMasterOptionModifiers(searchApiMasterOptionId.replace(/^searchApiMasterOptions\\./, ''));\n    }\n\n    private static applyMasterOptionModifiers(searchApiMasterOptionId: string): MasterOption {\n        const originalMasterOption = Configuration.searchApiMasterOptions[searchApiMasterOptionId];\n        let modifiedMasterOption = {...originalMasterOption};\n\n        if (this.masterOptionModifiersMap[searchApiMasterOptionId]) {\n            _.each(this.masterOptionModifiersMap[searchApiMasterOptionId], (modifier: MasterOptionModifier) => {\n                try {\n                   modifiedMasterOption = modifier(modifiedMasterOption, {...originalMasterOption});\n                } catch (e) {\n                   console.warn('Error applying search api master option modifier: ', modifier.toString());\n                }\n            });\n        }\n        return modifiedMasterOption;\n    }\n\n    public static subscribeMasterOptionModifier(searchApiMasterOptionId: string, modifier: MasterOptionModifier): void {\n        const searchApiMasterOptions = Configuration.searchApiMasterOptions;\n        if(!searchApiMasterOptions[searchApiMasterOptionId]) {\n            throw new MasterOptionsHelperException('INVALID_MASTER_OPTION', 'Invalid Search API Master Option');\n        }\n        if (!this.masterOptionModifiersMap[searchApiMasterOptionId]) this.masterOptionModifiersMap[searchApiMasterOptionId] = [];\n        this.masterOptionModifiersMap[searchApiMasterOptionId].push(modifier);\n    }\n}\n\nfunction MasterOptionsHelperException (error, message) {\n    this.error = error;\n    this.message = message;\n}"]}