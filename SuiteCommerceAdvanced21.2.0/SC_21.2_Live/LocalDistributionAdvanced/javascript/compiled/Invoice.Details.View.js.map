{"version":3,"sources":["Invoice.Details.View.ts"],"names":[],"mappings":"AAAA;;;;;EAKE;;;IAqBF,qDAAqD;IACrD,IAAM,kBAAkB,GAAQ,YAAY,CAAC,MAAM,CAAC;QAChD,gCAAgC;QAChC,QAAQ,EAAE,mBAAmB;QAE7B,KAAK,EAAE,KAAK,CAAC,SAAS,CAAC,iBAAiB,CAAC;QAEzC,4BAA4B;QAC5B,MAAM,EAAE;YACJ,oCAAoC,EAAE,cAAc;SACvD;QAED,UAAU,EAAE;YACR,EAAE,EAAE,eAAe;YACnB,KAAK,EAAE,eAAe;SACzB;QAED,qBAAqB;QACrB,UAAU,EAAE,UAAS,OAAO;YACxB,IAAM,IAAI,GAAG,IAAI,CAAC;YAClB,IAAM,UAAU,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;YAE9C,IAAI,CAAC,KAAK,GAAG,IAAI,YAAY,CAAC,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC,CAAC;YAElD,IAAA,OAAO,GAAK,QAAQ,QAAb,CAAc;YAC7B,IAAI,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,8BAA8B,CAAC,KAAK,CAAC,EAAE;gBAChE,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,oBAAoB,CAAC;gBAE7C,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,QAAQ,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;aACnD;iBAAM,IAAI,OAAO,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC3C,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;aACtD;YAED,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC;YACvC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;YAC1D,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC;YACpB,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC,WAAW,EAAE,CAAC;QAC3D,CAAC;QAED,iBAAiB,EAAE,SAAS,iBAAiB;YACzC,IAAM,IAAI,GAAG,IAAI,CAAC;YAEV,IAAA,OAAO,GAAK,QAAQ,QAAb,CAAc;YAC7B,IAAI,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,8BAA8B,CAAC,KAAK,CAAC,EAAE;gBAChE,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;oBACpB,QAAQ,EAAE,uCAAkB,CAAC,WAAW,EAAE;iBAC7C,CAAC,CAAC;aACN;YACD,OAAO,IAAI,CAAC,KAAK;iBACZ,KAAK,CAAC;gBACH,QAAQ,EAAE,uCAAkB,CAAC,WAAW,EAAE;aAC7C,CAAC;iBACD,IAAI,CAAC;gBACF,OAAO,IAAI,CAAC,YAAY,EAAE,CAAC;YAC/B,CAAC,CAAC,CAAC;QACX,CAAC;QAED,6EAA6E;QAC7E,0EAA0E;QAC1E,2CAA2C;QAC3C,YAAY,EAAE,UAAS,QAAgB;YACnC,IAAM,SAAS,GAAQ,EAAE,CAAC;YAE1B,QAAQ,QAAQ,EAAE;gBACd,KAAK,eAAe;oBAChB,SAAS,CAAC,IAAI,GAAG,gBAAgB,CAAC;oBAClC,SAAS,CAAC,IAAI,GAAG,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;oBAC7C,SAAS,CAAC,IAAI,GAAG,UAAU,CAAC;oBAC5B,MAAM;gBACV,KAAK,oBAAoB;oBACrB,SAAS,CAAC,IAAI,GAAG,qBAAqB,CAAC;oBACvC,SAAS,CAAC,IAAI,GAAG,KAAK,CAAC,SAAS,CAAC,qBAAqB,CAAC,CAAC;oBACxD,SAAS,CAAC,IAAI,GAAG,oBAAoB,CAAC;oBACtC,MAAM;gBACV;oBACI,SAAS,CAAC,IAAI,GAAG,WAAW,CAAC;oBAC7B,SAAS,CAAC,IAAI,GAAG,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;oBAC7C,SAAS,CAAC,IAAI,GAAG,UAAU,CAAC;oBAC5B,MAAM;aACb;YAED,OAAO,SAAS,CAAC;QACrB,CAAC;QAED,gGAAgG;QAChG,mBAAmB;QACnB,eAAe,EAAE;YACb,OAAO,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,UAAU,CAAC;QACjE,CAAC;QAED,kEAAkE;QAClE,kBAAkB;QAClB,kBAAkB,EAAE;YAChB,OAAO;gBACH;oBACI,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;oBACzB,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;iBAC5B;gBACD;oBACI,IAAI,EAAE,KAAK,CAAC,SAAS,CAAC,eAAe,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;oBAChE,IAAI,EAAE,oBAAkB,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAG;iBACzD;aACJ,CAAC;QACN,CAAC;QAED,yBAAyB;QACzB,cAAc,EAAE;YACZ,IAAI,cAAc,GAAG,CAAC,CAAC;YACvB,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,UAAS,MAAM;gBACxC,cAAc,IAAI,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;YAC7C,CAAC,CAAC,CAAC;YAEH,OAAO,cAAc,CAAC;QAC1B,CAAC;QAED,iGAAiG;QACjG,YAAY,EAAE;YACV,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;gBAC5B,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,UAAU,CAAC;gBAEvD,IAAI,CAAC,gBAAgB,CAAC,yBAAyB,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;aAC5E;YAED,gBAAgB,CAAC,WAAW,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;QAChE,CAAC;QAED,4GAA4G;QAC5G,YAAY,EAAE;YACV,IAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,EAAE,CAAC;YACnC,IAAM,IAAI,GAAG,IAAI,CAAC;YAClB,IAAM,KAAK,GAAG,IAAI,iBAAiB,EAAE,CAAC;YAEtC,KAAK;iBACA,KAAK,CAAC;gBACH,IAAI,EAAE;oBACF,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,UAAU;oBACpD,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,UAAU;iBACvD;gBACD,QAAQ,EAAE,uCAAkB,CAAC,WAAW,EAAE;aAC7C,CAAC;iBACD,IAAI,CAAC;gBACF,IAAM,qBAAqB,GAAG,IAAI,qBAAqB,CAAC,KAAK,EAAE;oBAC3D,uBAAuB,EAAE,IAAI;iBAChC,CAAC,CAAC;gBACH,IAAI,CAAC,UAAU,GAAG,qBAAqB,CAAC,cAAc,EAAE,CAAC,UAAU,CAAC,MAAM,CAAC;gBAE3E,QAAQ,CAAC,OAAO,EAAE,CAAC;YACvB,CAAC,CAAC,CAAC;YAEP,OAAO,QAAQ,CAAC,OAAO,EAAE,CAAC;QAC9B,CAAC;QAED,gCAAgC;QAChC,UAAU,EAAE;YACR,iBAAiB,EAAE;gBACf,OAAO,IAAI,yCAAkB,CAAC;oBAC1B,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;oBACrE,YAAY,EAAE,IAAI;oBAClB,UAAU,EAAE,KAAK;oBACjB,WAAW,EAAE,IAAI;oBACjB,YAAY,EAAE,IAAI;iBACrB,CAAC,CAAC;YACP,CAAC;YAED,kBAAkB,EAAE;gBAChB,OAAO,IAAI,sBAAsB,CAAC;oBAC9B,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC;oBACnC,SAAS,EAAE,kFAAqC;oBAChD,WAAW,EAAE,CAAC;oBACd,gBAAgB,EAAE;wBACd,SAAS,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE;wBAE3C,YAAY,EAAE,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC;wBACrC,OAAO,EAAE,UAAU;wBAEnB,YAAY,EAAE,KAAK,CAAC,SAAS,CAAC,aAAa,CAAC;wBAC5C,OAAO,EAAE,gBAAgB;wBAEzB,YAAY,EAAE,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC;wBACxC,OAAO,EAAE,iBAAiB;qBAC7B;iBACJ,CAAC,CAAC;YACP,CAAC;SACJ;QAED,2DAA2D;QAC3D,UAAU,EAAE;YACR,IAAI,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,KAAK,CAAC,EAAE,UAAU,EAAE,iBAAiB,EAAE,CAAC,CAAC;YACtF,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,KAAK,CAAC,EAAE,UAAU,EAAE,YAAY,EAAE,CAAC,CAAC;YACvF,IAAM,oBAAoB,GAAG,IAAI,CAAC,KAAK;iBAClC,GAAG,CAAC,aAAa,CAAC;iBAClB,KAAK,CAAC,EAAE,UAAU,EAAE,oBAAoB,EAAE,CAAC,CAAC;YACjD,IAAM,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,MAAM,CAAC;YAC9D,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,UAAU,KAAK,MAAM,CAAC;YAC/D,IAAM,aAAa,GACf,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,gBAAgB,CAAC;gBAChC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC,SAAS,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;YAClE,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;YACtC,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;YAC7C,IAAM,IAAI,GAAG,IAAI,CAAC;YAElB,QAAQ,GAAG,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,UAAS,OAAY;gBAC5C,OAAO;oBACH,MAAM,EAAE,OAAO,CAAC,MAAM;oBACtB,QAAQ,EAAE,OAAO,CAAC,QAAQ;oBAC1B,UAAU,EAAE,OAAO,CAAC,UAAU;oBAC9B,MAAM,EAAE,OAAO,CAAC,MAAM;oBACtB,gBAAgB,EAAE,KAAK,CAAC,cAAc,CAClC,OAAO,CAAC,MAAM,EACd,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,mBAAmB,CAAC;wBAC/B,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC,MAAM;wBAC5C,CAAC,CAAC,EAAE,CACX;iBACJ,CAAC;YACN,CAAC,CAAC,CAAC;YAEK,IAAA,YAAY,GAAK,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,aAAjC,CAAkC;YAEtD,sCAAsC;YACtC,OAAO;gBACH,kCAAkC;gBAClC,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,6CAA6C;gBAC7C,uBAAuB,EAAE,0DAA0D;gBACnF,kCAAkC;gBAClC,WAAW,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO;gBAC3B,oCAAoC;gBACpC,cAAc,EAAE,KAAK,CAAC,iBAAiB,CAAC;oBACpC,KAAK,EAAE,iBAAiB;oBACxB,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC;iBACnC,CAAC;gBACF,+BAA+B;gBAC/B,SAAS,EAAE,KAAK,CAAC,SAAS,CACtB,gDAAgD,EAChD,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,cAAc,CAAC,CACjC;gBACD,6BAA6B;gBAC7B,MAAM,EAAE,OAAO;gBACf,sCAAsC;gBACtC,eAAe,EAAE,CAAC,CAAC,CACf,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,UAAU,CAC5E;gBACD,kCAAkC;gBAClC,WAAW,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,SAAS,CAAC;gBACxC,kCAAkC;gBAClC,WAAW,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC;gBACzC,uCAAuC;gBACvC,gBAAgB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC;gBACpF,sCAAsC;gBACtC,gBAAgB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC;gBACpF,8BAA8B;gBAC9B,QAAQ,EAAE,YAAY,CAAC,WAAW;gBAClC,+BAA+B;gBAC/B,QAAQ,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC;gBAClC,gCAAgC;gBAChC,SAAS,EAAE,CAAC,CAAC,CAAC,aAAa,IAAI,aAAa,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;gBACjE,+BAA+B;gBAC/B,SAAS,EACL,CAAC,aAAa;oBACV,aAAa,CAAC,GAAG,CAAC,cAAc,CAAC;oBACjC,aAAa,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC;oBAC3C,EAAE;gBACN,0CAA0C;gBAC1C,mBAAmB,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,aAAa;gBAC9D,wCAAwC;gBACxC,iBAAiB,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,eAAe;gBAC9D,sCAAsC;gBACtC,eAAe,EAAE,gBAAgB;gBACjC,sBAAsB;gBACtB,sBAAsB,EAAE,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;gBACpD,yCAAyC;gBACzC,kBAAkB,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;gBACpF,6BAA6B;gBAC7B,QAAQ,EAAE,QAAQ;gBAClB,kCAAkC;gBAClC,YAAY,EAAE,CAAC,CAAC,QAAQ,CAAC,MAAM;gBAC/B,6BAA6B;gBAC7B,WAAW,EAAE,YAAY;gBACzB,qCAAqC;gBACrC,eAAe,EAAE,CAAC,CAAC,YAAY,CAAC,MAAM;gBACtC,wCAAwC;gBACxC,mBAAmB,EAAE,oBAAoB;gBACzC,qCAAqC;gBACrC,uBAAuB,EAAE,CAAC,CAAC,oBAAoB,CAAC,MAAM;gBACtD,gCAAgC;gBAChC,SAAS,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM;gBACzB,8CAA8C;gBAC9C,uBAAuB,EAAE,KAAK,CAAC,MAAM,GAAG,CAAC;gBACzC,yCAAyC;gBACzC,mBAAmB,EAAE,cAAc;gBACnC,mDAAmD;gBACnD,4BAA4B,EAAE,cAAc,GAAG,CAAC;gBAChD,yCAAyC;gBACzC,KAAK,EAAE,KAAK;gBACZ,0CAA0C;gBAC1C,mBAAmB,EAAE,KAAK,CAAC,cAAc,EAAE,IAAI,KAAK,CAAC,eAAe,EAAE;gBACtE,8CAA8C;gBAC9C,uBAAuB,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU;aAC7C,CAAC;QACN,CAAC;KACJ,CAAC,CAAC;IAEH,OAAS,kBAAkB,CAAC","file":"Invoice.Details.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Invoice.Details.View\"/>\n\nimport * as _ from 'underscore';\nimport * as invoice_details_tpl from 'invoice_details.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { AjaxRequestsKiller } from '../../../Commons/AjaxRequestsKiller/JavaScript/AjaxRequestsKiller';\n\nimport LivePaymentModel = require('../../LivePayment/JavaScript/LivePayment.Model');\nimport BackboneCollectionView = require('../../../Commons/Backbone.CollectionView/JavaScript/Backbone.CollectionView');\nimport { AddressDetailsView } from '../../../Commons/Address/JavaScript/Address.Details.View';\nimport { TransactionLineViewsCellNavigableView } from '../../../Commons/Transaction.Line.Views/JavaScript/Transaction.Line.Views.Cell.Navigable.View';\nimport InvoiceModel = require('./Invoice.Model');\nimport ReturnLinesCalculator = require('../../ReturnAuthorization/JavaScript/ReturnAuthorization.GetReturnableLines');\nimport OrderHistoryModel = require('../../OrderHistory/JavaScript/OrderHistory.Model');\n\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\n\n// @class Invoice.Details.View @extends Backbone.View\nconst InvoiceDetailsView: any = BackboneView.extend({\n    // @property {Function} template\n    template: invoice_details_tpl,\n\n    title: Utils.translate('Invoice Details'),\n\n    // @property {Object} events\n    events: {\n        'click [data-type=\"make-a-payment\"]': 'makeAPayment'\n    },\n\n    attributes: {\n        id: 'InvoiceDetail',\n        class: 'InvoiceDetail'\n    },\n\n    // @method initialize\n    initialize: function(options): void {\n        const self = this;\n        const internalid = options.routerArguments[0];\n\n        this.model = new InvoiceModel({ internalid: internalid });\n\n        const { history } = Backbone;\n        if (history.fragment.indexOf('transactionhistory/invoices/') === 0) {\n            this.options.referrer = 'transactionhistory';\n\n            this.model.on('change', this.showContent, this);\n        } else if (options.routerArguments.length > 1) {\n            this.options.referrer = options.routerArguments[1];\n        }\n\n        this.application = options.application;\n        this.navSource = this.getNavSource(this.options.referrer);\n        this.validLines = 0;\n        this.livePaymentModel = LivePaymentModel.getInstance();\n    },\n\n    beforeShowContent: function beforeShowContent() {\n        const self = this;\n\n        const { history } = Backbone;\n        if (history.fragment.indexOf('transactionhistory/invoices/') === 0) {\n            return this.model.fetch({\n                killerId: AjaxRequestsKiller.getKillerId()\n            });\n        }\n        return this.model\n            .fetch({\n                killerId: AjaxRequestsKiller.getKillerId()\n            })\n            .then(function() {\n                return self.isReturnable();\n            });\n    },\n\n    // @method getNavSource Define the object that will be used by the breadcrumb\n    // @param {String} referrer Option defined to record the navigation origin\n    // @return {Invoice.Details.View.navSource}\n    getNavSource: function(referrer: string) {\n        const navSource: any = {};\n\n        switch (referrer) {\n            case 'paid-invoices':\n                navSource.href = '/paid-invoices';\n                navSource.text = Utils.translate('Invoices');\n                navSource.menu = 'invoices';\n                break;\n            case 'transactionhistory':\n                navSource.href = '/transactionhistory';\n                navSource.text = Utils.translate('Transaction History');\n                navSource.menu = 'transactionhistory';\n                break;\n            default:\n                navSource.href = '/invoices';\n                navSource.text = Utils.translate('Invoices');\n                navSource.menu = 'invoices';\n                break;\n        }\n\n        return navSource;\n    },\n\n    // @method getSelectedMenu Define the name of the menu option selected when displaying this view\n    // @return {String}\n    getSelectedMenu: function(): string {\n        return (this.navSource && this.navSource.menu) || 'invoices';\n    },\n\n    // @method getBreadcrumbPages Define the content of the breadcrumb\n    // @return {Array}\n    getBreadcrumbPages: function(): { text: string; href: string }[] {\n        return [\n            {\n                text: this.navSource.text,\n                href: this.navSource.href\n            },\n            {\n                text: Utils.translate('Invoice #$(0)', this.model.get('tranid')),\n                href: `/invoices/view/${this.model.get('internalid')}`\n            }\n        ];\n    },\n\n    // @method getItemsNumber\n    getItemsNumber: function(): number {\n        let items_quantity = 0;\n        this.model.get('lines').each(function(models) {\n            items_quantity += models.get('quantity');\n        });\n\n        return items_quantity;\n    },\n\n    // @method makeAPayment Mark the current invoice as selected (check) and start the payment wizard\n    makeAPayment: function(): void {\n        if (this.model.get('currency')) {\n            const currency = this.model.get('currency').internalid;\n\n            this.livePaymentModel.changeCurrencyByInvoiceId(currency, this.model.id);\n        }\n\n        LivePaymentModel.getInstance().selectInvoice(this.model.id);\n    },\n\n    // @method isReturnable Calculate based on the fulfillments and returns made, if the invoice accepts returns\n    isReturnable: function() {\n        const deferred = jQuery.Deferred();\n        const self = this;\n        const model = new OrderHistoryModel();\n\n        model\n            .fetch({\n                data: {\n                    internalid: this.model.get('createdfrom').internalid,\n                    recordtype: this.model.get('createdfrom').recordtype\n                },\n                killerId: AjaxRequestsKiller.getKillerId()\n            })\n            .done(function() {\n                const returnable_calculator = new ReturnLinesCalculator(model, {\n                    notConsiderFulfillments: true\n                });\n                self.validLines = returnable_calculator.calculateLines().validLines.length;\n\n                deferred.resolve();\n            });\n\n        return deferred.promise();\n    },\n\n    // @property {Object} childViews\n    childViews: {\n        'Billing.Address': function() {\n            return new AddressDetailsView({\n                model: this.model.get('addresses').get(this.model.get('billaddress')),\n                hideDefaults: true,\n                showSelect: false,\n                hideActions: true,\n                hideSelector: true\n            });\n        },\n\n        'Items.Collection': function() {\n            return new BackboneCollectionView({\n                collection: this.model.get('lines'),\n                childView: TransactionLineViewsCellNavigableView,\n                viewsPerRow: 1,\n                childViewOptions: {\n                    navigable: !this.application.isStandalone(),\n\n                    detail1Title: Utils.translate('Qty:'),\n                    detail1: 'quantity',\n\n                    detail2Title: Utils.translate('Unit price:'),\n                    detail2: 'rate_formatted',\n\n                    detail3Title: Utils.translate('Amount:'),\n                    detail3: 'total_formatted'\n                }\n            });\n        }\n    },\n\n    // @method getContext @returns Invoice.Details.View.Context\n    getContext: function() {\n        let payments = this.model.get('adjustments').where({ recordtype: 'customerpayment' });\n        const credit_memos = this.model.get('adjustments').where({ recordtype: 'creditmemo' });\n        const deposit_applications = this.model\n            .get('adjustments')\n            .where({ recordtype: 'depositapplication' });\n        const show_adjustments = this.model.get('adjustments').length;\n        const is_open = this.model.get('status').internalid === 'open';\n        const paymentmethod =\n            this.model.get('paymentmethods') &&\n            this.model.get('paymentmethods').findWhere({ primary: true });\n        const lines = this.model.get('lines');\n        const items_quantity = this.getItemsNumber();\n        const self = this;\n\n        payments = _.map(payments, function(payment: any) {\n            return {\n                tranid: payment.tranid,\n                trandate: payment.trandate,\n                internalid: payment.internalid,\n                amount: payment.amount,\n                amount_formatted: Utils.formatCurrency(\n                    payment.amount,\n                    self.model.get('selected_currency')\n                        ? self.model.get('selected_currency').symbol\n                        : ''\n                )\n            };\n        });\n\n        const { siteSettings } = this.application.getConfig();\n\n        // @class Invoice.Details.View.Context\n        return {\n            // @property {Invoice.Model} model\n            model: this.model,\n            // @property {String} makeAPaymentPermissions\n            makeAPaymentPermissions: 'transactions.tranCustPymt.2, transactions.tranCustInvc.1',\n            // @property {Boolean} showInModal\n            showInModal: !!this.inModal,\n            // @property {String} donwloadPdfUrl\n            donwloadPdfUrl: Utils.getDownloadPdfUrl({\n                asset: 'invoice-details',\n                id: this.model.get('internalid')\n            }),\n            // @property {String} pageTitle\n            pageTitle: Utils.translate(\n                'Invoice <span class=\"strong-text\">#$(0)</span>',\n                this.model.get('order_number')\n            ),\n            // @property {Boolean} isOpen\n            isOpen: is_open,\n            // @property {Boolean} showCreatedFrom\n            showCreatedFrom: !!(\n                this.model.get('createdfrom') && this.model.get('createdfrom').internalid\n            ),\n            // @property {Boolean} showDueDate\n            showDueDate: !!this.model.get('dueDate'),\n            // @property {Boolean} showSaleRep\n            showSaleRep: !!this.model.get('salesrep'),\n            // @property {Boolean} showSaleRepPhone\n            showSaleRepPhone: !!(this.model.get('salesrep') && this.model.get('salesrep').phone),\n            // @property {Boolean} showSaleRepName\n            showSaleRepEmail: !!(this.model.get('salesrep') && this.model.get('salesrep').email),\n            // @property {String} siteName\n            siteName: siteSettings.displayname,\n            // @property {Boolean} showMemo\n            showMemo: !!this.model.get('memo'),\n            // @property {Boolean} showTerms\n            showTerms: !!(paymentmethod && paymentmethod.get('paymentterms')),\n            // @property {String} termsName\n            termsName:\n                (paymentmethod &&\n                    paymentmethod.get('paymentterms') &&\n                    paymentmethod.get('paymentterms').name) ||\n                '',\n            // @property {Boolean} showDiscountSummary\n            showDiscountSummary: !!this.model.get('summary').discounttotal,\n            // @property {Boolean} showGiftcerticate\n            showGiftcerticate: !!this.model.get('summary').giftcertapplied,\n            // @property {Boolean} showAdjustments\n            showAdjustments: show_adjustments,\n            // @property {Boolean}\n            showMakeAPaymentButton: !!(is_open && !this.inModal),\n            // @property {Boolean} showBillingAddress\n            showBillingAddress: !!this.model.get('addresses').get(this.model.get('billaddress')),\n            // @property {Array} payments\n            payments: payments,\n            // property {Boolean} showPayments\n            showPayments: !!payments.length,\n            // @property {Array} payments\n            creditMemos: credit_memos,\n            // property {Boolean} showCreditMemos\n            showCreditMemos: !!credit_memos.length,\n            // @property {Array} depositApplications\n            depositApplications: deposit_applications,\n            // property {Boolean} showCreditMemos\n            showDepositApplications: !!deposit_applications.length,\n            // @property {Boolean} showLines\n            showLines: !!lines.length,\n            // @property {Boolean} linesLengthGreaterThan1\n            linesLengthGreaterThan1: lines.length > 1,\n            // @property {Number} itemsQuantityNumber\n            itemsQuantityNumber: items_quantity,\n            // @property {Boolean} linesitemsNumberGreaterThan1\n            linesitemsNumberGreaterThan1: items_quantity > 1,\n            // @property {OrderLine.Collection} lines\n            lines: lines,\n            // @property {Boolean} showOpenedAccordion\n            showOpenedAccordion: Utils.isTabletDevice() || Utils.isDesktopDevice(),\n            // @property {Boolean} showRequestReturnButton\n            showRequestReturnButton: !!this.validLines\n        };\n    }\n});\n\nexport = InvoiceDetailsView;\n"]}