{"version":3,"sources":["ReturnAuthorization.List.View.ts"],"names":[],"mappings":"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","file":"ReturnAuthorization.List.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"ReturnAuthorization.List.View\"/>\n// @module ReturnAuthorization.List.View\n\nimport * as _ from 'underscore';\nimport * as return_authorization_list_tpl from 'return_authorization_list.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { Configuration } from '../../SCA/JavaScript/Configuration';\nimport { ListHeaderView } from '../../../Commons/ListHeader/JavaScript/ListHeader.View';\nimport { RecordViewsView } from '../../RecordViews/JavaScript/RecordViews.View';\nimport { GlobalViewsPaginationView } from '../../../Commons/GlobalViews/JavaScript/GlobalViews.Pagination.View';\nimport { GlobalViewsShowingCurrentView } from '../../../Commons/GlobalViews/JavaScript/GlobalViews.ShowingCurrent.View';\nimport { GlobalViewsMessageView } from '../../../Commons/GlobalViews/JavaScript/GlobalViews.Message.View';\n\nimport { UrlHelper } from '../../../Commons/UrlHelper/JavaScript/UrlHelper';\nimport TransactionListView = require('../../../Commons/Transaction/JavaScript/Transaction.List.View');\nimport BackboneCollectionView = require('../../../Commons/Backbone.CollectionView/JavaScript/Backbone.CollectionView');\n\nimport ReturnAuthorizationCollection = require('./ReturnAuthorization.Collection');\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\n\n// @class ReturnAuthorization.List.View @extend Backbone.View\nexport type ReturnAuthorizationListView = any;\nexport const ReturnAuthorizationListView: any = TransactionListView.extend({\n    template: return_authorization_list_tpl,\n\n    className: 'ReturnAuthorizationList',\n\n    title: Utils.translate('Returns'),\n\n    page_header: Utils.translate('Returns'),\n\n    attributes: {\n        id: 'ReturnsHistory',\n        class: 'ReturnAuthorizationList'\n    },\n\n    initialize: function(options) {\n        const { application } = options;\n        this.application = application;\n        const parameters = Utils.parseUrlOptions(options.routerArguments[0]);\n        this.collection = new ReturnAuthorizationCollection();\n        this.page = parameters.page;\n\n        this.listenCollection();\n\n        const isoDate = Utils.dateToString(new Date());\n\n        this.rangeFilterOptions = {\n            fromMin: '1800-01-02',\n            fromMax: isoDate,\n            toMin: '1800-01-02',\n            toMax: isoDate\n        };\n\n        // manages sorting and filtering of the collection\n        this.list_header = new ListHeaderView({\n            view: this,\n            application: application,\n            collection: this.collection,\n            sorts: this.sortOptions,\n            rangeFilter: 'date',\n            rangeFilterLabel: Utils.translate('Requested from'),\n            listHeaderId: 'returns',\n            hidePagination: true,\n            allowEmptyBoundaries: true\n        });\n\n        if (parameters.cancel) {\n            this.message = Utils.translate('Good! Your request was successfully cancelled.');\n            Backbone.history.navigate(\n                UrlHelper.removeUrlParameter(Backbone.history.fragment, 'cancel'),\n                { replace: true }\n            );\n        }\n        this.collection.on('reset', this.showContent, this);\n    },\n\n    // @method getSelectedMenu\n    getSelectedMenu: function() {\n        return 'returns';\n    },\n    // @method getBreadcrumbPages\n    getBreadcrumbPages: function() {\n        return {\n            text: Utils.translate('Returns'),\n            href: '/returns'\n        };\n    },\n\n    listenCollection: function() {\n        this.setLoading(true);\n\n        this.collection.on({\n            request: jQuery.proxy(this, 'setLoading', true),\n            reset: jQuery.proxy(this, 'setLoading', false)\n        });\n    },\n\n    setLoading: function(value) {\n        this.isLoading = value;\n    },\n\n    childViews: {\n        'ListHeader.View': function() {\n            return this.list_header;\n        },\n        'GlobalViews.Pagination': function() {\n            return new GlobalViewsPaginationView(\n                _.extend(\n                    {\n                        totalPages: Math.ceil(\n                            this.collection.totalRecordsFound / this.collection.recordsPerPage\n                        )\n                    },\n                    Configuration.defaultPaginationSettings\n                )\n            );\n        },\n        'GlobalViews.ShowCurrentPage': function() {\n            return new GlobalViewsShowingCurrentView({\n                items_per_page: this.collection.recordsPerPage,\n                total_items: this.collection.totalRecordsFound,\n                total_pages: Math.ceil(\n                    this.collection.totalRecordsFound / this.collection.recordsPerPage\n                )\n            });\n        },\n        'Records.List': function() {\n            return this._resultsView;\n        },\n        Message: function() {\n            return new GlobalViewsMessageView({\n                message: this.message,\n                closable: true,\n                type: 'success'\n            });\n        }\n    },\n    _buildResultsView: function() {\n        const self = this;\n        let selectedColumns = [];\n\n        if (!Configuration.get().transactionListColumns.enableReturnAuthorization) {\n            selectedColumns.push({\n                label: 'Date:',\n                type: 'date',\n                name: 'request-date',\n                id: 'trandate'\n            });\n            selectedColumns.push({ label: 'Items:', type: 'items', name: 'items', id: 'quantity' });\n            selectedColumns.push({\n                label: 'Amount:',\n                type: 'currency',\n                name: 'amount',\n                id: 'amount_formatted'\n            });\n            selectedColumns.push({ label: 'Status', type: 'status', name: 'status', id: 'status' });\n        } else {\n            selectedColumns = Configuration.get().transactionListColumns.returnAuthorization;\n        }\n\n        const records_collection = new Backbone.Collection(\n            this.collection.map(function(return_authorization) {\n                return new Backbone.Model({\n                    touchpoint: 'customercenter',\n                    title: return_authorization.get('tranid'),\n                    detailsURL: `#returns/${return_authorization.get(\n                        'recordtype'\n                    )}/${return_authorization.get('internalid')}`,\n\n                    id: return_authorization.get('internalid'),\n                    internalid: return_authorization.get('internalid'),\n\n                    columns: self._buildColumns(selectedColumns, return_authorization)\n                });\n            })\n        );\n        return new BackboneCollectionView({\n            collection: records_collection,\n            viewsPerRow: 1,\n            childView: RecordViewsView\n        });\n    },\n\n    sortOptions: [\n        {\n            value: 'trandate,internalid',\n            name: Utils.translate('Sort By Date'),\n            selected: true\n        },\n        {\n            value: 'tranid',\n            name: Utils.translate('Sort By Number')\n        }\n    ],\n\n    // @method getContext @return ReturnAuthorization.List.View.Context\n    getContext: function() {\n        this._resultsView = this._buildResultsView();\n        let columns = [];\n        if (this._resultsView.collection.length > 0) {\n            columns = this._resultsView.collection.at(0).get('columns');\n        }\n        // @class ReturnAuthorization.List.View.Context\n        return {\n            // @property {String} pageHeader\n            pageHeader: this.page_header,\n            // @property {Boolean} showMessage\n            showMessage: !!this.message,\n            // @property {Boolean} isResultLengthGreaterThan0\n            isResultLengthGreaterThan0: !!this.collection.length,\n            // @property {Boolean} isLoading\n            isLoading: this.isLoading,\n            // @property {Boolean} showBackToAccount\n            showBackToAccount: Configuration.get('siteSettings.sitetype') === 'STANDARD',\n            // @property {Boolean} showPagination\n            showPagination: !!(this.collection.totalRecordsFound && this.collection.recordsPerPage),\n            // @property {Array<{}>} columns\n            columns: columns\n        };\n    }\n});\n"]}