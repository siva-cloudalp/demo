{"version":3,"sources":["NavigationHelper.Plugins.Standard.ts"],"names":[],"mappings":"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","file":"NavigationHelper.Plugins.Standard.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"NavigationHelper.Plugins.Standard\"/>\n\nimport * as _ from 'underscore';\nimport '../../UrlHelper/JavaScript/UrlHelper';\nimport * as Utils from '../../Utilities/JavaScript/Utils';\n\nimport Backbone = require('../../Utilities/JavaScript/backbone.custom');\n\n// @class NavigationHelper.Plugins.Standard Contains the standard navigation helper behavior. @extends ApplicationModule\nconst standardPlugins: any = {\n    // @method isNOTURLHashtagPart Determines if the passed in string URL is intended to be used as a hashtag.\n    // IMPORTANT: This function also evaluate Backbone.history.options.pushState.\n    // @param {String} url\n    // @return {Boolean}\n    isNOTURLHashtagPart: function(url: string) {\n        return (\n            Backbone.history.options.pushState ||\n            url === '#' ||\n            url.indexOf('http://') === 0 ||\n            url.indexOf('https://') === 0 ||\n            url.indexOf('mailto:') === 0 ||\n            url.indexOf('tel:') === 0\n        );\n    },\n\n    // @method correctURL Intercepts mousedown events on all anchors with no data-touchpoint attribute and fix its href attribute to work when opening a link\n    // @param {ApplicationSkeleton.Layout} layout General application layout\n    // @param {jQuery.Event} e jQuery event\n    // @return {jQuery.Event} e\n    correctURL: function(layout, e) {\n        const context = layout.generateNavigationContext(e);\n        const window_obj = Utils.getWindow();\n        let href = layout.getUrl(context) || '#';\n\n        if (!context.target_data.touchpoint && !standardPlugins.isNOTURLHashtagPart(href)) {\n            if (\n                context.target_data.toggle === 'show-in-modal' ||\n                context.target_data.toggle === 'show-in-pusher'\n            ) {\n                context.$target.data('original-href', href);\n                href = window_obj.location.href;\n            } else if (window_obj.location.hash) {\n                href = window_obj.location.href.replace(/#.*$/, '#' + href);\n            } else if (\n                window_obj.location.href.lastIndexOf('#') ===\n                window_obj.location.href.length - 1\n            ) {\n                href = window_obj.location.href + href;\n            } else {\n                href = window_obj.location.href + '#' + href;\n            }\n\n            layout.setUrl(context.$target, href);\n        }\n\n        return e;\n    },\n\n    // @method clickNavigation Handle standard click navigation for the cases were the target is NOT a modal\n    // @param {ApplicationSkeleton.Layout} layout General application layout\n    // @param {jQuery.Event} e jQuery event\n    // @return {jQuery.Event} e\n    clickNavigation: function(layout, e) {\n        e.preventDefault();\n\n        // Grabs info from the event element\n        const context = layout.generateNavigationContext(e);\n        let href = layout.getUrl(context) || '';\n        const target_is_blank = layout.isTargetBlank(e) || e.button === 1;\n        const target_is_modal_or_pusher =\n            context.target_data.toggle === 'show-in-modal' ||\n            (context.target_data.toggle === 'show-in-pusher' && Utils.isPhoneDevice());\n        const is_disabled = context.$target.attr('disabled');\n        const is_dropdown = context.target_data.toggle === 'dropdown';\n        let is_external;\n\n        if (is_disabled) {\n            e.stopPropagation();\n            return e;\n        }\n\n        if (context.target_data.originalHref && !target_is_blank) {\n            href = context.target_data.originalHref;\n        }\n\n        // Pusher fix\n        layout.$el.removeClass('sc-pushing');\n\n        if (href === '#' || href === '' || is_dropdown) {\n            return e;\n        }\n\n        // The navigation is within the same browser window\n        if (!target_is_blank) {\n            // There is a modal open\n            if (layout.$containerModal) {\n                layout.$containerModal\n                    .removeClass('fade')\n                    .modal('hide')\n                    .data('bs.modal', null);\n            }\n\n            // Wants to open this link in a modal or pusher\n            if (!target_is_modal_or_pusher) {\n                is_external =\n                    ~href.indexOf('http:') ||\n                    ~href.indexOf('https:') ||\n                    ~href.indexOf('mailto:') ||\n                    ~href.indexOf('tel:');\n\n                if (is_external) {\n                    Utils.getWindow().document.location.href = href;\n                } else {\n                    Backbone.history.navigate(href, { trigger: true });\n                }\n            }\n        } else {\n            Utils.getWindow().open(href, _.uniqueId('window'));\n        }\n\n        return e;\n    },\n\n    // @method mountToApp\n    // @param {ApplicationSkeleton} application\n    mountToApp: function(application) {\n        const layout = application.getLayout();\n\n        // Install Standard Navigation Plugins\n\n        layout.mouseDown.install({\n            name: 'mouseDownFixHref',\n            priority: 10,\n            execute: function(e) {\n                return standardPlugins.correctURL(layout, e);\n            }\n        });\n\n        layout.touchStart.install({\n            name: 'touchStartFixHref',\n            priority: 10,\n            execute: function(e) {\n                return standardPlugins.correctURL(layout, e);\n            }\n        });\n\n        layout.click.install({\n            name: 'standardNavigation',\n            priority: 20,\n            execute: function(e) {\n                return standardPlugins.clickNavigation(layout, e);\n            }\n        });\n    }\n};\n\nexport = standardPlugins;\n"]}