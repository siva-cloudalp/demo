{"version":3,"sources":["Subscriptions.AddOn.Review.View.ts"],"names":[],"mappings":"AAAA;;;;;EAKE;;;IAaF,IAAM,4BAA4B,GAAQ,YAAY,CAAC,MAAM,CAAC;QAC1D,QAAQ,EAAE,0BAA0B;QAEpC,MAAM,EAAE;YACJ,8BAA8B,EAAE,QAAQ;SAC3C;QAED,KAAK,EAAE,KAAK,CAAC,SAAS,CAAC,yBAAyB,CAAC;QAEjD,WAAW,EAAE,KAAK,CAAC,SAAS,CAAC,yBAAyB,CAAC;QAEvD,UAAU,EAAE,UAAS,OAAO;YACxB,IAAI,CAAC,YAAY,GAAG,OAAO,CAAC,YAAY,CAAC;YACzC,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;QAC/B,CAAC;QAED,UAAU,EAAE;YACR,cAAc,EAAE;gBACZ,OAAO,IAAI,WAAW,CAAC;oBACnB,KAAK,EAAE,IAAI,CAAC,KAAK;iBACpB,CAAC,CAAC;YACP,CAAC;SACJ;QAED,MAAM,EAAE,UAAS,CAAC;YAAV,iBA8BP;YA7BG,CAAC,CAAC,cAAc,EAAE,CAAC;YACnB,IAAM,YAAY,GAAG,IAAI,wCAAkB,EAAE,CAAC;YAC9C,YAAY,CAAC,GAAG,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC;YACpE,YAAY,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC;YACzD,YAAY,CAAC,GAAG,CAAC,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC;YAE7D,IAAM,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,oBAAoB,CAC1D,YAAY,CAAC,GAAG,CAAC,YAAY,CAAC,CACjC,CAAC;YACF,IAAM,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,iBAAiB,CAAC;gBACnD,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,iBAAiB,CAAC;gBAChE,CAAC,CAAC,CAAC,CAAC;YAER,YAAY,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC;gBACrB,IAAI,aAAa,KAAK,CAAC,EAAE;oBACrB,iBAAO,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC;wBACrB,aAAa,EAAE,2BAA2B;wBAC1C,QAAQ,EAAE,KAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC;wBACtC,SAAS,EAAE,aAAa,GAAG,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,WAAW;qBAC3D,CAAC,CAAC;iBACN;qBAAM,IAAI,CAAC,eAAe,EAAE;oBACzB,iBAAO,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC;wBACrB,aAAa,EAAE,2BAA2B;wBAC1C,QAAQ,EAAE,KAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC;qBACzC,CAAC,CAAC;iBACN;gBAED,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,eAAe,GAAG,KAAI,CAAC,YAAY,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,IAAI,CAAC,CAAC;YAC3F,CAAC,CAAC,CAAC;QACP,CAAC;QAED,2CAA2C;QAC3C,eAAe,EAAE;YACb,OAAO,eAAe,CAAC;QAC3B,CAAC;QACD,6BAA6B;QAC7B,kBAAkB,EAAE;YAChB,OAAO;gBACH,IAAI,EAAE,IAAI,CAAC,KAAK;gBAChB,IAAI,EAAE,gBAAgB;aACzB,CAAC;QACN,CAAC;QAED,UAAU,EAAE;YACR,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAEpC,OAAO;gBACH,QAAQ,EAAE,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC;gBAC5B,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC;gBACxC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,2BAA2B,CAAC;gBACtD,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC;gBAC/B,eAAe,EAAE,IAAI,CAAC,GAAG,CAAC,0BAA0B,CAAC;gBACrD,eAAe,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,IAAI;aACzD,CAAC;QACN,CAAC;KACJ,CAAC,CAAC;IAEH,OAAS,4BAA4B,CAAC","file":"Subscriptions.AddOn.Review.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Subscriptions.AddOn.Review.View\"/>\nimport * as subscriptions_addon_review from 'subscriptions_addon_review.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport { SubscriptionsModel } from './Subscriptions.Model';\nimport { Loggers } from '../../../Commons/Loggers/JavaScript/Loggers';\n\nimport SummaryView = require('./Subscriptions.AddOn.Summary.View');\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\n\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\n\nconst SubscriptionsAddOnReviewView: any = BackboneView.extend({\n    template: subscriptions_addon_review,\n\n    events: {\n        'click [data-action=\"submit\"]': 'submit'\n    },\n\n    title: Utils.translate('Add Subscription Review'),\n\n    page_header: Utils.translate('Add Subscription Review'),\n\n    initialize: function(options) {\n        this.subscription = options.subscription;\n        this.model = options.model;\n    },\n\n    childViews: {\n        'Summary.View': function() {\n            return new SummaryView({\n                model: this.model\n            });\n        }\n    },\n\n    submit: function(e) {\n        e.preventDefault();\n        const updatedModel = new SubscriptionsModel();\n        updatedModel.set('internalid', this.subscription.get('internalid'));\n        updatedModel.set('quantity', this.model.get('quantity'));\n        updatedModel.set('lineNumber', this.model.get('lineNumber'));\n\n        const isOptionalAddOn = this.subscription.hasAddOnByLineNumber(\n            updatedModel.get('lineNumber')\n        );\n        const qtyDifference = this.model.has('initialQuantity')\n            ? this.model.get('quantity') - this.model.get('initialQuantity')\n            : 0;\n\n        updatedModel.save().done(() => {\n            if (qtyDifference !== 0) {\n                Loggers.getLogger().info({\n                    componentArea: 'SUBSCRIPTIONS_QTY_CHANGED',\n                    lineType: this.model.get('chargeType'),\n                    qtyChange: qtyDifference > 0 ? 'INCREASED' : 'DECREASED'\n                });\n            } else if (!isOptionalAddOn) {\n                Loggers.getLogger().info({\n                    componentArea: 'SUBSCRIPTIONS_ADDON_ADDED',\n                    lineType: this.model.get('chargeType')\n                });\n            }\n\n            Backbone.history.navigate('subscription/' + this.subscription.get('internalid'), true);\n        });\n    },\n\n    // @method getSelectedMenu @return {String}\n    getSelectedMenu: function() {\n        return 'subscriptions';\n    },\n    // @method getBreadcrumbPages\n    getBreadcrumbPages: function() {\n        return {\n            text: this.title,\n            href: '/Subscriptions'\n        };\n    },\n\n    getContext: function() {\n        const item = this.model.get('item');\n\n        return {\n            itemName: item.get('itemId'),\n            itemQuantity: this.model.get('quantity'),\n            itemPrice: this.model.get('recurringAmount_formatted'),\n            itemImage: item.get('imageUrl'),\n            itemDescription: item.get('storedetailedDescription'),\n            showInfoMessage: this.model.get('isProrated') === true\n        };\n    }\n});\n\nexport = SubscriptionsAddOnReviewView;\n"]}