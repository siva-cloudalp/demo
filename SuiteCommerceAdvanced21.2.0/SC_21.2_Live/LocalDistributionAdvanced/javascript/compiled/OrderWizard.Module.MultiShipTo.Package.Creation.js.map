{"version":3,"sources":["OrderWizard.Module.MultiShipTo.Package.Creation.ts"],"names":[],"mappings":"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","file":"OrderWizard.Module.MultiShipTo.Package.Creation.js","sourcesContent":["/*\n\t© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"OrderWizard.Module.MultiShipTo.Package.Creation\"/>\n/// <reference path=\"../../../Commons/Utilities/JavaScript/UnderscoreExtended.d.ts\" />\n\nimport * as _ from 'underscore';\nimport * as order_wizard_msr_package_creation_tpl from 'order_wizard_msr_package_creation.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { WizardStepModule } from '../../Wizard/JavaScript/Wizard.StepModule';\n\nimport BackboneCollectionView = require('../../../Commons/Backbone.CollectionView/JavaScript/Backbone.CollectionView');\nimport TransactionLineViewsCellSelectableView = require('../../../Commons/Transaction.Line.Views/JavaScript/Transaction.Line.Views.Cell.Selectable.View');\nimport OrderWizardModuleMultiShipToSetAddressesPackageEditQuantity = require('./OrderWizard.Module.MultiShipTo.Package.Creation.EditQuantity');\nimport { AddressDetailsView } from '../../../Commons/Address/JavaScript/Address.Details.View';\n\n// @class OrderWizard.Module.MultiShipTo.Package.Creation @extend Wizard.Module\nexport = WizardStepModule.extend({\n    template: order_wizard_msr_package_creation_tpl,\n\n    allItemShouldBelongToAPackage: {\n        errorMessage: Utils.translate(\n            'Some of your items are not assigned to a shipping address. Please, go back to shipping step.'\n        ),\n        errorCode: 'ERR_MST_ITEM_WITHOUT_PACKAGE'\n    },\n\n    errors: ['ERR_MST_ITEM_WITHOUT_PACKAGE'],\n\n    events: {\n        'click [data-action=\"select-unselected-item\"]': 'selectLine',\n        'click [data-action=\"sub-quantity\"]': 'subQuantity',\n        'click [data-action=\"add-quantity\"]': 'addQuantity',\n        'change [data-action=\"split-quantity\"]': 'updateLineQuantity',\n        'change [data-action=\"set-shipments-address-selector\"]': 'setSelectedAddressId',\n        'click [data-action=\"select-unselect-all\"]': 'selectUnselectAll',\n        'click [data-action=\"create-shipments\"]': 'applyCurrentAddress'\n    },\n\n    initialize: function(options) {\n        this.options = options;\n        WizardStepModule.prototype.initialize.apply(this, arguments);\n\n        const self = this;\n        this.selected_address_id = null;\n        this.createShipmentLabel = '';\n        this.createShipmentEnabled = false;\n\n        this.wizard.model.on('multishipto-line-updated', function() {\n            self.selected_address_id = self.getFirstAddressIdWithoutShipments();\n            self.render();\n        });\n\n        self.wizard.options.profile.get('addresses').once('reset', function() {\n            self.selected_address_id = self.getFirstAddressIdWithoutShipments();\n        });\n    },\n\n    updateLineQuantity: function(event) {\n        const target = jQuery(event.currentTarget);\n        const target_control_group = target.closest('[data-validation=\"control-group\"]');\n        const message_placeholder = target_control_group.find(\n            '[data-validation=\"error-placeholder\"]'\n        );\n        const create_shippment_button = this.$('[data-action=\"create-shipments\"]');\n        const line_id = target.closest('[data-type=\"row\"]').data('lineId');\n        const selected_line = this.wizard.model.get('lines').get(line_id);\n        const min_quantity = selected_line.get('minimumquantity') || 1;\n        const quantity = selected_line.get('quantity');\n        const new_quantity = parseInt(<any>target.val(), 10);\n\n        // invalid values return to default quantity\n        if (isNaN(new_quantity) || new_quantity > quantity) {\n            target.val(quantity);\n            return;\n        }\n\n        if (min_quantity > new_quantity) {\n            target.val(min_quantity);\n            return;\n        }\n\n        if (quantity - new_quantity >= min_quantity || new_quantity === quantity) {\n            target_control_group.removeAttr('data-validation-error');\n            create_shippment_button.removeAttr('disabled');\n            message_placeholder.empty().hide();\n            selected_line.set('splitquantity', new_quantity);\n        } else {\n            target_control_group.attr('data-validation-error', '');\n            create_shippment_button.attr('disabled', '');\n            selected_line.unset('splitquantity');\n\n            const message = Utils.translate(\n                'The remaining quantity of items ($(0)) should be more than the minimum quantity required',\n                quantity - new_quantity\n            );\n            message_placeholder.text(message).show();\n        }\n    },\n\n    // @method addQuantity plus/minus Quantity\n    addQuantity: function(e) {\n        e.stopPropagation();\n        const $line = jQuery(e.target).closest('[data-type=\"row\"]');\n        const quantity_edit = $line.find('[data-action=\"split-quantity\"]');\n        const new_quantity = parseFloat(<string>quantity_edit.val()) + 1;\n\n        quantity_edit.val(new_quantity);\n        quantity_edit.trigger('change');\n    },\n\n    subQuantity: function(e) {\n        e.stopPropagation();\n        const $line = jQuery(e.target).closest('[data-type=\"row\"]');\n        const quantity_edit = $line.find('[data-action=\"split-quantity\"]');\n        const new_quantity = parseFloat(<string>quantity_edit.val()) - 1;\n\n        quantity_edit.val(new_quantity);\n        quantity_edit.trigger('change');\n    },\n\n    // Returns the first address id without a shipment associated to it\n    getFirstAddressIdWithoutShipments: function() {\n        const set_lines: any = this.wizard.model.getSetLines();\n        const addresses = this.getValidAddresses();\n        const default_shipping_address = _.find(addresses, function(address: any) {\n            return address.get('defaultshipping') === 'T';\n        });\n        let is_default_shipping_address_valid: boolean;\n        const selected_address = _.find(addresses, function(address: any) {\n            return !_.find(set_lines, function(line: any) {\n                return line.get('shipaddress') === address.id;\n            });\n        });\n\n        if (default_shipping_address) {\n            is_default_shipping_address_valid = !_.find(set_lines, function(line: any) {\n                return line.get('shipaddress') === default_shipping_address.id;\n            });\n\n            if (is_default_shipping_address_valid) {\n                return default_shipping_address.id;\n            }\n        }\n\n        return selected_address\n            ? selected_address.id\n            : addresses && addresses.length\n            ? (<any>_.first(addresses)).id\n            : null;\n    },\n\n    // Manage the selection or unselection of all items\n    selectUnselectAll: function() {\n        const unset_lines = this.wizard.model.getUnsetLines();\n        const check_lines = _.filter(unset_lines, function(line: any) {\n            return line.get('check');\n        });\n\n        check_lines.length === unset_lines.length ? this.unselectAllItems() : this.selectAllItems();\n\n        this.render();\n    },\n\n    // Returns the count of items selected\n    getSelectedItemsLength: function() {\n        return _.filter(this.wizard.model.getUnsetLines(), function(line: any) {\n            return line.get('check');\n        }).length;\n    },\n\n    // Select all items\n    selectAllItems: function() {\n        _.each(this.wizard.model.getUnsetLines(), function(line: any) {\n            line.set('check', true);\n        });\n    },\n\n    // Unselect all items\n    unselectAllItems: function() {\n        _.each(this.wizard.model.getUnsetLines(), function(line: any) {\n            line.set('check', false);\n            line.unset('splitquantity');\n        });\n    },\n\n    isActive: function() {\n        return (\n            this.wizard.model.get('ismultishipto') && this.wizard.model.shippingAddressIsRequired()\n        );\n    },\n\n    // Returns the list of address available to be part of Multi Ship To\n    getValidAddresses: function() {\n        return this.wizard.options.profile.get('addresses').where({ isvalid: 'T' });\n    },\n\n    // Override Render in order to update Continue and back buttons\n    render: function() {\n        if (this.isActive()) {\n            this.updateContinueButtonState();\n            return WizardStepModule.prototype.render.apply(this, arguments);\n        }\n        this.$el.empty();\n    },\n\n    // Returns the current address id. Used when the page is re-render to avoid losing the selected address in the combo-box\n    getSelectedAddressId: function() {\n        if (\n            !this.selected_address_id ||\n            !this.wizard.options.profile\n                .get('addresses')\n                .where({ internalid: this.selected_address_id }).length\n        ) {\n            this.selected_address_id = this.getFirstAddressIdWithoutShipments();\n        }\n        return this.selected_address_id;\n    },\n\n    // Set the selected address to retrieved it later\n    setSelectedAddressId: function(e) {\n        this.selected_address_id = jQuery(e.target).val();\n        this.render();\n    },\n\n    // Select and un-select an item\n    selectLine: function selectLine(e) {\n        // ignore clicks on anchors, buttons, etc\n        if (Utils.isTargetActionable(e)) {\n            return;\n        }\n\n        const marked_line_id = jQuery(e.currentTarget).data('lineId');\n        const selected_line = this.wizard.model.get('lines').get(marked_line_id);\n\n        selected_line.set('check', !selected_line.get('check'));\n\n        if (!selected_line.get('check')) {\n            selected_line.unset('splitquantity');\n        }\n        this.render();\n    },\n\n    // Determines if the passed in address id has already created at one shipment\n    addressHasShipments: function(address_id) {\n        return !!_.find(this.wizard.model.getShippableLines(), function(item: any) {\n            return item.get('shipaddress') === address_id;\n        });\n    },\n\n    // Update Continue button, enable/disable and change its label\n    updateContinueButtonState: function() {\n        const unapplied_items_length = this.wizard.model.getUnsetLines().length;\n        const selected_items_length = this.wizard.model.get('lines').filter(function(line) {\n            return !!line.get('check');\n        }).length;\n        const selected_address_id = jQuery('[data-action=\"set-shipments-address-selector\"]').val();\n        let continue_enabled;\n\n        continue_enabled = _.all(this.wizard.model.getShippableLines(), function(item: any) {\n            return !!item.get('shipaddress');\n        });\n\n        this.createShipmentEnabled = !(unapplied_items_length > 0 && selected_items_length <= 0);\n\n        if (selected_items_length > 0 && this.addressHasShipments(selected_address_id)) {\n            this.createShipmentLabel = Utils.translate('Add to Shipment');\n        } else {\n            this.createShipmentLabel = Utils.translate('Create Shipment');\n        }\n\n        this.trigger('change_enable_continue', continue_enabled, {\n            onlyContinue: true,\n            notDisableTouchs: true\n        });\n    },\n\n    isValid: function() {\n        return this.wizard.model.getUnsetLines().length && this.isActive()\n            ? jQuery.Deferred().reject(this.allItemShouldBelongToAPackage)\n            : jQuery.Deferred().resolve();\n    },\n\n    restoreModelBeforeApplyAddress: function() {\n        const self = this;\n        _.each(this.linesBeforeApplyAddress, function(value: any, id) {\n            const line = self.wizard.model.get('lines').findWhere({ internalid: id });\n            line.set('shipaddress', value.shipaddress);\n            line.set('check', value.check);\n        });\n    },\n\n    // Apply for all selected lines the current address\n    applyCurrentAddress: function() {\n        this.clearGeneralMessages();\n        const selected_address_id: any = jQuery(\n            '[data-action=\"set-shipments-address-selector\"]'\n        ).val();\n        const self = this;\n        const selected_items_length = this.wizard.model.get('lines').filter(function(line) {\n            return !!line.get('check');\n        }).length;\n        const selected_address = this.wizard.options.profile\n            .get('addresses')\n            .get(selected_address_id);\n        const item_for_address = this.wizard.model.get('lines').groupBy(function(line) {\n            return line.get('shipaddress');\n        })[selected_address_id];\n        let result;\n        const notify_success_message = function() {\n            const message =\n                selected_items_length > 1\n                    ? Utils.translate(\n                          '$(0) items was added to Shipment: $(1)',\n                          selected_items_length,\n                          selected_address.get('fullname')\n                      )\n                    : Utils.translate(\n                          '$(0) item was added to Shipment: $(1)',\n                          selected_items_length,\n                          selected_address.get('fullname')\n                      );\n\n            self.showGeneralMessage(message, false);\n        };\n\n        if (selected_address_id && selected_address) {\n            if (!selected_address.get('check')) {\n                selected_address.set('check', true);\n                this.wizard.model.get('addresses').add(selected_address);\n            }\n\n            this.linesBeforeApplyAddress = {};\n\n            _.each(this.wizard.model.get('lines').where({ check: true }), function(line: any) {\n                self.linesBeforeApplyAddress[line.id] = {\n                    shipaddress: line.get('shipaddress'),\n                    check: line.get('check')\n                };\n                line.set('shipaddress', selected_address_id);\n                line.set('check', false);\n            });\n\n            result = this.wizard.model\n                .save()\n                .fail(function() {\n                    self.restoreModelBeforeApplyAddress();\n                })\n                .then(function() {\n                    self.selected_address_id = self.getFirstAddressIdWithoutShipments();\n                })\n                .then(function() {\n                    self.wizard.model.trigger('multishipto-address-applied');\n                })\n                .then(_.bind(this.render, this));\n\n            // There are already shipments created\n            if (item_for_address && item_for_address.length) {\n                result.then(notify_success_message);\n            } else {\n                result.then(function() {\n                    self.clearGeneralMessages();\n                });\n            }\n\n            return result;\n        }\n        return jQuery.Deferred().resolve();\n    },\n\n    childViews: {\n        'ShippableItems.Collection': function() {\n            return new BackboneCollectionView({\n                collection: this.wizard.model.getUnsetLines(),\n                childView: TransactionLineViewsCellSelectableView,\n                viewsPerRow: 1,\n                childViewOptions: {\n                    navigable: false,\n\n                    detail1Title: Utils.translate('Qty:'),\n                    detail1: OrderWizardModuleMultiShipToSetAddressesPackageEditQuantity,\n\n                    detail2Title: Utils.translate('Unit price:'),\n                    detail2: 'rate_formatted',\n\n                    detail3Title: Utils.translate('Amount:'),\n                    detail3: 'amount_formatted'\n                }\n            });\n        },\n        'Address.Details': function() {\n            return new AddressDetailsView({\n                model: this.wizard.options.profile\n                    .get('addresses')\n                    .get(this.getSelectedAddressId()),\n                hideActions: true,\n                hideDefaults: true,\n                manage: 'shipaddress',\n                hideSelector: true\n            });\n        }\n    },\n\n    // @method getContext @return {OrderWizard.Module.MultiShipTo.Package.Creation.Context}\n    getContext: function() {\n        const addresses = this.getValidAddresses();\n        const current_selected_address_id = this.getSelectedAddressId();\n        const addresses_map = _.map(addresses, function(address: any) {\n            // @class AddressObject\n            return {\n                // @property {String} addressId\n                addressId: address.get('internalid'),\n                // @property {Boolean} isSelected\n                isSelected: address.get('internalid') === current_selected_address_id,\n                // @property {String} addressText\n                addressText: address.get('fullname') + ' - ' + address.get('addr1')\n            };\n        });\n        const unset_lines = this.wizard.model.getUnsetLines();\n        const all_items_length = unset_lines.length;\n        const selected_items_length = this.getSelectedItemsLength();\n        const are_all_items_selected = selected_items_length === all_items_length;\n\n        // @class OrderWizard.Module.MultiShipTo.Package.Creation.Context\n        return {\n            // @property {Boolean} isAnyUnsetLine\n            isAnyUnsetLine: !!unset_lines.length,\n            // @property {Array<AddressObject>} addresses\n            addresses: addresses_map,\n            // @property {Boolean} areAllItemSelected\n            areAllItemSelected: are_all_items_selected,\n            // @property {Number} allItemsLength\n            allItemsLength: all_items_length,\n            // @property {Boolean} isAnySelectedItem\n            isAnySelectedItem: !!selected_items_length,\n            // @property {Boolean} isSelectedItemLengthGreaterThan1\n            isSelectedItemsLengthGreaterThan1: selected_items_length > 1,\n            // @property {Number} selectedItemsLength\n            selectedItemsLength: selected_items_length,\n            // @property {Boolean} isCreateShipmentEnabled\n            isCreateShipmentEnabled: this.createShipmentEnabled,\n            // @property {String} createShipmentLabel\n            createShipmentLabel: this.createShipmentLabel,\n            // @property {String} editAddressesUrl\n            editAddressesUrl: this.options.edit_addresses_url || '',\n            // @property {Boolean} hasMultipleUnsetLines\n            hasMultipleUnsetLines: unset_lines.length > 1\n        };\n    }\n});\n"]}