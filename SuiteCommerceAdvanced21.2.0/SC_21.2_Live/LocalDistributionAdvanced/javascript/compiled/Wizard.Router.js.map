{"version":3,"sources":["Wizard.Router.ts"],"names":[],"mappings":"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","file":"Wizard.Router.js","sourcesContent":["/*\n\t© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Wizard.Router\"/>\n\nimport * as _ from 'underscore';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { ProfileModel } from '../../../Commons/Profile/JavaScript/Profile.Model';\n\nimport View = require('./Wizard.View');\nimport Step = require('./Wizard.Step');\nimport StepGroup = require('./Wizard.StepGroup');\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\n\n// @class Wizard.Router Main component of the wizard, controls routes, the step flow, and to show each\n// step. In general, when something is referred as 'the wizard' is probably an instance of this class. @extend Backbone.Router\nconst WizardRouter: any = Backbone.Router.extend({\n    // @property {Wizard.Step} step\n    step: Step,\n\n    // @property {Wizard.View} view\n    view: View,\n\n    // @property {Wizard.StepGoupd} StepGroup\n    stepGroup: StepGroup,\n\n    // @method initialize Initializes internals and loads configuration\n    // @param {ApplicationSkeleton} application @param {Object} options\n    initialize: function(application, options) {\n        // @property {ApplicationSkeleton} application\n        this.application = application;\n        // @property {Object<String,Wizard.Step>} steps dictionary of step instances by name\n        this.steps = {};\n        // @property {Array<String>} stepsOrder Array of step URLs\n        this.stepsOrder = [];\n        // @property {String} currentStep URL of the current Step\n        this.currentStep = '';\n        // @property {Object<String,Wizard.StepGroup>} stepGroups Dictionary of step group instances by its URLs\n        this.stepGroups = {};\n        // @property {Array} handledErrors\n        this.handledErrors = [];\n\n        this.options = options;\n\n        if (options && options.model) {\n            this.model = options.model;\n        }\n\n        let init_promise;\n\n        if (options && options.steps) {\n            init_promise = this.compileConfiguration(options.steps);\n        }\n\n        // remove duplicates from the handledErrors array\n        this.handledErrors = _.uniq(this.handledErrors);\n\n        return init_promise || jQuery.Deferred().resolve();\n    },\n\n    /*\n\t@method compileConfiguration\n\tInstantiates all the Steps and StepGroups based on the configuration.\n\tThe Expected configuration is as follows:\n\n\t\t[\n\t\t\t{\n\t\t\t\tname: \"Step Group\"\n\t\t\t,\tsteps: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"Step\"\n\t\t\t\t\t,\turl: \"step-url\"\n\t\t\t\t\t,\tmodules: [\n\t\t\t\t\t\t\t'Module.Name'\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\n\t@param {Array} step_groups  This is an Array of Step Groups (Name and Steps), where Steps is an Array of Steps (Name, URL, Modules),\n\twhere Modules is an Array of Strings that will be required(). In general this object is exactly the same as defined in the application's Configuration.js file\n\t*/\n    compileConfiguration: function(step_groups) {\n        const self = this;\n        const promise = jQuery.Deferred();\n\n        // Iterates all the steps\n        const promises = _.map(step_groups, function(step_group: StepGroup, index: number) {\n            if (step_group.steps) {\n                // Instantiates the StepGroup\n                return self\n                    ._compileStepGroup(step_group, index)\n                    .then(function(step_group_instance) {\n                        // Iterates the step of the step group\n                        const step_promises = _.map(step_group.steps, function(step) {\n                            return self._compileStep(step, step_group_instance);\n                        });\n\n                        return jQuery.when.apply(jQuery, step_promises);\n                    }, promise.reject);\n            }\n        });\n\n        jQuery.when.apply(jQuery, promises).then(promise.resolve, promise.reject);\n\n        return promise;\n    },\n\n    _compileStep: function _compileStep(step, step_group_instance) {\n        const deferred = jQuery.Deferred();\n        try {\n            const self = this;\n\n            self.promise = self.promise || jQuery.Deferred().resolve();\n\n            self.promise = self.promise.then(\n                function() {\n                    try {\n                        const step_index = _.isNumber(step.step_index)\n                            ? step.step_index\n                            : self.stepsOrder.length;\n\n                        delete step.step_index;\n\n                        // Extends the base class with your configuration\n                        const StepClass = self.step.extend(step);\n\n                        // Initializes it\n                        self.steps[step.url] = new StepClass({\n                            wizard: self,\n                            stepGroup: step_group_instance,\n                            step_url: step.url\n                        });\n\n                        // add the step to the step-group\n                        step_group_instance.steps.push(self.steps[step.url]);\n\n                        // sets it in an ordered group\n                        self.stepsOrder.splice(step_index, 0, step.url);\n\n                        // Routes it\n                        self._registerPageType({ routes: [step.url, `${step.url}?:options`] });\n\n                        deferred.resolve(self.steps[step.url]);\n                    } catch (error) {\n                        deferred.reject(error);\n                    }\n                },\n                function(error) {\n                    deferred.reject(error);\n                    return jQuery.Deferred().resolve();\n                }\n            );\n        } catch (error) {\n            deferred.reject(error);\n        }\n        return deferred;\n    },\n\n    _registerPageType: function _registerPageType(options) {\n        const pageType = this.application.getComponent('PageType');\n\n        pageType.registerPageType({\n            name: 'wizard',\n            routes: options.routes,\n            view: View\n        });\n    },\n\n    _compileStepGroup: function _compileStepGroup(step_group, index) {\n        const deferred = jQuery.Deferred();\n        try {\n            const self = this;\n            const step_group_instance = new self.stepGroup(\n                step_group.name,\n                step_group.steps[0].url\n            );\n\n            const groups = _.values(self.stepGroups);\n\n            groups.splice(index, 0, step_group_instance);\n            _.each(groups, function(group, group_index) {\n                group.index = group_index;\n            });\n\n            self.stepGroups = _.indexBy(groups, 'name');\n\n            deferred.resolve(step_group_instance);\n        } catch (error) {\n            deferred.reject(error);\n        }\n        return deferred;\n    },\n\n    // @method getCurrentStep @return {Wizard.Step} the current step object\n    getCurrentStep: function() {\n        return this.steps[this.currentStep];\n    },\n\n    // @method goToNextStep finds the next steps and navigates to it\n    goToNextStep: function() {\n        const next_step_url = this.getNextStepUrl();\n        const url_options = Utils.parseUrlOptions(Backbone.history.location.hash);\n\n        if (next_step_url) {\n            const params = Backbone.history.location.hash\n                ? Backbone.history.location.hash.split('?')\n                : [];\n\n            this.indirectURL = true;\n            this.navigate(\n                url_options.force\n                    ? Utils.addParamsToUrl(next_step_url, { force: 'true' })\n                    : next_step_url,\n                { trigger: true }\n            );\n        }\n    },\n\n    // @method getNextStepUrl @param {Number} index @return {String}\n    getNextStepUrl: function(index) {\n        index = index || _.indexOf(this.stepsOrder, this.currentStep);\n\n        if (~index && index + 1 < this.stepsOrder.length) {\n            if (this.steps[this.stepsOrder[index + 1]].showStep(this)) {\n                return this.stepsOrder[index + 1];\n            }\n\n            return this.getNextStepUrl(index + 1);\n        }\n    },\n\n    // @method getActiveStepsGroups @return {Array<Wizard.StepGroup>}\n    getActiveStepsGroups: function() {\n        return _(this.stepGroups).filter(function(step_group: StepGroup) {\n            return step_group.showStepGroup();\n        });\n    },\n\n    // @method getFirstStepUrl @return {String}\n    getFirstStepUrl: function() {\n        const active_steps = this.getActiveStepsGroups();\n\n        return active_steps[0] && active_steps[0].getURL();\n    },\n\n    // @method goToPreviousStep finds the previous steps and navigates to it\n    goToPreviousStep: function() {\n        const previous_step_url = Utils.addParamsToUrl(this.getPreviousStepUrl(), {\n            force: 'true'\n        });\n\n        if (previous_step_url) {\n            const params = previous_step_url.split('?');\n\n            this.indirectURL = true;\n            this.navigate(previous_step_url, { trigger: true });\n        }\n    },\n\n    // @method getPreviousStepUrl\n    // @param {Number} index\n    // @return {String}\n    getPreviousStepUrl: function(index) {\n        if (_.isUndefined(index)) {\n            index = _.indexOf(this.stepsOrder, this.currentStep);\n        }\n\n        if (index > 0) {\n            if (this.steps[this.stepsOrder[index - 1]].showStep(this)) {\n                return this.stepsOrder[index - 1];\n            }\n\n            return this.getPreviousStepUrl(index - 1);\n        }\n        const base_step = this.stepsOrder[0];\n\n        if (this.steps[base_step].showStep(this)) {\n            return base_step;\n        }\n    },\n\n    // @method getStepPosition Returns the distance of the current step from the start and to the end\n    // If you are in the 2nd step of a 5 steps wizard it will return:\n    // { fromBegining: 1, toLast: 3 }\n    // @param {String} URL\n    // @return {fromBegining:Number,toLast:Number}\n    getStepPosition: function(url) {\n        const index = _.indexOf(this.stepsOrder, url || this.currentStep);\n        let fromBegining = 0;\n        let toLast = 0;\n        const keys = _.keys(this.steps);\n\n        for (let i = 0; i < keys.length; i++) {\n            if (i < index && this.steps[keys[i]].showStep()) {\n                fromBegining++;\n            } else if (i > index && this.steps[keys[i]].showStep()) {\n                toLast++;\n            }\n        }\n\n        return {\n            fromBegining: fromBegining,\n            toLast: toLast\n        };\n    },\n\n    // @method isCurrentStepFirst\n    // @return {Boolean}\n    isCurrentStepFirst: function(): boolean {\n        let current_step_index = _.indexOf(this.stepsOrder, this.currentStep);\n\n        if (current_step_index > 0) {\n            do {\n                if (this.steps[this.stepsOrder[--current_step_index]].showStep()) {\n                    return false;\n                }\n            } while (current_step_index);\n        }\n        return true;\n    },\n\n    _runStep: function _runStep() {\n        return this.runStep.apply(this, arguments);\n    },\n\n    // @method runStep Executes the current step: Calls the status methods of the steps (past, present, future).\n    // And renders the Frame view.\n    runStep: function() {\n        let url = Backbone.history.fragment;\n        const self = this;\n        const promise = jQuery.Deferred();\n\n        // We allow URLs to have options but they are still identified by the original string,\n        // so we need to take them out if present\n        url = url.split('?')[0];\n\n        if (this.steps[url]) {\n            let confirmation = this._getPropAsModelInstance('confirmation');\n\n            confirmation =\n                confirmation &&\n                (confirmation.get('confirmationnumber') ||\n                    confirmation.get('tranid') ||\n                    confirmation.get('internalid'));\n\n            const profile_model = ProfileModel.getInstance();\n\n            const { checkoutApp, siteSettings } = this.application.getConfig();\n            if (\n                (checkoutApp.skipLogin &&\n                    siteSettings.registration.registrationoptional === 'T' &&\n                    profile_model.get('isRecognized') === 'F') ||\n                profile_model.get('isLoggedIn') === 'T'\n            ) {\n                // We keep a reference to the current step URL here\n                this.currentStep = url;\n\n                // Iterates all the steps and calls the status methods\n                let method_to_call = 'past';\n                let current_group;\n                const past_promises = [];\n\n                _.each(this.stepsOrder, function(step: string) {\n                    if (step === url) {\n                        self.steps[step].present();\n                        self.steps[step].state = 'present';\n                        self.steps[step].stepGroup.state = 'present';\n                        self.steps[step].tellModules('present');\n                        method_to_call = 'future';\n                        current_group = self.steps[step].stepGroup;\n                    } else {\n                        self.steps[step].tellModules(method_to_call);\n                        let past_promise = !confirmation && self.steps[step][method_to_call]();\n\n                        if (method_to_call === 'past' && past_promise) {\n                            past_promise = past_promise.then(jQuery.noop, function() {\n                                throw step;\n                            });\n                        }\n                        past_promises.push(past_promise);\n\n                        self.steps[step].state = method_to_call;\n\n                        // if the step is contained in the current_group we don't change the group state\n                        if (self.steps[step].stepGroup !== current_group) {\n                            self.steps[step].stepGroup.state = method_to_call;\n                        }\n                    }\n                });\n\n                jQuery.when.apply(jQuery, past_promises).then(promise.resolve, function(step_url) {\n                    // If some of the \"past\" steps failed, browse back to that step\n                    promise.reject();\n                    Backbone.history.navigate(step_url, { trigger: true });\n                });\n            } else {\n                promise.reject();\n                Backbone.history.navigate('login-register', { trigger: true });\n            }\n        } else {\n            promise.resolve();\n        }\n\n        return promise;\n    },\n\n    // @method _getPropAsModelInstance Make a new instance if the property isn't a Backbone.Model instance\n    // @param {Backbone.Model|Object} name\n    // @return {Backbone.Model}\n    _getPropAsModelInstance: function _getPropAsModelInstance(name) {\n        let property = this.model ? this.model.get(name) : null;\n\n        if (!(property instanceof Backbone.Model)) {\n            property = new Backbone.Model(property);\n        }\n\n        return property;\n    },\n\n    // @method processErrorMessage Fix errors message that contains anchors HTML to correctly point to URLs\n    // that are not handle by the navigation helper\n    // @param {String} error_message\n    // @return {String}\n    processErrorMessage: function(error_message) {\n        const $error = jQuery('<div>').append(error_message);\n        $error.find('a').attr('data-navigation', 'ignore-click');\n\n        return $error.html();\n    },\n\n    // @method manageError central hub for managing errors, the errors should be in the format:\n    // ```{errorCode:'ERR_WS_SOME_ERROR', errorMessage:'Some message'}```.\n    // The method also receives the step in case that the error is not handled by any module\n    manageError: function(error, step) {\n        if (_.isObject(error) && error.responseJSON) {\n            const errorJSON = error.responseJSON;\n            error = {\n                errorCode: 'ERR_WS_ERROR',\n                errorMessage: _.unescape(\n                    Utils.getTranslatedMessage(\n                        errorJSON.errorCode,\n                        errorJSON.errorMessage,\n                        errorJSON.errorParameters\n                    )\n                )\n            };\n        } else if (_.isString(error)) {\n            error = {\n                errorCode: 'ERR_WS_UNHANDLED_ERROR',\n                errorMessage: _.unescape(error)\n            };\n        } else if (!_.isObject(error)) {\n            error = {\n                errorCode: 'ERR_WS_UNHANDLED_ERROR',\n                errorMessage: Utils.translate('An error has occurred')\n            };\n        }\n\n        if (~_.indexOf(this.handledErrors, error.errorCode)) {\n            this.trigger(error.errorCode, error);\n        } else {\n            // if the error is not handled but we receive a step we delegate the error to it\n            if (step) {\n                step.moduleError(null, error);\n            } else {\n                // if no one is listening for this error, we show the message on the current step\n                this.getCurrentStep().error = error;\n                this.getCurrentStep().showError();\n            }\n        }\n    }\n});\n\nexport = WizardRouter;\n"]}