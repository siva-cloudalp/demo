{"version":3,"sources":["Item.KeyMapping.ts"],"names":[],"mappings":"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","file":"Item.KeyMapping.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Item.KeyMapping\"/>\nimport * as _ from 'underscore';\nimport '../../UrlHelper/JavaScript/UrlHelper';\n\nimport * as Utils from '../../Utilities/JavaScript/Utils';\n\nconst ItemKeyMapping: any = {\n    getKeyMapping: function(configuration: any) {\n        /*\n\t\t\t@class ItemsKeyMapping can be used by Backbone Model to add high level semantic attributes defined here.\n\t\t\tFor example, @?class Item.Model override its get() method to support these attributes. So for example\n\t\t\titem.get('_name') will return the _name semantics in property defined here.\n\n\t\t\tIf the property value is a string then that attribute will be used. If the value is a function, then the\n\t\t\tfunction is evaluated passing the item model as first argument.\n\t\t */\n        return {\n            // @property {String} _id Item Internal Id: used as a fallback to the URL and to add to cart\n            // You should not need to change this tho\n            _id: 'internalid',\n\n            // @property {String} _sku Item SKU number\n            _sku: function(item) {\n                return item.get('itemid') || '';\n            },\n\n            // @property {String} _name Name of the item, some times displayname is empty but storedisplayname2 tends to be set always\n            _name: function(item) {\n                // If its a matrix child it will use the name of the parent\n                const item_id = item.get('itemid') || '';\n                const parent = item.get('_matrixParent');\n                if (parent.get('internalid')) {\n                    // we need the displayname included in the itemdid, see #B-11868\n                    const matches = item_id.match(/:(.*)/);\n                    const child_name = matches && matches[1];\n                    return (\n                        child_name ||\n                        parent.get('storedisplayname2') ||\n                        parent.get('displayname') ||\n                        item_id\n                    );\n                }\n\n                // Otherwise return its own name\n                return item.get('storedisplayname2') || item.get('displayname') || item_id;\n            },\n\n            // @property {String} _pageTitle Page Title of the PDP\n            _pageTitle: ['pagetitle', 'storedisplayname2', 'displayname'],\n\n            // @property {String}  _pageHeader h1 of the PDP and also the title of the modal\n            _pageHeader: ['storedisplayname2', 'displayname'],\n\n            // @property {String}  _keywords\n            _keywords: 'searchkeywords',\n\n            // @property {String} _metaTags\n            _metaTags: 'metataghtml',\n\n            // @method _breadcrumb This returns the breadcrum json obj for the PDP\n            // @property {Item.Model} item Model of a specific item\n            // @return {Array<Object>} breadcrumb An array of objects containing breadcrumb info\n            _breadcrumb: function(item) {\n                const breadcrumb = [];\n                const commercecategory = item.get('commercecategory');\n\n                if (\n                    commercecategory &&\n                    commercecategory.primarypath &&\n                    commercecategory.primarypath.length\n                ) {\n                    const primarypath = _.sortBy(commercecategory.primarypath, function(path: any) {\n                        return path.urls[0];\n                    });\n\n                    _.each(primarypath, function(path) {\n                        breadcrumb.push({\n                            href: path.urls[0],\n                            text: path.name\n                        });\n                    });\n                }\n\n                breadcrumb.push({\n                    href: item.get('_url'),\n                    text: item.get('_name')\n                });\n\n                return breadcrumb;\n            },\n\n            // @property {String} _url Url of the item\n            _url: function(item) {\n                const matrixParent = item.get('_matrixParent');\n                // If this item is a child of a matrix return the URL of the parent\n                if (!_.isEmpty(matrixParent) && matrixParent.get('internalid')) {\n                    return item.get('_matrixParent').get('_url');\n                }\n                // if its a standard version we need to send it to the canonical URL\n                if (SC.ENVIRONMENT.siteType && SC.ENVIRONMENT.siteType === 'STANDARD') {\n                    return item.get('canonicalurl');\n                }\n                if (\n                    SC.Configuration &&\n                    SC.Configuration.isSCIS &&\n                    item.get('itemoptions_detail') &&\n                    item.get('itemoptions_detail').parentid &&\n                    item.get('itemoptions_detail').matrixtype === 'child'\n                ) {\n                    return item.get('urlcomponent')\n                        ? '/' + item.get('urlcomponent')\n                        : '/product/' + item.get('itemoptions_detail').parentid;\n                }\n\n                // Other ways it will use the URL component or a default /product/ID\n                return item.get('urlcomponent')\n                    ? '/' + item.get('urlcomponent')\n                    : '/product/' + item.get('internalid');\n            },\n\n            // @property {String} _thumbnail Object containing the url and the altimagetext of the thumbnail\n            _thumbnail: function(item) {\n                const item_images_detail = item.get('itemimages_detail') || {};\n\n                // If you generate a thumbnail position in the itemimages_detail it will be used\n                if (item_images_detail.thumbnail) {\n                    if (\n                        _.isArray(item_images_detail.thumbnail.urls) &&\n                        item_images_detail.thumbnail.urls.length\n                    ) {\n                        return item_images_detail.thumbnail.urls[0];\n                    }\n\n                    return item_images_detail.thumbnail;\n                }\n\n                // otherwise it will try to use the storedisplaythumbnail\n                if (\n                    SC.ENVIRONMENT.siteType &&\n                    SC.ENVIRONMENT.siteType === 'STANDARD' &&\n                    item.get('storedisplaythumbnail')\n                ) {\n                    return {\n                        url: item.get('storedisplaythumbnail'),\n                        altimagetext: item.get('_name')\n                    };\n                }\n                // No images huh? carry on\n\n                const parent_item = item.get('_matrixParent');\n                // If the item is a matrix child, it will return the thumbnail of the parent\n                if (parent_item && parent_item.get('internalid')) {\n                    return parent_item.get('_thumbnail');\n                }\n\n                const images = Utils.imageFlatten(item_images_detail);\n                // If you using the advance images features it will grab the 1st one\n                if (images.length) {\n                    for (let i = 0; i < images.length; i++) {\n                        const detail = images[i];\n                        const splitted = detail.url.split('.');\n                        if (splitted[splitted.length - 2] === 'default') {\n                            return detail;\n                        }\n                    }\n                    return images[0];\n                }\n\n                // still nothing? image the not available\n                return {\n                    url: Utils.getThemeAbsoluteUrlOfNonManagedResources(\n                        'img/no_image_available.jpeg',\n                        configuration.get('imageNotAvailable')\n                    ),\n                    altimagetext: item.get('_name')\n                };\n            },\n\n            // @property {Array} _images Array of objects containing the URL and the altimagetext of the images of the item\n            _images: function(item) {\n                let result = [];\n                let item_images_detail = item.get('itemimages_detail') || {};\n\n                item_images_detail = item_images_detail.media || item_images_detail;\n\n                result = Utils.imageFlatten(item_images_detail);\n\n                return result.length\n                    ? result\n                    : [\n                          {\n                              url: Utils.getThemeAbsoluteUrlOfNonManagedResources(\n                                  'img/no_image_available.jpeg',\n                                  configuration.get('imageNotAvailable')\n                              ),\n                              altimagetext: item.get('_name')\n                          }\n                      ];\n            },\n\n            // @property _matrixParent For matrix child items in the cart we generate this position so we have a link to the parent\n            _matrixParent: 'matrix_parent',\n\n            // @property _matrixChilds For matrix parent items, where are the attributes of the children\n            _matrixChilds: 'matrixchilditems_detail',\n\n            // @property  _optionsDetailsThe definition of the options of items with options\n            _optionsDetails: 'itemoptions_detail',\n\n            // @property _relatedItems Related items\n            _relatedItems: 'related_items',\n\n            // @property _relatedItemsDetail _relatedItemsDetail Related items in the PDP.\n            _relatedItemsDetail: 'relateditems_detail',\n\n            // @property _correlatedItemsDetail Correlated (Up-sell) items in the PDP.\n            _correlatedItemsDetail: 'correlateditems_detail',\n\n            // @property _priceDetails Item price information. This property returned by the Search API defines the type class OnlineCustomerPriceDetail\n            // @class OnlineCustomerPriceDetail\n            // @property {Number} onlinecustomerprice This is the default price of the item. IMPORTANT: This value take into account the item already present in the cart.\n            // So if you have defined quantity pricing, this property wont show the price for quantity 1 but rather for the quantity already present in the cart. (Tested for NO matrix item)\n            // @property {String} onlinecustomerprice_formatted This property shows the value of the property onlinecustomerprice formatted with the current currency\n            // @property {Array<OnlineCustomerPriceDetail.PriceSchedule>?} priceschedule List of prices present when the item has quantity prices configured.\n            // @class OnlineCustomerPriceDetail.PriceSchedule Class that indicate for a quantity range the price of an item\n            // @property {Number} maximumquantity Maximum quantity inside of the current range\n            // @property {Number} minimumquantity Minimum quantity inside of the current range\n            // @property {Number} price Price corresponding to the item when the specified quantity is in the range specified for the current class\n            // @property {String} @property {Number} price Price property formatted based on the current currency\n            // @class ItemsKeyMapping\n            _priceDetails: 'onlinecustomerprice_detail',\n\n            // @property {String} _price\n            _price: function(item) {\n                return (\n                    (item.get('onlinecustomerprice_detail') &&\n                        item.get('onlinecustomerprice_detail').onlinecustomerprice) ||\n                    ''\n                );\n            },\n\n            // @property {String} _price_formatted\n            _price_formatted: function(item) {\n                return (\n                    (item.get('onlinecustomerprice_detail') &&\n                        item.get('onlinecustomerprice_detail').onlinecustomerprice_formatted) ||\n                    ''\n                );\n            },\n\n            // @property {Number} _comparePriceAgainst Returns the default price of the passed in item assuming quantity minimum quantity. This method check if quantity pricing is configured.\n            _comparePriceAgainst: function(item) {\n                const prices = item.get('_priceDetails');\n\n                if (prices) {\n                    // The priceschedule is the array containing the quantity range and the price\n                    if (prices.priceschedule) {\n                        // The index 0 will be the case when the quantity is greater than 0 and lower than prices.priceschedule[0].maximumquantity\n                        return prices.priceschedule[0].price;\n                    }\n                    return prices.onlinecustomerprice;\n                }\n                // This is the default price, equivalent to onlinecustomerprice but without taking into account the amount of items into the cart\n                // This value returns the 'Base Price'\n                return item.get('pricelevel1');\n            },\n\n            // @property {String} _comparePriceAgainstFormated This method a formatted version of the method _comparePriceAgainst\n            _comparePriceAgainstFormated: function(item) {\n                const prices = item.get('_priceDetails');\n\n                if (prices) {\n                    if (prices.priceschedule) {\n                        return prices.priceschedule[0].price_formatted;\n                    }\n                    return prices.onlinecustomerprice_formatted;\n                }\n                return item.get('pricelevel1_formatted');\n            },\n\n            // @property _itemType Item Type\n            _itemType: 'itemtype',\n\n            // @property {Number} _stock The number of items you have available\n            _stock: 'quantityavailable',\n\n            // @property {Number} _minimumQuantity\n            _minimumQuantity: function(item) {\n                return item.get('minimumquantity') || 1;\n            },\n            // @property {Number} _maximumQuantity\n            _maximumQuantity: function(item) {\n                return item.get('maximumquantity');\n            },\n\n            // @property {Boolean} _isReturnable\n            _isReturnable: function(item) {\n                const type = item.get('itemtype');\n\n                return type === 'InvtPart' || type === 'NonInvtPart' || type === 'Kit';\n            },\n\n            // @property {Boolean} _isInStock\n            _isInStock: 'isinstock',\n\n            // @property {Boolean} _isPurchasable\n            _isPurchasable: 'ispurchasable',\n\n            // @property {Boolean} _isBackorderable\n            _isBackorderable: 'isbackorderable',\n\n            // @property {Boolean} _showOutOfStockMessage\n            _showOutOfStockMessage: 'showoutofstockmessage',\n\n            // @property {Boolean} _isfulfillable\n            _isfulfillable: function(item) {\n                return item.get('isfulfillable') !== false;\n            },\n\n            // @property {Boolean} _showInStockMessage Show the IN STOCK label, this can be configured in a per item basis\n            _showInStockMessage: function() {\n                return false;\n            },\n            // @property {Boolean} _showQuantityAvailable Show the quantity available for this item.\n            _showQuantityAvailable: function() {\n                return true;\n            },\n\n            // @property {Boolean} _showStockDescription Should we show the stock description?\n            _showStockDescription: function() {\n                return true;\n            },\n\n            // @property {String} _stockDescription Stock Description, some times used to display messages like New Arrival, Ships in 3 days or Refubrished\n            _stockDescription: 'stockdescription',\n\n            // @property {String} _stockDescriptionClass Stock Description class, we use this to add a class to the HTML element containing the _stockDescription so you can easily style it.\n            // This implementation will strip spaces and other punctuations from the _stockDescription and prepends stock-description-\n            // so if your _stockDescription is 'Ships in 3 days' your _stockDescriptionClass will be stock-description-ships-in-3-days\n            _stockDescriptionClass: function(item) {\n                return (\n                    'stock-description-' +\n                    (item.get('_stockDescription') || '')\n                        .toLowerCase()\n                        .replace(/[\\W\\\"]+/g, '-')\n                        .replace(/\\-+/g, '-')\n                );\n            },\n\n            // @property {String} _outOfStockMessage What to write when the item is out of stock\n            _outOfStockMessage: function(item) {\n                return item.get('outofstockmessage2') || item.get('outofstockmessage');\n            },\n\n            // @property {String} _inStockMessage What to write when the item is in stock\n            _inStockMessage: function() {\n                return Utils.translate('In Stock');\n            },\n\n            // Reviews related item attributes\n\n            // @property {Number} _rating Overall item rating\n            _rating: function(item) {\n                return Math.round(item.get('custitem_ns_pr_rating') * 10) / 10 || 0;\n            },\n\n            // @property {Number} _ratingsCount How many times this item was reviewed\n            _ratingsCount: function(item) {\n                return item.get('custitem_ns_pr_count') || 0;\n            },\n\n            // @property {Array<String>} _attributesToRateOn What are the possible attributes I want this item to be rated on\n            _attributesToRateOn: function(item) {\n                const attributes = item.get('custitem_ns_pr_item_attributes') || '';\n\n                return _.reject(attributes.split(', '), function(attribute) {\n                    return !attribute || attribute === '&nbsp;';\n                });\n            },\n\n            // @property _attributesRating returns a object containing the average rating per attribute\n            _attributesRating: function(item) {\n                return (\n                    (item.get('custitem_ns_pr_attributes_rating') &&\n                        JSON.parse(item.get('custitem_ns_pr_attributes_rating'))) ||\n                    {}\n                );\n            },\n\n            // @property _ratingsCountsByRate returns an object containing how many reviews it the item has for each particular rating\n            _ratingsCountsByRate: function(item) {\n                return (\n                    (item.get('custitem_ns_pr_rating_by_rate') &&\n                        JSON.parse(item.get('custitem_ns_pr_rating_by_rate'))) ||\n                    {}\n                );\n            },\n            // @property {Boolean} _isstorepickupallowed\n            _isstorepickupallowed: 'isstorepickupallowed',\n\n            // @property {Object} _quantityavailableforstorepickup_detail returns an object with stock information per location.\n            _quantityavailableforstorepickup_detail: function(item) {\n                return (\n                    (item.get('quantityavailableforstorepickup_detail') &&\n                        item.get('quantityavailableforstorepickup_detail').locations) ||\n                    []\n                );\n            }\n        };\n    }\n};\nexport = ItemKeyMapping;\n"]}