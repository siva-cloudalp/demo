{"version":3,"sources":["NavigationHelper.Plugins.DataTouchPoint.ts"],"names":[],"mappings":"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","file":"NavigationHelper.Plugins.DataTouchPoint.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"NavigationHelper.Plugins.DataTouchPoint\"/>\n/// <reference path=\"../../../Commons/Utilities/JavaScript/GlobalDeclarations.d.ts\" />\n\nimport '../../Session/JavaScript/Session';\nimport * as _ from 'underscore';\nimport * as Utils from '../../Utilities/JavaScript/Utils';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\n\nimport { UrlHelper } from '../../UrlHelper/JavaScript/UrlHelper';\n\nimport Tracker = require('../../Tracker/JavaScript/Tracker');\nimport Backbone = require('../../Utilities/JavaScript/backbone.custom');\n\n// @class NavigationHelper.Plugins.DataTouchPoint Contains\n// the plugins that implement the touchpoints link behavior.\n// This is a link like ```<a data-touchpoint=\"home\" data-hashtag=\"search\">Shop</a>```\n// will always navigate to Shopping search page, no matter where it is defined.\n// @extends ApplicationModule\nconst dataTouchPointPlugins: any = {\n    // @method getLocaleHost @returns the host for the language specified\n    // @param {String} locale locale to look for\n    // @return {String} locale host\n    getLocaleHost: function(locale) {\n        const available_hosts = SC.ENVIRONMENT.availableHosts;\n        let target_host;\n\n        if (available_hosts && available_hosts.length) {\n            for (let i = 0; i < available_hosts.length; i++) {\n                const host = available_hosts[i];\n                const lang: any = _(host.languages).findWhere({ locale: locale });\n\n                if (lang && lang.host) {\n                    target_host = lang.host;\n                    break;\n                }\n            }\n        }\n\n        return target_host;\n    },\n\n    // @method preserveLanguage Given a URL, if not secure (not my account nor checkout), replace the host based on the current language\n    // @param {NavigationContext} context\n    // @return {NavigationContext}\n    preserveLanguage: function(context) {\n        let { url } = context;\n\n        if (Utils.isShoppingDomain()) {\n            const locale_host = dataTouchPointPlugins.getLocaleHost(\n                SC.ENVIRONMENT.currentLanguage.locale\n            );\n            if (locale_host) {\n                url = url.replace(/(http:\\/\\/)([^/?#]*)([^>]*)/gi, function(\n                    all,\n                    protocol,\n                    host,\n                    rest\n                ) {\n                    return protocol + locale_host + rest;\n                });\n            }\n\n            if (/\\?$/.test(url)) {\n                url = url.substring(0, url.length - 1);\n            }\n\n            context.url = url;\n        } else {\n            const current_language = SC.ENVIRONMENT.currentLanguage;\n            if (current_language) {\n                context.target_data.parameters = context.target_data.parameters\n                    ? `${context.target_data.parameters}&lang=${current_language.locale}`\n                    : `lang=${current_language.locale}`;\n            }\n        }\n\n        return context;\n    },\n\n    // @method addParametersToTouchpoint Add data- parameters specified in the target element into the final target touchpoint\n    // @param {NavigationContext} context\n    // @return {NavigationContext}\n    addParametersToUrl: function(context) {\n        if (context.target_data.parameters) {\n            context.url += (~context.url.indexOf('?') ? '&' : '?') + context.target_data.parameters;\n        }\n\n        return context;\n    },\n\n    // @method addHashtagToTouchPoint Adds any hashtag from the context into the final target touchpoint\n    // @param {NavigationContext} context\n    // @return {NavigationContext}\n    addHashtagToTouchPoint: function(context) {\n        if (\n            SC.ENVIRONMENT.siteSettings.sitetype === 'ADVANCED' &&\n            context.hashtag &&\n            context.hashtag !== '#' &&\n            context.hashtag !== '#/'\n        ) {\n            context.target_touchpoint += `${\n                ~context.target_touchpoint.indexOf('?') ? '&' : '?'\n            }fragment=${context.clean_hashtag}`;\n        }\n\n        return context;\n    },\n\n    // @method generateUrl Based on an already processed context it generate the final URL\n    // @param {NavigationContext} context\n    // @param {ApplicationSkeleton} application\n    // @param {ApplicationSkeleton.Layout} layout\n    // @return {NavigationContext}\n    generateUrl: function(context, application, layout) {\n        if (context.original_touchpoint === application.getConfig().currentTouchpoint) {\n            let prefix = '#';\n\n            if (\n                Backbone.history.options &&\n                Backbone.history.options.pushState &&\n                context.clean_hashtag\n            ) {\n                prefix = context.clean_hashtag.indexOf('/') === 0 ? '' : '/';\n            }\n\n            context.url = context.clean_hashtag\n                ? prefix + context.clean_hashtag\n                : layout.getUrl(context);\n        } else if (context.clean_hashtag && context.clean_hashtag.indexOf('http') !== -1) {\n            context.url = Utils.addParamsToUrl(\n                context.clean_hashtag,\n                Utils.parseUrlOptions(context.target_touchpoint)\n            );\n        } else {\n            context.url = UrlHelper.fixUrl(context.target_touchpoint);\n\n            // We need to make this url absolute in order for this to navigate\n            // instead of being triggered as a hash\n            if (context.url && !(~context.url.indexOf('http:') || ~context.url.indexOf('https:'))) {\n                context.url = `${location.protocol}//${location.host}${context.url}`;\n            }\n        }\n\n        return context;\n    },\n\n    // @method addCrosDomainParams Add extra cross domain parameters into the final URL\n    // @param {NavigationContext} context\n    // @return {NavigationContext} context\n    addCrosDomainParams: function(context) {\n        if (\n            context.url &&\n            (context.url.indexOf('http:') !== -1 || context.url.indexOf('https:') !== -1)\n        ) {\n            // Cross Domain Cookie Tracking:\n            // Trackers like Google Analytics require us to send special parameters in the URL\n            // to keep tracking the user as one entity even when moving to a different domain\n            if (Tracker.getInstance().addCrossDomainParameters) {\n                context.url = Tracker.getInstance().addCrossDomainParameters(context.url);\n            }\n        }\n\n        return context;\n    },\n\n    // @method getTargetUrl Apply the entire process of generating the final URL and return it\n    // @param {NavigationContext} context\n    // @param {ApplicationSkeleton} application\n    // @param {ApplicationSkeleton.Layout} layout\n    // @return {String}\n    getTargetUrl: function(context, application, layout) {\n        context = dataTouchPointPlugins.addHashtagToTouchPoint(context);\n        context = dataTouchPointPlugins.generateUrl(context, application, layout);\n        context = dataTouchPointPlugins.preserveLanguage(context);\n        context = dataTouchPointPlugins.addParametersToUrl(context);\n        context = dataTouchPointPlugins.addCrosDomainParams(context);\n\n        return context.url;\n    },\n\n    // @method correctURL Public plugin to fix data-touchpoint URLs\n    // @param {ApplicationSkeleton.Layout} layout\n    // @param {ApplicationSkeleton} application\n    // @param {jQuery.Event} e\n    // @return {jQuery.Event} e\n    correctURL: function(layout, application, e) {\n        const context = layout.generateNavigationContext(e);\n\n        if (context.target_data.touchpoint) {\n            layout.isTouchMoveEvent = false;\n\n            if (e.type === 'touchstart') {\n                e.stopPropagation();\n            }\n\n            // 2 = middle click, 3 = right click\n            if (e.which === 2 || e.which === 3) {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n\n            const new_url = dataTouchPointPlugins.getTargetUrl(context, application, layout);\n\n            layout.setUrl(context.$target, new_url);\n        }\n\n        return e;\n    },\n\n    // @method setHashtag Detects if you are trying to access a different hashtag within the same touchpoint\n    // @param {ApplicationSkeleton.Layout} layout\n    // @param {ApplicationSkeleton} application\n    // @param {jQuery.Event} e\n    // @return {jQuery.Event} e\n    setHashtag: function(layout, application, e) {\n        const context = layout.generateNavigationContext(e);\n        const target_is_blank = layout.isTargetBlank(e) || (e.button && e.button !== 0);\n\n        const storeLocatorTouchpoint = Configuration.get('siteSettings.isHttpsSupported')\n            ? 'home'\n            : 'checkout';\n        const isStoreLocator = context.target_data.touchpoint === 'storelocator';\n\n        if (context.target_data.touchpoint) {\n            const { currentTouchpoint } = application.getConfig();\n            if (\n                !target_is_blank &&\n                context.target_data.hashtag &&\n                currentTouchpoint &&\n                currentTouchpoint ===\n                    (isStoreLocator ? storeLocatorTouchpoint : context.target_data.touchpoint)\n            ) {\n                const new_url = Utils.correctURL(context.target_data.hashtag);\n\n                layout.setUrl(context.$target, new_url);\n            }\n\n            if (e.type === 'touchend' && !layout.isTouchMoveEvent) {\n                e.stopPropagation();\n                e.preventDefault();\n\n                context.$target.trigger('click');\n            }\n        }\n\n        return e;\n    },\n\n    // @method mountToApp Mount to Application\n    mountToApp: function(application) {\n        const layout = application.getLayout();\n\n        // INSTALL DEFAULT NAVIGATION PLUGINS\n        layout.mouseDown.install({\n            name: 'mouseDownFixHrefDataTouchPoint',\n            priority: 10,\n            execute: function(e) {\n                return dataTouchPointPlugins.correctURL(layout, application, e);\n            }\n        });\n\n        layout.touchStart.install({\n            name: 'touchStartFixHrefDataTouchPoint',\n            priority: 10,\n            execute: function(e) {\n                return dataTouchPointPlugins.correctURL(layout, application, e);\n            }\n        });\n\n        layout.mouseUp.install({\n            name: 'correctHashtagsDataTouch',\n            priority: 10,\n            execute: function(e) {\n                return dataTouchPointPlugins.setHashtag(layout, application, e);\n            }\n        });\n\n        layout.touchEnd.install({\n            name: 'correctHashtagsDataTouch',\n            priority: 10,\n            execute: function(e) {\n                return dataTouchPointPlugins.setHashtag(layout, application, e);\n            }\n        });\n    }\n};\n\nexport = dataTouchPointPlugins;\n"]}