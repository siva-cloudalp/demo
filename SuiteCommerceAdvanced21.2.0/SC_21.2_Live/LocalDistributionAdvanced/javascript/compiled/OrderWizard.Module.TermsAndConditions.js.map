{"version":3,"sources":["OrderWizard.Module.TermsAndConditions.ts"],"names":[],"mappings":"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","file":"OrderWizard.Module.TermsAndConditions.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"OrderWizard.Module.TermsAndConditions\"/>\n/// <reference path=\"../../../Commons/Utilities/JavaScript/UnderscoreExtended.d.ts\" />\n\nimport * as _ from 'underscore';\nimport * as order_wizard_termsandconditions_module_tpl from 'order_wizard_termsandconditions_module.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { Configuration } from '../../SCA/JavaScript/Configuration';\nimport { WizardStepModule } from '../../Wizard/JavaScript/Wizard.StepModule';\n\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\n\n// @class OrderWizard.Module.TermsAndConditions @extends WizardModule\nexport = WizardStepModule.extend({\n    template: order_wizard_termsandconditions_module_tpl,\n\n    events: {\n        'click [data-toggle=\"show-terms\"]': 'showTerms',\n        'click input[name=\"termsandconditions\"]': 'acceptTerms'\n    },\n\n    errors: ['ERR_CHK_ACCEPT_TERMS'],\n\n    initialize: function(options) {\n        this.wizard = options.wizard;\n        this.step = options.step;\n        this.model = options.wizard.model;\n        this.options = _.extend(\n            {\n                show_checkbox: true\n            },\n            this.options || {}\n        );\n    },\n\n    render: function() {\n        // the module is rendered only if the site requires agreement to the terms and conditions\n        if (Configuration.get('siteSettings.checkout.requiretermsandconditions') === 'T') {\n            this._render();\n            const is_ready: boolean =\n                Configuration.get('siteSettings.checkout.requiretermsandconditions') !== 'T' ||\n                !this.options.show_checkbox ||\n                this.$('input[name=termsandconditions]').is(':checked');\n            this.trigger('ready', is_ready);\n        } else {\n            this.trigger('ready', true);\n        }\n    },\n\n    submit: function() {\n        const value =\n            Configuration.get('siteSettings.checkout.requiretermsandconditions') !== 'T' ||\n            !this.options.show_checkbox ||\n            this.$('input[name=termsandconditions]').is(':checked');\n        this.model.set('agreetermcondition', value);\n\n        return this.isValid();\n    },\n\n    showTerms: function() {\n        const TermsView = BackboneView.extend({\n            title: Utils.translate('Terms and Conditions'),\n            render: function() {\n                this.$el.html(Configuration.get('siteSettings.checkout.termsandconditionshtml'));\n                return this;\n            }\n        });\n\n        this.wizard.application.getLayout().showInModal(new TermsView());\n    },\n\n    acceptTerms: function(data) {\n        const isSelected = jQuery(data.target).prop('checked');\n        const boxes = jQuery('input[name=termsandconditions]');\n\n        jQuery.each(boxes, function(index) {\n            jQuery(boxes[index]).prop('checked', isSelected);\n        });\n    },\n\n    isValid: function() {\n        const promise = jQuery.Deferred();\n        const value =\n            Configuration.get('siteSettings.checkout.requiretermsandconditions') !== 'T' ||\n            !this.options.show_checkbox ||\n            this.model.get('agreetermcondition');\n\n        if (!value) {\n            return promise.reject({\n                errorCode: 'ERR_CHK_ACCEPT_TERMS',\n                errorMessage: Utils.translate('You must accept the Terms and Conditions')\n            });\n        }\n        return promise.resolve();\n    },\n\n    // @method getContext @return OrderWizard.Module.TermsAndConditions.Context\n    getContext: function() {\n        // @class OrderWizard.Module.TermsAndConditions.Context\n        return {\n            // @property {Boolean} showCheckbox\n            showCheckbox: this.options.show_checkbox,\n            // @property {Boolean} isAgreeTermCondition\n            isAgreeTermCondition: this.wizard.model.get('agreetermcondition'),\n            // @property {Boolean} showWrapper\n            showWrapper: !!this.options.showWrapper,\n            // @property {String} wrapperClass\n            wrapperClass: this.options.wrapperClass\n        };\n    }\n});\n"]}