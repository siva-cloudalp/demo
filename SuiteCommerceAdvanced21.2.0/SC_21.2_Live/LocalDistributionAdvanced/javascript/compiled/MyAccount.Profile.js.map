{"version":3,"sources":["MyAccount.Profile.ts"],"names":[],"mappings":"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","file":"MyAccount.Profile.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"MyAccount.Profile\"/>\nimport * as Utils from '../../Utilities/JavaScript/Utils';\n\nimport * as jQuery from '../../Core/JavaScript/jQuery';\nimport { ProfileModel } from './Profile.Model';\n\nimport ProfileInformationView = require('./Profile.Information.View');\nimport ProfileEmailPreferencesView = require('./Profile.EmailPreferences.View');\nimport ProfileUpdatePasswordView = require('./Profile.UpdatePassword.View');\n\n// Profile.js\n// -----------------\n// Defines the Profile module (Collection, Views, Router)\n// As the profile is instanciated in the application (without definining a model)\n// the validation is configured here in the mountToApp\n\nconst MyAccountProfile: any = {\n    mountToApp: function(application) {\n        const profile_model_instance = ProfileModel.getInstance();\n\n        if (SC.ENVIRONMENT.PROFILE) {\n            profile_model_instance.set(SC.ENVIRONMENT.PROFILE);\n\n            if (\n                profile_model_instance.get('isperson') &&\n                application.getConfig().siteSettings.registration.companyfieldmandatory !== 'T'\n            ) {\n                delete profile_model_instance.validation.companyname;\n            }\n\n            if (!profile_model_instance.get('isperson')) {\n                delete profile_model_instance.validation.firstname;\n            }\n\n            if (\n                !profile_model_instance.get('lastname') ||\n                !profile_model_instance.get('isperson')\n            ) {\n                delete profile_model_instance.validation.lastname;\n            }\n\n            if (!profile_model_instance.get('phone') && profile_model_instance.validation.phone) {\n                profile_model_instance.validation.phone.required = false;\n            }\n\n            if (SC.ENVIRONMENT.LIVEPAYMENT) {\n                if (SC.ENVIRONMENT.LIVEPAYMENT.balance) {\n                    profile_model_instance.set('balance', SC.ENVIRONMENT.LIVEPAYMENT.balance);\n                }\n                if (SC.ENVIRONMENT.LIVEPAYMENT.balance_formatted) {\n                    profile_model_instance.set(\n                        'balance_formatted',\n                        SC.ENVIRONMENT.LIVEPAYMENT.balance_formatted\n                    );\n                }\n            }\n        }\n        if (SC.ENVIRONMENT.ADDRESS) {\n            profile_model_instance.get('addresses').reset(SC.ENVIRONMENT.ADDRESS);\n            delete SC.ENVIRONMENT.ADDRESS;\n        } else {\n            profile_model_instance.get('addresses').reset([]);\n        }\n\n        if (SC.ENVIRONMENT.PAYMENTMETHOD) {\n            profile_model_instance.get('paymentmethods').reset(SC.ENVIRONMENT.PAYMENTMETHOD);\n            delete SC.ENVIRONMENT.PAYMENTMETHOD;\n        } else {\n            profile_model_instance.get('paymentmethods').reset([]);\n        }\n\n        const Layout = application.getLayout();\n\n        profile_model_instance.on(\n            'change:firstname change:lastname change:companyname',\n            function() {\n                Layout.updateHeader();\n            }\n        );\n\n        const pageType = application.getComponent('PageType');\n\n        pageType.registerPageType({\n            name: 'ProfileInfo',\n            routes: ['profileinformation'],\n            view: ProfileInformationView,\n            defaultTemplate: {\n                name: 'profile_information.tpl',\n                displayName: 'Profile Default',\n                thumbnail: Utils.getThemeAbsoluteUrlOfNonManagedResources(\n                    'img/default-layout-profile.png'\n                )\n            }\n        });\n        pageType.registerPageType({\n            name: 'EmailPreferences',\n            routes: ['emailpreferences'],\n            view: ProfileEmailPreferencesView,\n            defaultTemplate: {\n                name: 'profile_emailpreferences.tpl',\n                displayName: 'Profile email preferences default',\n                thumbnail: Utils.getThemeAbsoluteUrlOfNonManagedResources(\n                    'img/default-layout-email-preferences.png'\n                )\n            }\n        });\n        pageType.registerPageType({\n            name: 'PasswordUpdate',\n            routes: ['updateyourpassword'],\n            view: ProfileUpdatePasswordView,\n            defaultTemplate: {\n                name: 'profile_update_password.tpl',\n                displayName: 'Profile update password default',\n                thumbnail: Utils.getThemeAbsoluteUrlOfNonManagedResources(\n                    'img/default-layout-update-password.png'\n                )\n            }\n        });\n    }\n};\n\nexport = MyAccountProfile;\n"]}