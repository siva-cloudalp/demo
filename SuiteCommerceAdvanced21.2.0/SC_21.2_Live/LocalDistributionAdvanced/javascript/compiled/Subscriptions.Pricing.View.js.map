{"version":3,"sources":["Subscriptions.Pricing.View.ts"],"names":[],"mappings":"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","file":"Subscriptions.Pricing.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Subscriptions.Pricing.View\"/>\n\nimport * as _ from 'underscore';\n\nimport * as subscriptions_pricing_tpl from 'subscriptions_pricing.tpl';\n\nimport QuantityPricingView = require('../../QuantityPricing/JavaScript/QuantityPricing.View');\nimport Utils = require('../../../Commons/Utilities/JavaScript/Utils');\nexport type SubscriptionsPricingView = any;\n// @class Subscriptions.Pricing.View @extends Backbone.View\nexport const SubscriptionsPricingView: any = QuantityPricingView.extend({\n    template: subscriptions_pricing_tpl,\n\n    initialize() {\n        const prices =\n            this.model.get('item').get('_priceDetails') &&\n            this.model.get('item').get('_priceDetails').priceschedule;\n        if (prices && prices.length > 1) {\n            this.options.notUseAccordion = true;\n        }\n\n        QuantityPricingView.prototype.initialize.apply(this, arguments);\n    },\n\n    getContext() {\n        const priceObject: any = this.model.getDefaultOfferStr();\n        const columnTitle = priceObject.type === 'usage' ? 'Unit' : 'Quantity';\n        const priceOption: string = priceObject.priceOption === 'FIXED' ? 'all' : 'each';\n\n        let type: string;\n        switch (priceObject.type) {\n            case 'usage':\n                type = 'unit';\n                break;\n            case 'recurring':\n                type = priceObject.priceOption === 'FIXED' ? ' per unit' : 'each';\n                break;\n            default:\n                break;\n        }\n\n        switch (priceObject.planType) {\n            case 'tiered':\n                _.each(this.price_schedule, (priceSchedule: any, index) => {\n                    priceSchedule.tdPreppend =\n                        priceObject.priceOption === 'FIXED' ? 'from  ' : 'first ';\n                    priceSchedule.tdAppend = ` ${priceOption}`;\n                    if (index === 0) {\n                        priceSchedule.tdPreppend =\n                            priceObject.priceOption === 'FIXED' ? 'up to ' : 'first ';\n                    }\n                    if (priceObject.priceOption === 'FIXED') {\n                        if (index === 0) {\n                            priceSchedule.auxPrice = priceSchedule.price;\n                        } else {\n                            priceSchedule.auxPrice =\n                                this.price_schedule[index - 1].auxPrice + priceSchedule.price;\n                            priceSchedule.price_formatted =\n                                SC.SESSION.currency.symbol + priceSchedule.auxPrice.toFixed(2);\n                        }\n                    }\n                    if (index === _.size(this.price_schedule) - 1) {\n                        priceSchedule.tdPreppend =\n                            priceObject.priceOption === 'FIXED' ? 'over ' : 'the next ';\n                    }\n                });\n                break;\n            case 'volume':\n                _.each(this.price_schedule, (price: any, index) => {\n                    price.tdPreppend = 'from ';\n                    price.tdAppend = ` ${priceOption}`;\n                    if (index === 0) {\n                        price.tdPreppend = 'up to ';\n                    }\n                    if (index === _.size(this.price_schedule) - 1) {\n                        price.tdPreppend = 'over ';\n                    }\n                });\n                break;\n            default:\n                break;\n        }\n\n        return {\n            isFullMode: this.options.fullMode,\n            option: priceObject.option,\n            type: this.model.getDefaultOfferStr().isOneTime ? 'each' : type,\n            priceSchedule: this.price_schedule,\n            frequency: `/${priceObject.frequency}`,\n            defaultPrice: Utils.formatCurrency(priceObject.minamount) || priceObject.defaultPrice,\n            showMinimumMaximum: !!(priceObject.minamount || priceObject.maxamount),\n            showMinimum: !!priceObject.minamount,\n            minimumValue: Utils.formatCurrency(priceObject.minamount),\n            showMaximum: !!priceObject.maxamount,\n            maximumValue: Utils.formatCurrency(priceObject.maxamount),\n            showQuantity: !(priceObject.type === 'usage'),\n            pricingColumnTitle: columnTitle,\n            showPricingDetails: this.priceSchedule > 1\n        };\n    }\n});\n"]}