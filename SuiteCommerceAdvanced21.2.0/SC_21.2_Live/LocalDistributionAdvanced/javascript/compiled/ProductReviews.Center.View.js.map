{"version":3,"sources":["ProductReviews.Center.View.ts"],"names":[],"mappings":"AAAA;;;;;EAKE;;;IAgCF,OAAS,YAAY,CAAC,MAAM,CAAC;QACzB,QAAQ,EAAE,sBAAsB;QAEhC,UAAU,EAAE;YACR,EAAE,EAAE,sBAAsB;YAC1B,KAAK,EAAE,4CAA4C;SACtD;QAED,UAAU,EAAE,UAAS,OAAO;YACxB,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;YACzB,IAAI,CAAC,OAAO,GAAG,aAAW,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,YAAY,CAAG,CAAC;YAE3D,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,eAAe,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;YAChE,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC;YAEvC,IAAI,CAAC,UAAU,GAAG,IAAI,wBAAwB,EAAE,CAAC;YACjD,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;YAErD,IAAM,IAAI,GAAG,IAAI,CAAC;YAClB,IAAM,cAAc,GAAG,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAE1E,cAAc,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;YAEpD,6BAA6B;YAC7B,IAAI,CAAC,cAAc,GAAG,MAAM,CAAC,QAAQ,EAAE,CAAC;YACxC,IAAI,CAAC,UAAU;iBACV,KAAK,CAAC;gBACH,IAAI,EAAE,cAAc;gBACpB,QAAQ,EAAE,IAAI,CAAC,QAAQ;aAC1B,CAAC;iBACD,IAAI,CAAC;gBACF,IAAI,CAAC,qBAAqB,EAAE,CAAC;gBAE7B,6BAA6B;gBAC7B,yCAAyC;gBACzC,IAAI,CAAC,MAAM,EAAE,CAAC;gBAEd,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,OAAO,EAAE;oBACxB,IAAI,CAAC,MAAM,EAAE,CAAC;gBAClB,CAAC,CAAC,CAAC;gBACH,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,CAAC;YAClC,CAAC,CAAC,CAAC;QACX,CAAC;QAED,MAAM,EAAE,SAAS,MAAM;YACnB,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,IAAI,CAAC,CAAC,CAAC,0BAA0B,CAAC,CAAC,MAAM,EAAE,CAAC;QAChD,CAAC;QAED,qBAAqB;QACrB,oBAAoB;QACpB,UAAU,EAAE,SAAS,UAAU;YAC3B,IAAM,YAAY,GAAG,CAAC,IAAI,CAAC,YAAY,IAAI,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;YAErF,IAAI,YAAY,GAAG,CAAC,EAAE;gBAClB,IAAI,YAAY,KAAK,CAAC,EAAE;oBACpB,OAAO,IAAI,CAAC,OAAO,CAAC;iBACvB;gBAED,IAAI,YAAY,GAAG,CAAC,EAAE;oBAClB,OAAU,IAAI,CAAC,OAAO,eAAS,YAAY,GAAG,CAAC,CAAE,CAAC;iBACrD;aACJ;YACD,OAAO,IAAI,CAAC;QAChB,CAAC;QAED,qBAAqB;QACrB,mBAAmB;QACnB,UAAU,EAAE,SAAS,UAAU;YAC3B,IAAM,YAAY,GAAG,CAAC,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAExE,IAAI,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE;gBAC3C,IAAI,CAAC,OAAO,IAAI,YAAS,YAAY,GAAG,CAAC,CAAE,CAAC;gBAC5C,OAAO,IAAI,CAAC,OAAO,CAAC;aACvB;YACD,OAAO,IAAI,CAAC;QAChB,CAAC;QAED,qFAAqF;QACrF,4CAA4C;QAC5C,eAAe,EAAE,SAAS,eAAe,CAAC,MAAgB;YAAhB,uBAAA,EAAA,WAAgB;YACtD,IAAM,OAAO,GAAQ,EAAE,CAAC;YACxB,IAAM,IAAI,GAAG,MAAM,CAAC,IAAI,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;YACnD,IAAM,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;YAEzD,IAAI,MAAM,EAAE;gBACR,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;aAC3B;YAED,IAAI,IAAI,EAAE;gBACN,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC;aACvB;YAED,OAAU,IAAI,CAAC,OAAO,SAAI,MAAM,CAAC,KAAK,CAAC,OAAO,CAAG,CAAC;QACtD,CAAC;QAED,kEAAkE;QAClE,eAAe,EAAE,SAAS,eAAe,CAAC,UAAU;YAChD,IAAM,KAAK,GAAG,CAAC,CAAC,6BAAa,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC,CAAC,GAAG,CAAC,UACjE,IAAS;gBAET,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC;gBACrB,OAAO,IAAI,CAAC;YAChB,CAAC,CAAC,CAAC;YACH,IAAM,OAAO,GAAG,CAAC,CAAC,6BAAa,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC,CAAC,GAAG,CAAC,UACrE,MAAW;gBAEX,MAAM,CAAC,KAAK,GAAG,MAAM,CAAC,EAAE,CAAC;gBACzB,OAAO,MAAM,CAAC;YAClB,CAAC,CAAC,CAAC;YAEH,OAAO;gBACH,IAAI,EAAE,IAAI;gBACV,WAAW,EAAE,IAAI,CAAC,WAAW;gBAC7B,UAAU,EAAE,UAAU;gBACtB,KAAK,EAAE,KAAK;gBACZ,OAAO,EAAE,OAAO;gBAChB,eAAe,EAAE,IAAI;gBACrB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC;gBAC1C,mBAAmB,EAAE,IAAI,CAAC,oBAAoB;aACjD,CAAC;QACN,CAAC;QAED,gCAAgC;QAChC,qBAAqB,EAAE,SAAS,qBAAqB;YACjD,IAAM,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;YAC7B,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;YACxC,IAAM,SAAS,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;YAEpC,KAAK,CAAC,IAAI,CAAC,oCAAoC,CAAC,CAAC,MAAM,EAAE,CAAC;YAE1D,IAAI,aAAa,EAAE;gBACf,MAAM,CAAC,SAAS,EAAE;oBACd,GAAG,EAAE,MAAM;oBACX,IAAI,EAAE,aAAa;iBACtB,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;aACtB;YAED,IAAI,SAAS,EAAE;gBACX,MAAM,CAAC,SAAS,EAAE;oBACd,GAAG,EAAE,MAAM;oBACX,IAAI,EAAE,SAAS;iBAClB,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;aACtB;QACL,CAAC;QAED,oBAAoB,EAAE,SAAS,oBAAoB,CAAC,OAAO,EAAE,SAAS;YAClE,IAAI,OAAO,CAAC,EAAE,KAAK,KAAK,EAAE;gBACtB,SAAS,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;gBAC9D,SAAS,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;aACpC;iBAAM;gBACH,SAAS,CAAC,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;aACrC;QACL,CAAC;QACD,UAAU,EAAE;YACR,uBAAuB,EAAE;gBACrB,OAAO,IAAI,sBAAsB,CAAC;oBAC9B,UAAU,EAAE,IAAI,CAAC,UAAU;oBAC3B,SAAS,EAAE,wBAAwB;oBACnC,gBAAgB,EAAE,CAAC,CAAC,MAAM,CACtB;wBACI,iBAAiB,EAAE,IAAI;wBACvB,UAAU,EAAE,IAAI,CAAC,UAAU;qBAC9B,EACD,6BAAa,CAAC,GAAG,CAAC,gBAAgB,CAAC,CACtC;oBACD,WAAW,EAAE,CAAC;iBACjB,CAAC,CAAC;YACP,CAAC;YAED,mBAAmB,EAAE;gBACjB,OAAO,IAAI,yBAAyB,CAAC;oBACjC,KAAK,EAAE,IAAI,CAAC,IAAI;oBAChB,eAAe,EAAE,KAAK;oBACtB,SAAS,EAAE,IAAI;iBAClB,CAAC,CAAC;YACP,CAAC;YAED,qBAAqB,EAAE;gBACnB,OAAO,IAAI,2BAA2B,CAAC;oBACnC,KAAK,EAAE,IAAI,CAAC,IAAI;oBAChB,YAAY,EAAE,IAAI,CAAC,YAAY;oBAC/B,OAAO,EAAE,IAAI,CAAC,OAAO;oBACrB,cAAc,EAAE,IAAI;oBACpB,SAAS,EAAE,IAAI;iBAClB,CAAC,CAAC;YACP,CAAC;YAED,wBAAwB,EAAE;gBACtB,OAAO,IAAI,uDAAyB,CAChC,CAAC,CAAC,MAAM,CACJ;oBACI,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,IAAI,IAAI,CAAC;oBACtC,UAAU,EAAE,IAAI,CAAC,UAAU,CAAC,UAAU,IAAI,CAAC;oBAC3C,KAAK,EAAE,UAAC,IAAI;wBACR,OAAO,OACH,IAAI,GAAG,CAAC;4BACJ,CAAC,CAAC,qBAAS,CAAC,eAAe,CACrB,QAAQ,CAAC,OAAO,CAAC,QAAQ,EACzB,MAAM,EACN,IAAI,CACP;4BACH,CAAC,CAAC,qBAAS,CAAC,kBAAkB,CACxB,QAAQ,CAAC,OAAO,CAAC,QAAQ,EACzB,MAAM,CACT,CACT,CAAC;oBACP,CAAC;oBACD,UAAU,EAAE,2CAA2C;iBAC1D,EACD,6BAAa,CAAC,GAAG,CAAC,2BAA2B,CAAC,CACjD,CACJ,CAAC;YACN,CAAC;YAED,iBAAiB,EAAE;gBACf,OAAO,IAAI,gCAAc,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;YACrE,CAAC;SACJ;QAED,iDAAiD;QACjD,yCAAyC;QACzC,SAAS,EAAE,SAAS,SAAS;YAAlB,iBA2CV;YA1CG,IAAI,6BAAa,CAAC,GAAG,CAAC,2BAA2B,CAAC,KAAK,SAAS,EAAE;gBAC9D,OAAO,MAAM,CAAC,QAAQ,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;aAC1C;YACD,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAC3B;gBACI,IAAM,YAAY,GAAmB,EAAE,CAAC;gBACxC,IAAM,WAAW,GAAG,KAAI,CAAC,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,KAAI,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;gBAC7E,IAAM,WAAW,GAAG,KAAI,CAAC,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;gBACxD,cAAc;gBACd,IAAI,KAAI,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC5B,KAAI,CAAC,UAAU,CAAC,IAAI,CAChB,UAAC,UAAe;wBACZ,IAAM,MAAM,GAAe,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;wBACtD,IAAM,SAAS,GAAiB;4BAC5B,OAAO,EAAE,QAAQ;4BACjB,MAAM,EAAG,MAAM,CAAC,MAAqB,CAAC,IAAI,CAAC,QAAQ,EAAE;4BACrD,aAAa,EAAE,MAAM,CAAC,UAAU,CAAC,QAAQ,EAAE;4BAC3C,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE;4BACnC,IAAI,EAAE,MAAM,CAAC,KAAK,CAAC,QAAQ,EAAE;4BAC7B,YAAY,EAAE;gCACV,OAAO,EAAE,QAAQ;gCACjB,WAAW,EAAE,MAAM,CAAC,MAAM,CAAC,QAAQ,EAAE;6BACxC;yBACJ,CAAC;wBACF,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;oBACjC,CAAC,CACJ,CAAC;oBACF,IAAM,eAAe,GAA0B;wBAC3C,OAAO,EAAE,iBAAiB;wBAC1B,WAAW,EAAE,WAAW,CAAC,QAAQ,EAAE;wBACnC,WAAW,EAAE,WAAW,CAAC,QAAQ,EAAE;qBACtC,CAAC;oBACF,IAAM,MAAM,GAAgB;wBACxB,OAAO,EAAE,OAAO;wBAChB,eAAe,EAAE,eAAe;wBAChC,MAAM,EAAE,YAAY;qBACvB,CAAC;oBACF,OAAO,MAAM,CAAC,QAAQ,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;iBAC5C;gBACD,OAAO,MAAM,CAAC,QAAQ,EAAE,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YACzC,CAAC,CACJ,CAAC;QACN,CAAC;QAED,qBAAqB;QACrB,gDAAgD;QAChD,UAAU,EAAE,SAAS,UAAU;YAC3B,4CAA4C;YAC5C,OAAO;gBACH,+BAA+B;gBAC/B,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC;gBACzC,mCAAmC;gBACnC,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,KAAK,CAAC;gBAClD,6BAA6B;gBAC7B,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC;gBAC9B,gCAAgC;gBAChC,UAAU,EAAE,IAAI,CAAC,WAAW;gBAC5B,kCAAkC;gBAClC,YAAY,EAAE,IAAI,CAAC,UAAU,CAAC,iBAAiB;aAClD,CAAC;YACF,oCAAoC;QACxC,CAAC;KACJ,CAAC,CAAC","file":"ProductReviews.Center.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"ProductReviews.Center.View\"/>\n\nimport * as _ from 'underscore';\nimport '../../jQueryExtras/JavaScript/jQuery.scPush';\nimport * as product_reviews_center from 'product_reviews_center.tpl';\nimport {\n    Review as JsonldReview,\n    Offer as JsonldOffer,\n    AggregateRating as JsonldAggregateRating\n} from 'schema-dts';\nimport * as Utils from '../../Utilities/JavaScript/Utils';\nimport * as jQuery from '../../Core/JavaScript/jQuery';\nimport { JSONObject } from '../../Utilities/JavaScript/Utils.Interfaces';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\nimport { ListHeaderView } from '../../ListHeader/JavaScript/ListHeader.View';\nimport { GlobalViewsPaginationView } from '../../GlobalViews/JavaScript/GlobalViews.Pagination.View';\nimport { UrlHelper } from '../../UrlHelper/JavaScript/UrlHelper';\n\nimport ProductReviewsCollection = require('./ProductReviews.Collection');\nimport ProductReviewsReviewView = require('./ProductReviews.Review.View');\nimport GlobalViewsStarRatingView = require('../../GlobalViews/JavaScript/GlobalViews.StarRating.View');\nimport GlobalViewsRatingByStarView = require('../../GlobalViews/JavaScript/GlobalViews.RatingByStar.View');\nimport Backbone = require('../../Utilities/JavaScript/backbone.custom');\nimport BackboneView = require('../../BackboneExtras/JavaScript/Backbone.View');\nimport BackboneCollectionView = require('../../Backbone.CollectionView/JavaScript/Backbone.CollectionView');\n\n// @class ProductReviews.Center.View\n// This view is shown when listing the reviews of an item contains event handlers for voting\n// helpfulness and flaging a review\n// @extends Backbone.View\nexport = BackboneView.extend({\n    template: product_reviews_center,\n\n    attributes: {\n        id: 'item-product-reviews',\n        class: 'item-product-reviews item-detailed-reviews'\n    },\n\n    initialize: function(options): void {\n        this.item = options.item;\n        this.baseUrl = `product/${options.item.get('internalid')}`;\n\n        this.queryOptions = Utils.parseUrlOptions(window.location.href);\n        this.application = options.application;\n\n        this.collection = new ProductReviewsCollection();\n        this.collection.itemid = this.item.get('internalid');\n\n        const self = this;\n        const reviews_params = this.collection.getReviewParams(this.queryOptions);\n\n        reviews_params.itemid = this.item.get('internalid');\n\n        // return the fetch 'promise'\n        this.reviewsPromise = jQuery.Deferred();\n        this.collection\n            .fetch({\n                data: reviews_params,\n                killerId: this.killerId\n            })\n            .done(function(): void {\n                self.updateCannonicalLinks();\n\n                // append and render the view\n                // $placeholder.empty().append(this.$el);\n                self.render();\n\n                self.collection.on('reset', function(): void {\n                    self.render();\n                });\n                self.reviewsPromise.resolve();\n            });\n    },\n\n    render: function render(): void {\n        this._render();\n        this.$('[data-action=\"pushable\"]').scPush();\n    },\n\n    // @method getRelPrev\n    // @return {String?}\n    getRelPrev: function getRelPrev(): string | null {\n        const current_page = (this.queryOptions && parseInt(this.queryOptions.page, 2)) || 1;\n\n        if (current_page > 1) {\n            if (current_page === 2) {\n                return this.baseUrl;\n            }\n\n            if (current_page > 2) {\n                return `${this.baseUrl}?page=${current_page - 1}`;\n            }\n        }\n        return null;\n    },\n\n    // @method getRelNext\n    // @return {String}\n    getRelNext: function getRelNext(): string | null {\n        const current_page = (this.queryOptions && this.queryOptions.page) || 1;\n\n        if (current_page < this.collection.totalPages) {\n            this.baseUrl += `?page=${current_page + 1}`;\n            return this.baseUrl;\n        }\n        return null;\n    },\n\n    // @method getUrlForOption creates a new url based on a new filter or sorting options\n    // @param {filter:String,sort:String} option\n    getUrlForOption: function getUrlForOption(option: any = {}): string {\n        const options: any = {};\n        const sort = option.sort || this.queryOptions.sort;\n        const filter = option.filter || this.queryOptions.filter;\n\n        if (filter) {\n            options.filter = filter;\n        }\n\n        if (sort) {\n            options.sort = sort;\n        }\n\n        return `${this.baseUrl}?${jQuery.param(options)}`;\n    },\n\n    // @method setupListHeader @param {Backbone.Collection} collection\n    setupListHeader: function setupListHeader(collection): any {\n        const sorts = _(Configuration.get('productReviews.sortOptions')).map(function(\n            sort: any\n        ): any {\n            sort.value = sort.id;\n            return sort;\n        });\n        const filters = _(Configuration.get('productReviews.filterOptions')).map(function(\n            filter: any\n        ): any {\n            filter.value = filter.id;\n            return filter;\n        });\n\n        return {\n            view: this,\n            application: this.application,\n            collection: collection,\n            sorts: sorts,\n            filters: filters,\n            avoidFirstFetch: true,\n            totalCount: this.item.get('_ratingsCount'),\n            customFilterHandler: this.filterOptionsHandler\n        };\n    },\n\n    // @method updateCannonicalLinks\n    updateCannonicalLinks: function updateCannonicalLinks(): void {\n        const $head = jQuery('head');\n        const previous_page = this.getRelPrev();\n        const next_page = this.getRelNext();\n\n        $head.find('link[rel=\"next\"], link[rel=\"prev\"]').remove();\n\n        if (previous_page) {\n            jQuery('<link/>', {\n                rel: 'prev',\n                href: previous_page\n            }).appendTo($head);\n        }\n\n        if (next_page) {\n            jQuery('<link/>', {\n                rel: 'next',\n                href: next_page\n            }).appendTo($head);\n        }\n    },\n\n    filterOptionsHandler: function filterOptionsHandler(element, elem_sort): any {\n        if (element.id !== 'all') {\n            elem_sort.find('option[value=\"date\"]').prop('selected', true);\n            elem_sort.prop('disabled', true);\n        } else {\n            elem_sort.prop('disabled', false);\n        }\n    },\n    childViews: {\n        'ProductReviews.Review': function(): any {\n            return new BackboneCollectionView({\n                collection: this.collection,\n                childView: ProductReviewsReviewView,\n                childViewOptions: _.extend(\n                    {\n                        showActionButtons: true,\n                        collection: this.collection\n                    },\n                    Configuration.get('productReviews')\n                ),\n                viewsPerRow: 1\n            });\n        },\n\n        'Global.StarRating': function(): any {\n            return new GlobalViewsStarRatingView({\n                model: this.item,\n                showRatingCount: false,\n                showValue: true\n            });\n        },\n\n        'Global.RatingByStar': function(): any {\n            return new GlobalViewsRatingByStarView({\n                model: this.item,\n                queryOptions: this.queryOptions,\n                baseUrl: this.baseUrl,\n                showPercentage: true,\n                showCount: true\n            });\n        },\n\n        'GlobalViews.Pagination': function(): any {\n            return new GlobalViewsPaginationView(\n                _.extend(\n                    {\n                        currentPage: this.collection.page || 0,\n                        totalPages: this.collection.totalPages || 0,\n                        pager: (page): any => {\n                            return `/${\n                                page > 1\n                                    ? UrlHelper.setUrlParameter(\n                                          Backbone.history.fragment,\n                                          'page',\n                                          page\n                                      )\n                                    : UrlHelper.removeUrlParameter(\n                                          Backbone.history.fragment,\n                                          'page'\n                                      )\n                            }`;\n                        },\n                        extraClass: 'pull-right no-margin-top no-margin-bottom'\n                    },\n                    Configuration.get('defaultPaginationSettings')\n                )\n            );\n        },\n\n        'ListHeader.View': function(): any {\n            return new ListHeaderView(this.setupListHeader(this.collection));\n        }\n    },\n\n    // @method Create JsonLd object with reviews info\n    // @return {JQuery.Deferred<JsonldOffer>}\n    getJsonLd: function getJsonLd(): JQuery.Deferred<JsonldOffer> {\n        if (Configuration.get('structureddatamarkup.type') !== 'JSON-LD') {\n            return jQuery.Deferred().resolve(null);\n        }\n        return this.reviewsPromise.then(\n            (): JQuery.Deferred<JsonldOffer> => {\n                const reviewsToAdd: JsonldReview[] = [];\n                const ratingValue = this.item.get('_rating') || this.item.get('rating') || 0;\n                const ratingCount = this.item.get('_ratingsCount') || 0;\n                // Get Reviews\n                if (this.collection.length > 0) {\n                    this.collection.each(\n                        (reviewItem: any): void => {\n                            const review: JSONObject = Utils.deepCopy(reviewItem);\n                            const newReview: JsonldReview = {\n                                '@type': 'Review',\n                                author: (review.writer as JSONObject).name.toString(),\n                                datePublished: review.created_on.toString(),\n                                description: review.text.toString(),\n                                name: review.title.toString(),\n                                reviewRating: {\n                                    '@type': 'Rating',\n                                    ratingValue: review.rating.toString()\n                                }\n                            };\n                            reviewsToAdd.push(newReview);\n                        }\n                    );\n                    const aggregateRating: JsonldAggregateRating = {\n                        '@type': 'AggregateRating',\n                        ratingValue: ratingValue.toString(),\n                        reviewCount: ratingCount.toString()\n                    };\n                    const jsonLd: JsonldOffer = {\n                        '@type': 'Offer',\n                        aggregateRating: aggregateRating,\n                        review: reviewsToAdd\n                    };\n                    return jQuery.Deferred().resolve(jsonLd);\n                }\n                return jQuery.Deferred().resolve({});\n            }\n        );\n    },\n\n    // @method getContext\n    // @returns {ProductReviews.Center.View.Context}\n    getContext: function getContext(): any {\n        // @class ProductReviews.Center.View.Context\n        return {\n            // @property {Number} itemCount\n            itemCount: this.item.get('_ratingsCount'),\n            // @property {Boolean} hasOneReview\n            hasOneReview: this.item.get('_ratingsCount') === 1,\n            // @property {String} itemUrl\n            itemUrl: this.item.get('_url'),\n            // @property {String} pageHeader\n            pageHeader: this.page_header,\n            // @property {Number} totalRecords\n            totalRecords: this.collection.totalRecordsFound\n        };\n        // @class ProductReviews.Center.View\n    }\n});\n"]}