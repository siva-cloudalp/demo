{"version":3,"sources":["RecentlyViewedItems.View.ts"],"names":[],"mappings":"AAAA;;;;;EAKE;;;IAgBF,IAAM,uBAAuB,GAAQ,sBAAsB,CAAC,MAAM,CAAC;QAC/D,UAAU,EAAE;YACA,IAAA,WAAW,GAAK,IAAI,CAAC,OAAO,YAAjB,CAAkB;YACrC,IAAM,MAAM,GAAG,WAAW,CAAC,SAAS,EAAE,CAAC;YAC/B,IAAA,YAAY,GAAK,WAAW,CAAC,SAAS,EAAE,aAA5B,CAA6B;YACjD,IAAM,UAAU,GACZ,YAAY,CAAC,QAAQ,KAAK,UAAU;gBAChC,CAAC,CAAC,6BAA6B,CAAC,WAAW,EAAE;gBAC7C,CAAC,CAAC,IAAI,QAAQ,CAAC,UAAU,EAAE,CAAC;YACpC,IAAM,IAAI,GAAG,IAAI,CAAC;YAElB,sBAAsB,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE;gBACnD,UAAU,EAAE,UAAU;gBACtB,WAAW,EAAE,QAAQ;gBACrB,YAAY,EAAE,wBAAwB;gBACtC,WAAW,EAAE,uBAAuB;gBACpC,SAAS,EAAE,4BAA4B;gBACvC,QAAQ,EAAE,yBAAyB;aACtC,CAAC,CAAC;YAEH,MAAM,CAAC,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,sBAAsB,EAAE,IAAI,CAAC,CAAC;QACtE,CAAC;QACD,sBAAsB,EAAE,SAAS,sBAAsB;YACnD,IAAM,IAAI,GAAG,IAAI,CAAC;YAElB,6BAA6B,CAAC,WAAW,EAAE,CAAC,cAAc,EAAE,CAAC;YAE7D,IAAI,CAAC,UAAU,CAAC,OAAO;gBACnB,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC;oBACjB,IAAA,WAAW,GAAK,IAAI,CAAC,OAAO,YAAjB,CAAkB;oBACrC,IAAM,yBAAyB,GAC3B,WAAW,CAAC,SAAS,EAAE,CAAC,YAAY,CAAC,QAAQ,KAAK,UAAU;wBACxD,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,GAAG,CACzB,4CAA4C,CAC/C;wBACH,CAAC,CAAC,WAAW,CAAC,SAAS,CAAC,4CAA4C,CAAC,CAAC;oBAE9E,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,QAAQ,CAAC,yBAAyB,CAAC,CAAC,CAAC;oBAC7E,IAAI,CAAC,MAAM,EAAE,CAAC;oBAEd,IAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,8BAA8B,CAAC,CAAC;oBAEzD,IAAA,KAAqC,WAAW,CAAC,SAAS,EAAE,EAA1D,YAAY,kBAAA,EAAE,gBAAgB,sBAA4B,CAAC;oBACnE,IAAI,KAAK,CAAC,aAAa,EAAE,KAAK,KAAK,IAAI,YAAY,CAAC,UAAU,EAAE;wBAC5D,IAAM,SAAS,GAAQ,CAAC,CAAC,KAAK,CAAC,YAAY,CAAC,UAAU,EAAE;4BACpD,IAAI,EAAE,gBAAgB,CAAC,SAAS;yBACnC,CAAC,CAAC,CAAC,CAAC,CAAC;wBAEN,IAAM,cAAc,GAAG,SAAS,CAAC,SAAS,CAAC;wBAE3C,QAAQ;6BACH,IAAI,CAAC,wCAAwC,CAAC;6BAC9C,GAAG,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;qBACzC;oBAED,KAAK,CAAC,YAAY,CAAC,QAAQ,EAAE,6BAAa,CAAC,gBAAgB,CAAC,CAAC;gBACjE,CAAC,CAAC,CAAC;QACX,CAAC;KACJ,CAAC,CAAC;IAEH,OAAS,uBAAuB,CAAC","file":"RecentlyViewedItems.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"RecentlyViewedItems.View\"/>\n\nimport * as _ from 'underscore';\nimport * as recently_viewed_items_tpl from 'recently_viewed_items.tpl';\nimport * as recently_viewed_row_tpl from 'recently_viewed_row.tpl';\nimport * as recently_viewed_cell_tpl from 'recently_viewed_cell.tpl';\nimport * as Utils from '../../Utilities/JavaScript/Utils';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\n\nimport BackboneCollectionView = require('../../Backbone.CollectionView/JavaScript/Backbone.CollectionView');\nimport ItemRelationsRelatedItemView = require('../../ItemRelations/JavaScript/ItemRelations.RelatedItem.View');\nimport RecentlyViewedItemsCollection = require('./RecentlyViewedItems.Collection');\nimport Backbone = require('../../Utilities/JavaScript/backbone.custom');\n\nconst RecentlyViewedItemsView: any = BackboneCollectionView.extend({\n    initialize: function() {\n        const { application } = this.options;\n        const layout = application.getLayout();\n        const { siteSettings } = application.getConfig();\n        const collection =\n            siteSettings.sitetype === 'ADVANCED'\n                ? RecentlyViewedItemsCollection.getInstance()\n                : new Backbone.Collection();\n        const self = this;\n\n        BackboneCollectionView.prototype.initialize.call(this, {\n            collection: collection,\n            viewsPerRow: Infinity,\n            cellTemplate: recently_viewed_cell_tpl,\n            rowTemplate: recently_viewed_row_tpl,\n            childView: ItemRelationsRelatedItemView,\n            template: recently_viewed_items_tpl\n        });\n\n        layout.once('afterAppendView', self.loadRecentlyViewedItem, self);\n    },\n    loadRecentlyViewedItem: function loadRecentlyViewedItem() {\n        const self = this;\n\n        RecentlyViewedItemsCollection.getInstance().turnOnTracking();\n\n        this.collection.promise &&\n            this.collection.promise.done(function() {\n                const { application } = self.options;\n                const number_of_items_displayed =\n                    application.getConfig().siteSettings.sitetype === 'ADVANCED'\n                        ? application.Configuration.get(\n                              'recentlyViewedItems.numberOfItemsDisplayed'\n                          )\n                        : application.getConfig('recentlyViewedItems.numberOfItemsDisplayed');\n\n                self.collection = self.collection.first(parseInt(number_of_items_displayed));\n                self.render();\n\n                const carousel = self.$el.find('[data-type=\"carousel-items\"]');\n\n                const { siteSettings, imageSizeMapping } = application.getConfig();\n                if (Utils.isPhoneDevice() === false && siteSettings.imagesizes) {\n                    const thumbnail: any = _.where(siteSettings.imagesizes, {\n                        name: imageSizeMapping.thumbnail\n                    })[0];\n\n                    const img_min_height = thumbnail.maxheight;\n\n                    carousel\n                        .find('.item-relations-related-item-thumbnail')\n                        .css('minHeight', img_min_height);\n                }\n\n                Utils.initBxSlider(carousel, Configuration.bxSliderDefaults);\n            });\n    }\n});\n\nexport = RecentlyViewedItemsView;\n"]}