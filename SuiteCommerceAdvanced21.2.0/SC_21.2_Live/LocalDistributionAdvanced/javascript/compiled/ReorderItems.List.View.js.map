{"version":3,"sources":["ReorderItems.List.View.ts"],"names":[],"mappings":"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","file":"ReorderItems.List.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"ReorderItems.List.View\"/>\n\nimport * as _ from 'underscore';\nimport * as reorder_items_list_tpl from 'reorder_items_list.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { ReorderItemsActionsQuantityView } from './ReorderItems.Actions.Quantity.View';\nimport { Configuration } from '../../SCA/JavaScript/Configuration';\nimport { ListHeaderView } from '../../../Commons/ListHeader/JavaScript/ListHeader.View';\nimport { GlobalViewsPaginationView } from '../../../Commons/GlobalViews/JavaScript/GlobalViews.Pagination.View';\nimport { GlobalViewsShowingCurrentView } from '../../../Commons/GlobalViews/JavaScript/GlobalViews.ShowingCurrent.View';\n\nimport ReorderItemsCollection = require('./ReorderItems.Collection');\nimport ReorderItemsActionsAddToCartView = require('./ReorderItems.Actions.AddToCart.View');\nimport Tracker = require('../../../Commons/Tracker/JavaScript/Tracker');\nimport LiveOrderModel = require('../../../Commons/LiveOrder/JavaScript/LiveOrder.Model');\nimport BackboneCollectionView = require('../../../Commons/Backbone.CollectionView/JavaScript/Backbone.CollectionView');\nimport TransactionLineViewsCellActionableView = require('../../../Commons/Transaction.Line.Views/JavaScript/Transaction.Line.Views.Cell.Actionable.View');\nimport Handlebars = require('../../../Commons/Utilities/JavaScript/Handlebars');\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\n\n// @class ReorderItems.List.View @extends Backbone.View\nconst ReorderItemsListView: any = BackboneView.extend({\n    // @propery {Function} template\n    template: reorder_items_list_tpl,\n    // @propery {String} className\n    className: 'OrderItemReorderListView',\n    // @propery {String} title\n    title: Utils.translate('Reorder Items'),\n    // @propery {String} page_header\n    page_header: Utils.translate('Reorder Items'),\n    // @propery {Object} attributes\n    attributes: {\n        id: 'ReorderHistory',\n        class: 'OrderItemReorderListView'\n    },\n    // @propery {Object} events\n    events: {\n        'click [data-action=\"add-to-cart\"]': 'addToCart',\n        'change [name=\"item_quantity\"]': 'updateQuantity'\n    },\n    // @method initialize\n    initialize: function(options) {\n        this.application = options.application;\n        this.collection = new ReorderItemsCollection();\n        let routerOptions;\n        if (options.routerArguments && options.routerArguments[0]) {\n            routerOptions = Utils.parseUrlOptions(options.routerArguments[0]);\n        } else {\n            routerOptions = { page: 1 };\n        }\n\n        // this will always be false to be backward compatible with templates that are\n        // displaying the current page when it should not be done\n        this.options.showCurrentPage = false;\n\n        if (routerOptions.order_id) {\n            this.collection.order_id = routerOptions.order_id;\n            this.order_id = routerOptions.order_id;\n            this.order_number = routerOptions.order_number || 0;\n        }\n\n        this.listenCollection();\n\n        // manges sorting and filtering of the collection\n        this.listHeader = new ListHeaderView({\n            view: this,\n            application: options.application,\n            collection: this.collection,\n            filters: routerOptions.order_id ? null : this.filterOptions,\n            sorts: routerOptions.order_id ? this.sortOptionsSingleOrder : this.sortOptions,\n            hidePagination: true,\n            headerMarkup: routerOptions.order_id ? this.getOrderLink() : ''\n        });\n        if (this.order_id) {\n            this.collection.set({\n                order_id: this.order_id\n            });\n        }\n        this.collection.on('reset', this.render, this);\n    },\n\n    // @method updateQuantity\n    updateQuantity: function(e) {\n        const target = jQuery(e.currentTarget);\n        const line_id = target.data('line-id');\n        const line = this.collection.get(line_id);\n        const item = line.get('item');\n        const min_quantity = item.get('_minimumQuantity', true) || 1;\n        const max_quantity = item.get('_maximumQuantity', true) || null;\n\n        const new_value = parseInt(<any>target.val(), 10);\n        if (new_value < min_quantity) {\n            target.val(min_quantity);\n        }\n\n        if (max_quantity && new_value > max_quantity) {\n            target.val(max_quantity);\n        }\n\n        line.set('quantity', new_value);\n    },\n\n    // @method getOrderLink\n    getOrderLink: function() {\n        const order_link = jQuery('<a/>')\n            .attr('href', `/ordershistory/view/${this.order_id}`)\n            .html(Utils.translate('Order Number: $(0)', this.order_id))\n            .wrap('<div></div>')\n            .parent();\n\n        return new Handlebars.SafeString(order_link.html());\n    },\n    // @method listenCollection\n    listenCollection: function() {\n        this.setLoading(true);\n\n        this.collection.on({\n            request: jQuery.proxy(this, 'setLoading', true),\n            reset: jQuery.proxy(this, 'setLoading', false)\n        });\n    },\n    // @method setLoading\n    setLoading: function(value) {\n        this.isLoading = value;\n    },\n\n    // @method getSelectedMenu\n    getSelectedMenu: function() {\n        return 'reorderitems';\n    },\n    // @method getBreadcrumbPages\n    getBreadcrumbPages: function() {\n        const crumbtrail = [\n            {\n                text: this.title,\n                href: '/reorderItems'\n            }\n        ];\n\n        if (this.order_id && this.order_number) {\n            this.title = Utils.translate('Reorder Items from Order #$(0)', this.order_number);\n            crumbtrail.push({\n                text: Utils.translate('Order #$(0)', this.order_number),\n                href: `/reorderItems/order/${this.order_id}`\n            });\n        }\n\n        return crumbtrail;\n    },\n\n    // @method trackEventReorder\n    trackEventReorder: function(line) {\n        line &&\n            Tracker.getInstance().trackEvent({\n                category: 'My Account - User Interaction',\n                action: 'Reorder',\n                label: line.generateURL()\n            });\n    },\n\n    // @method addToCart add to cart an item, the quantity is written by the user on\n    // the input and the options are the same that the ordered item in the previous order\n    addToCart: function(e) {\n        e.preventDefault();\n\n        const self = this;\n        const line_id = this.$(e.target).data('line-id');\n        const $form = this.$(e.target).closest('[data-type=\"order-item\"]');\n        const $quantity = $form.find('input[name=item_quantity]');\n        const selected_line = this.collection.get(line_id);\n        const $alert_placeholder = $form.find('[data-type=alert-placeholder]');\n        const quantity = isNaN(parseInt($quantity.val(), 10)) ? 0 : parseInt($quantity.val(), 10);\n\n        const layout = this.application.getLayout();\n\n        if (quantity) {\n            selected_line.set('quantity', quantity);\n\n            // The 'fulfillmentChoice' for reorders must be setted to 'ship'\n            if (selected_line.get('fulfillmentChoice')) {\n                selected_line.set('fulfillmentChoice', 'ship');\n            }\n\n            LiveOrderModel.getInstance()\n                .addLine(selected_line)\n                .done(function() {\n                    self.trackEventReorder(selected_line);\n\n                    $alert_placeholder.show().empty();\n\n                    let message;\n\n                    if (quantity > 1) {\n                        message = Utils.translate(\n                            '$(0) Items successfully added to <a href=\"#\" data-touchpoint=\"viewcart\">your cart</a><br/>',\n                            quantity\n                        );\n                    } else {\n                        message = Utils.translate(\n                            'Item successfully added to <a href=\"#\" data-touchpoint=\"viewcart\">your cart</a><br/>'\n                        );\n                    }\n\n                    layout.showMessage($alert_placeholder, message, 'success', true);\n\n                    setTimeout(function() {\n                        $alert_placeholder.fadeOut(function() {\n                            $alert_placeholder.empty();\n                        });\n                    }, 6000);\n                })\n                .fail(function(jqXhr) {\n                    jqXhr.preventDefault = true;\n\n                    $alert_placeholder.show().empty();\n                    layout.showXHRErrorMessage($alert_placeholder, jqXhr, true);\n                });\n        } else {\n            const message = Utils.translate('The number of items must be positive.');\n            $alert_placeholder.show().empty();\n\n            layout.showMessage($alert_placeholder, message, 'error', true);\n        }\n    },\n\n    // @method getStringDateFromDaysCount Returns a date\n    // substracting the amound of days specified from now\n    getStringDateFromDaysCount: function(days_back) {\n        const now = new Date();\n        return new Date(now.setDate(now.getDate() - days_back));\n    },\n    // @method {Array} sortOptionsSingleOrder\n    sortOptionsSingleOrder: [\n        {\n            value: 'price',\n            name: Utils.translate('By Price'),\n            selected: true\n        },\n        {\n            value: 'name',\n            name: Utils.translate('By Name')\n        }\n    ],\n    // @method {Array} sortOptions\n    sortOptions: [\n        {\n            value: 'quantity',\n            name: Utils.translate('By Frequently Purchased'),\n            selected: true\n        },\n        {\n            value: 'date',\n            name: Utils.translate('By Most Recently Purchased')\n        },\n        {\n            value: 'price',\n            name: Utils.translate('By Price')\n        },\n        {\n            value: 'name',\n            name: Utils.translate('By Name')\n        }\n    ],\n    // @method {Array} filterOptions\n    filterOptions: [\n        {\n            value: function() {\n                return `${Utils.dateToString(\n                    this.getStringDateFromDaysCount(15)\n                )}T${Utils.dateToString(new Date())}`;\n            },\n            name: Utils.translate('Show last 15 days'),\n            className: 'reorder-items-filter-last-15-days',\n            selected: !SC.ENVIRONMENT.standalone\n        },\n        {\n            value: function() {\n                return `${Utils.dateToString(\n                    this.getStringDateFromDaysCount(30)\n                )}T${Utils.dateToString(new Date())}`;\n            },\n            name: Utils.translate('Show last 30 days'),\n            className: 'reorder-items-filter-last-30-days'\n        },\n        {\n            value: function() {\n                return `${Utils.dateToString(\n                    this.getStringDateFromDaysCount(60)\n                )}T${Utils.dateToString(new Date())}`;\n            },\n            name: Utils.translate('Show last 60 days'),\n            className: 'reorder-items-filter-last-60-days',\n            selected: SC.ENVIRONMENT.standalone\n        },\n        {\n            value: function() {\n                return `${Utils.dateToString(\n                    this.getStringDateFromDaysCount(90)\n                )}T${Utils.dateToString(new Date())}`;\n            },\n            name: Utils.translate('Show last 90 days'),\n            className: 'reorder-items-filter-last-90-days'\n        },\n        {\n            value: function() {\n                return `${Utils.dateToString(\n                    this.getStringDateFromDaysCount(180)\n                )}T${Utils.dateToString(new Date())}`;\n            },\n            name: Utils.translate('Show last 180 days'),\n            className: 'reorder-items-filter-last-180-days'\n        }\n    ],\n    // @property {Object} childViews\n    childViews: {\n        ListHeader: function() {\n            return this.listHeader;\n        },\n        'GlobalViews.Pagination': function() {\n            return new GlobalViewsPaginationView(\n                _.extend(\n                    {\n                        totalPages: Math.ceil(\n                            this.collection.totalRecordsFound / this.collection.recordsPerPage\n                        )\n                    },\n                    Configuration.defaultPaginationSettings\n                )\n            );\n        },\n        'GlobalViews.ShowCurrentPage': function() {\n            return new GlobalViewsShowingCurrentView({\n                items_per_page: this.collection.recordsPerPage,\n                total_items: this.collection.totalRecordsFound,\n                total_pages: Math.ceil(\n                    this.collection.totalRecordsFound / this.collection.recordsPerPage\n                )\n            });\n        },\n        'Reorder.Items': function() {\n            const view = new BackboneCollectionView({\n                collection: this.collection.filter(function(line) {\n                    return (\n                        line.get('item') &&\n                        line.get('item').get('_id') &&\n                        line.get('item').get('ispricevisible') !== false\n                    );\n                }),\n                viewsPerRow: 1,\n                childView: TransactionLineViewsCellActionableView,\n                childViewOptions: {\n                    application: this.application,\n                    navigable: !SC.ENVIRONMENT.standalone,\n                    SummaryView: ReorderItemsActionsQuantityView,\n                    ActionsView: ReorderItemsActionsAddToCartView,\n                    showComparePrice: true\n                }\n            });\n\n            this.collection.on('reset', function() {\n                view.render();\n            });\n\n            return view;\n        }\n    },\n    // @method getContext: function()\n    getContext: function() {\n        // @class ReorderItems.List.View.Context\n        return {\n            // @propery {Boolean} isLoading\n            isLoading: this.isLoading,\n            // @propery {Boolean} showItems\n            showItems: !!this.collection.totalRecordsFound,\n            // @propery {Boolean} itemsNotFound\n            itemsNotFound: !this.collection.totalRecordsFound && !this.isLoading,\n            // @propery {String} pageHeader\n            pageHeader: this.page_header,\n            // @property {Boolean} showPagination\n            showPagination: !!(this.collection.totalRecordsFound && this.collection.recordsPerPage),\n            // @property {Boolean} showCurrentPage\n            showCurrentPage: this.options.showCurrentPage,\n            // @property {Boolean} showBackToAccount\n            showBackToAccount: Configuration.get('siteSettings.sitetype') === 'STANDARD'\n        };\n    }\n});\n\nexport = ReorderItemsListView;\n"]}