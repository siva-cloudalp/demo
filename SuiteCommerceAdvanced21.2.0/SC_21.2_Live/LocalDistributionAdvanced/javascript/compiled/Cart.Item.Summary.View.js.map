{"version":3,"sources":["Cart.Item.Summary.View.ts"],"names":[],"mappings":"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","file":"Cart.Item.Summary.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Cart.Item.Summary.View\"/>\n\nimport * as _ from 'underscore';\nimport * as cart_item_summary_tpl from 'cart_item_summary.tpl';\nimport { ProfileModel } from '../../Profile/JavaScript/Profile.Model';\n\nimport CartPromocodeListItemView = require('./Cart.Promocode.List.Item.View');\nimport BackboneCollectionView = require('../../Backbone.CollectionView/JavaScript/Backbone.CollectionView');\nimport BackboneView = require('../../BackboneExtras/JavaScript/Backbone.View');\n\nexport = BackboneView.extend({\n    // @property {Function} template\n    template: cart_item_summary_tpl,\n\n    // @property {Object} events\n    events: {\n        'click [data-action=\"plus\"]': 'addQuantity',\n        'click [data-action=\"minus\"]': 'subQuantity'\n    },\n\n    // @method addQuantity Add 1 to the quantity field\n    // @param {jQuery.Event} e\n    // @return {Void}\n    addQuantity: function(e) {\n        e.preventDefault();\n\n        const $element = this.$(e.target);\n        const quantity_input = $element.parent().find('input');\n        const old_value = quantity_input.val();\n        const max_quantity = this.model.get('item').get('_maximumQuantity', true);\n        let new_val = parseFloat(old_value) + 1;\n\n        new_val = max_quantity ? Math.min(max_quantity, new_val) : new_val;\n\n        quantity_input.val(new_val);\n        quantity_input.change();\n    },\n\n    // @method subQuantity Subtract 1 from the quantity field\n    // @param {jQuery.Event} e\n    // @return {Void}\n    subQuantity: function(e) {\n        e.preventDefault();\n\n        const $element = this.$(e.target);\n        const quantity_input = $element.parent().find('input');\n        const old_value = quantity_input.val();\n        let new_val = parseFloat(old_value) - 1;\n\n        new_val = Math.max(this.model.get('item').get('_minimumQuantity', true), new_val);\n\n        quantity_input.val(new_val);\n        quantity_input.change();\n    },\n    childViews: {\n        PromocodeList: function() {\n            if (this.model.get('discounts_impact')) {\n                const discounts = _.filter(this.model.get('discounts_impact').discounts, function(\n                    discount: any\n                ) {\n                    return !!discount.promotion_couponcode;\n                });\n\n                return new BackboneCollectionView({\n                    collection: discounts,\n                    viewsPerRow: 1,\n                    childView: CartPromocodeListItemView,\n                    childViewOptions: {\n                        isReadOnly: true,\n                        source: 'item_summary'\n                    }\n                });\n            }\n        }\n    },\n\n    // @method getContext\n    // @return {Cart.Item.Summary.View.Context}\n    getContext: function() {\n        const minimum_quantity = this.model.get('item').get('_minimumQuantity', true) || 1;\n        const maximum_quantity = this.model.get('item').get('_maximumQuantity', true);\n        const price_container_object = this.model.getPrice();\n\n        // @class Cart.Item.Summary.View.Context\n        return {\n            // @property {Model} line\n            line: this.model,\n            // @property {String} lineId\n            lineId: this.model.get('internalid'),\n            // @property {Boolean} isMinusButtonDisabled\n            isMinusButtonDisabled:\n                this.model.get('item').get('quantity') <= minimum_quantity ||\n                this.model.get('item').get('quantity') === 1,\n            // @property {Boolean} isPlusButtonDisabled\n            isPlusButtonDisabled:\n                !!maximum_quantity && this.model.get('item').get('quantity') >= maximum_quantity,\n            // @property {Boolean} showQuantity\n            showQuantity: this.model.get('item').get('_itemType') === 'GiftCert',\n            // @property {Boolean} showComparePrice\n            showComparePrice: this.model.get('amount') > this.model.get('total'),\n            // @property {Boolean} showMinimumQuantity\n            showMinimumQuantity: minimum_quantity > 1,\n            // @property {Integer} minimumQuantity\n            minimumQuantity: minimum_quantity,\n            // @property {Boolean} showMaximumQuantity\n            showMaximumQuantity: !!maximum_quantity,\n            // @property {Integer} maximumQuantity\n            maximumQuantity: maximum_quantity,\n            // @property {Boolean} isPriceEnabled\n            isPriceEnabled: !ProfileModel.getInstance().hidePrices(),\n            // @property {String} totalFormatted\n            totalFormatted:\n                price_container_object.total_formatted || this.model.get('total_formatted') || ''\n        };\n        // @class Cart.Item.Summary.View\n    }\n});\n"]}