{"version":3,"sources":["SocialSharing.Plugins.Facebook.ts"],"names":[],"mappings":"AAAA;;;;;EAKE;;;IAYF,2DAA2D;IAC3D,IAAM,cAAc,GAAQ;QACxB,oBAAoB,EAAE,IAAI;QAC1B,4BAA4B,EAAE;YAC1B,IAAM,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;YACjC,IAAM,oBAAoB,GAAG,IAAI,CAAC,+BAA+B,CAC7D,6BAAa,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAC7C,CAAC;YACF,IAAM,UAAU,GACZ,6DAA6D;gBAC7D,6BAAa,CAAC,GAAG,CAAC,gBAAgB,CAAC;gBACnC,QAAQ;gBACR,kBAAkB,CAAC,GAAG,CAAC;gBACvB,gBAAgB;gBAChB,kBAAkB,CAAC,KAAK,CAAC,cAAc,CAAC,GAAG,EAAE,EAAE,YAAY,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;YAEvE,MAAM,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE,oBAAoB,CAAC,CAAC;QACxE,CAAC;QAED,UAAU,EAAE,UAAS,WAAW;YAC5B,sFAAsF;YACtF,qBAAS,CAAC,gBAAgB,CAAC,cAAc,EAAE;gBACvC,MAAM,CAAC,KAAK,EAAE,CAAC;YACnB,CAAC,CAAC,CAAC;YAEH,IAAI,6BAAa,CAAC,GAAG,CAAC,iBAAiB,CAAC,EAAE;gBACtC,IAAM,MAAM,GAAG,WAAW,CAAC,SAAS,EAAE,CAAC;gBAEvC,iFAAiF;gBACjF,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE;oBACpB,yCAAyC,EAAE,IAAI,CAAC,4BAA4B;iBAC/E,CAAC,CAAC;gBAEH,wEAAwE;gBACxE,mFAAmF;gBACnF,IAAM,MAAM,GAAG;oBACX,IAAI,EAAE,gBAAgB;oBACtB,QAAQ,EAAE,EAAE;oBACZ,OAAO,EAAE,UAAS,WAAW;wBACzB,IAAM,MAAM,GAAG,WAAW,CAAC,SAAS,EAAE,CAAC;wBAEvC,IAAI,CAAC,MAAM,CAAC,gCAAgC,CAAC,CAAC,MAAM,EAAE;4BAClD,MAAM,CAAC,GAAG;iCACL,IAAI,CAAC,kCAAkC,CAAC;iCACxC,MAAM,CACH,6LAA6L,CAChM,CAAC;yBACT;oBACL,CAAC;iBACJ,CAAC;gBAEF,aAAa,CAAC,eAAe,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;gBAC9C,aAAa,CAAC,gBAAgB,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;aAClD;QACL,CAAC;KACJ,CAAC;IAEF,OAAS,cAAc,CAAC","file":"SocialSharing.Plugins.Facebook.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"SocialSharing.Plugins.Facebook\"/>\n\nimport * as _ from 'underscore';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { Configuration } from '../../../Commons/Utilities/JavaScript/Configuration';\n\nimport { UrlHelper } from '../../../Commons/UrlHelper/JavaScript/UrlHelper';\nimport SocialSharing = require('./SocialSharing');\n\n// @class SocialSharing.Facebook @extends ApplicationModule\nconst facebookPlugin: any = {\n    excludeFromMyAccount: true,\n    shareInFacebookEventListener: function() {\n        const url = window.location.href;\n        const popup_options_string = this.getPopupOptionsStringFromObject(\n            Configuration.get('facebook.popupOptions')\n        );\n        const target_url =\n            'https://www.facebook.com/dialog/share?display=popup&app_id=' +\n            Configuration.get('facebook.appId') +\n            '&href=' +\n            encodeURIComponent(url) +\n            '&redirect_uri=' +\n            encodeURIComponent(Utils.addParamsToUrl(url, { closeFBPopup: 1 }));\n\n        window.open(target_url, _.uniqueId('window'), popup_options_string);\n    },\n\n    mountToApp: function(application) {\n        // This will close the popup window after the redirect occurs (after the user shares).\n        UrlHelper.addTokenListener('closeFBPopup', function() {\n            window.close();\n        });\n\n        if (Configuration.get('facebook.enable')) {\n            const layout = application.getLayout();\n\n            // This are mostly related to the dom, or to events, so we add them in the layout\n            _.extend(layout.events, {\n                'click [data-action=\"share-in-facebook\"]': this.shareInFacebookEventListener\n            });\n\n            // @class SocialSharing.Facebook.Plugin this plugin is installed in both\n            // SocialSharing.afterAppendView and SocialSharing.afterAppendToDom @extends Plugin\n            const plugin = {\n                name: 'facebookPlugin',\n                priority: 10,\n                execute: function(application) {\n                    const layout = application.getLayout();\n\n                    if (!jQuery('[data-type=\"like-in-facebook\"]').length) {\n                        layout.$el\n                            .find('[data-type=\"social-share-icons\"]')\n                            .append(\n                                '<a href=\"#\" class=\"social-sharing-flyout-content-social-facebook\" data-action=\"share-in-facebook\"><i class=\"social-sharing-flyout-content-social-facebook-icon\"></i> <span>Share</span></a>'\n                            );\n                    }\n                }\n            };\n\n            SocialSharing.afterAppendView.install(plugin);\n            SocialSharing.afterAppendToDom.install(plugin);\n        }\n    }\n};\n\nexport = facebookPlugin;\n"]}