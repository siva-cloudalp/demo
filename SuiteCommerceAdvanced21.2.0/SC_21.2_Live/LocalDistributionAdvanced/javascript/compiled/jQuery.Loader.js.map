{"version":3,"sources":["jQuery.Loader.ts"],"names":[],"mappings":"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","file":"jQuery.Loader.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"jQuery.Loader\"/>\n\nimport * as _ from 'underscore';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\n\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\n\n// Variable used to track the mouse position\nlet mouse_position = {\n    top: 0,\n    left: 0\n};\n\nSC.loadingIndicatorShow = function() {\n    SC.$loadingIndicator && SC.$loadingIndicator.css(mouse_position).show();\n};\n\nSC.loadingIndicatorHide = function() {\n    SC.$loadingIndicator && SC.$loadingIndicator.hide();\n};\n// This registers an event listener to any ajax call\nconst $document = jQuery(document)\n    // http://api.jquery.com/ajaxStart/\n    .ajaxStart(SC.loadingIndicatorShow)\n    // http://api.jquery.com/ajaxStop/\n    .ajaxStop(SC.loadingIndicatorHide);\n\n// fix to solve APM issue (timebrowser timing): https://confluence.corp.netsuite.com/display/SCRUMPSGSVCS/RUM+API+Issues+and+Enhancements\nif (_.result(SC.ENVIRONMENT, 'SENSORS_ENABLED')) {\n    $document.ajaxStop(function() {\n        if (\n            typeof (<any>window).NLRUM !== 'undefined' &&\n            typeof (<any>window).NLRUM.mark !== 'undefined'\n        ) {\n            (<any>window).NLRUM.mark('done');\n        }\n    });\n}\n\njQuery(document).ready(function() {\n    const $body = jQuery(document.body);\n    let $loading_icon = jQuery('#loadingIndicator');\n\n    if (!$loading_icon.length && !(SC && SC.ENVIRONMENT && SC.ENVIRONMENT.isTouchEnabled)) {\n        // if the icon wasn't there, lets add it and make a reference in the global scope\n        $loading_icon = jQuery('<img/>', {\n            id: 'loadingIndicator',\n            class: 'global-loading-indicator',\n            src: Utils.getThemeAbsoluteUrlOfNonManagedResources('img/ajax-loader.gif'),\n            css: {\n                zIndex: 9999,\n                position: 'absolute'\n            }\n        }).hide();\n\n        if (!_.result(SC, 'isPageGenerator')) {\n            $loading_icon.appendTo($body);\n        }\n    }\n\n    SC.$loadingIndicator = $loading_icon;\n\n    // loading icon sizes, used for positioning math\n    const icon_height = 16;\n    const icon_width = 16;\n\n    $body.on({\n        // On mouse move, we update the icon's position, even if its not shown\n        mousemove: _.throttle(function(e) {\n            mouse_position = {\n                top: Math.min($body.innerHeight() - icon_height, e.pageY + icon_width),\n                left: Math.min($body.innerWidth() - icon_width, e.pageX + icon_height)\n            };\n\n            $loading_icon.filter(':visible').css(mouse_position);\n        }, 50),\n        // when the body resizes, we move the icon to the bottom of the page\n        // so we don't get some empty white space at the end of the body\n        resize: _.throttle(function() {\n            const icon_offset = $loading_icon.offset();\n            if (!icon_offset) {\n                return;\n            }\n            mouse_position = {\n                top: Math.min($body.innerHeight() - icon_height, icon_offset.top),\n                left: Math.min($body.innerWidth() - icon_width, icon_offset.left)\n            };\n\n            $loading_icon.filter(':visible').css(mouse_position);\n        }, 50)\n    });\n});\n"]}