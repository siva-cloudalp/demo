{"version":3,"sources":["Cart.ts"],"names":[],"mappings":"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","file":"Cart.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Cart\"/>\n\nimport * as _ from 'underscore';\nimport * as Utils from '../../Utilities/JavaScript/Utils';\nimport * as jQuery from '../../Core/JavaScript/jQuery';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\n\nimport LiveOrderModel = require('../../../Commons/LiveOrder/JavaScript/LiveOrder.Model');\nimport CartDetailedView = require('./Cart.Detailed.View');\nimport CartConfirmationHelpers = require('./Cart.Confirmation.Helpers');\nimport CartComponent = require('./Cart.Component');\n\n/*\n    @class Cart\n\n    Defines the Cart module\n\n    mountToApp() handles some environment issues\n\n    @extends ApplicationModule\n*/\nexport function mountToApp(application) {\n    this.cart_model = LiveOrderModel.getInstance();\n\n    // Check if cart was bootstrapped\n    if (!SC.ENVIRONMENT.CART_BOOTSTRAPED) {\n        // Load the cart information\n        LiveOrderModel.loadCart();\n    } else if (!_.isEmpty(SC.ENVIRONMENT.CART)) {\n        const cart = SC.ENVIRONMENT.CART;\n\n        // If the condition below is false, that means the cart is empty.\n        // I would suggest to remove the confirmation\n        // property if not required as a sustainability task.\n        if (!(Object.keys(cart).length === 1 && cart.hasOwnProperty('confirmation'))) {\n            this.cart_model.set(cart);\n            this.cart_model.cartLoad = this.cart_model.cartLoad || jQuery.Deferred();\n            this.cart_model.isLoading = false;\n            this.cart_model.cartLoad.resolveWith(cart);\n        }\n    }\n\n    const self = this;\n\n    // IMPORTANT: This api/method is preserve ONLY for Bronto Integration.\n    // IT IS NOT A PUBLIC API!\n    application.getCart = function getCart() {\n        console.warn('Using application.getCart is deprecated!');\n        const cart_promise = jQuery.Deferred();\n\n        LiveOrderModel.loadCart()\n            .done(function() {\n                cart_promise.resolve(self.cart_model);\n            })\n            .fail(function() {\n                cart_promise.reject.apply(this, arguments);\n            });\n\n        return cart_promise;\n    };\n\n    application.getLayout().goToCart = function() {\n        return CartConfirmationHelpers._goToCart(this.application.getCart());\n    };\n\n    application.getLayout().showMiniCart = function() {\n        return CartConfirmationHelpers._showMiniCart(\n            this.application.getCart(),\n            null,\n            this.application\n        );\n    };\n\n    application.getLayout().showCartConfirmationModal = function() {\n        return CartConfirmationHelpers._showCartConfirmationModal(\n            this.application.getCart(),\n            null,\n            this.application\n        );\n    };\n\n    // Initializes the router\n    if (Configuration.get('modulesConfig.Cart.startRouter', true)) {\n        const pageType = application.getComponent('PageType');\n        pageType.registerPageType({\n            name: 'Cart.Detailed.View',\n            routes: ['cart', 'cart?*options'],\n            view: CartDetailedView,\n            defaultTemplate: {\n                name: 'cart_detailed.tpl',\n                displayName: 'Cart detailed default',\n                thumbnail: Utils.getThemeAbsoluteUrlOfNonManagedResources(\n                    'img/default-layout-cart.png'\n                )\n            }\n        });\n    }\n\n    return CartComponent(application);\n}\n"]}