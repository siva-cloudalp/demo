{"version":3,"sources":["OrderHistory.Packages.View.ts"],"names":[],"mappings":"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","file":"OrderHistory.Packages.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"OrderHistory.Packages.View\"/>\n\nimport * as _ from 'underscore';\nimport * as order_history_packages_tpl from 'order_history_packages.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport { Configuration } from '../../SCA/JavaScript/Configuration';\nimport { ProfileModel } from '../../../Commons/Profile/JavaScript/Profile.Model';\n\nimport TransactionLineViewsCellActionableView = require('../../../Commons/Transaction.Line.Views/JavaScript/Transaction.Line.Views.Cell.Actionable.View');\nimport TransactionLineViewsQuantityAmountView = require('../../../Commons/Transaction.Line.Views/JavaScript/Transaction.Line.Views.QuantityAmount.View');\nimport OrderHistoryItemActionsView = require('./OrderHistory.Item.Actions.View');\nimport { AddressDetailsView } from '../../../Commons/Address/JavaScript/Address.Details.View';\nimport OrderHistoryListTrackingNumberView = require('./OrderHistory.List.Tracking.Number.View');\nimport LocationVenueDetailsView = require('../../Location.SCA/JavaScript/Location.VenueDetails.View');\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\nimport BackboneCollectionView = require('../../../Commons/Backbone.CollectionView/JavaScript/Backbone.CollectionView');\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\n\n// @class OrderHistory.Packages.View @extend Backbone.View\nconst OrderHistoryPackagesView: any = BackboneView.extend({\n    // @property {Function} template\n    template: order_history_packages_tpl,\n    // @method initialize\n    initialize: function() {\n        this.isInStore = false;\n\n        if (this.model.get('packageGroup') === 'instore') {\n            this.location = this.model.get('location');\n            this.profile_model = ProfileModel.getInstance();\n\n            try {\n                const ReferenceMap = Utils.requireModules('ReferenceMap');\n                this.reference_map = new ReferenceMap();\n            } catch (e) {\n                e;\n            }\n\n            this.isInStore = true;\n\n            this.location.on('change', this.render, this);\n        } else {\n            this.address = this.model.get('shipaddress');\n        }\n    },\n    // @property {Object} childViews\n    childViews: {\n        'Address.StoreLocationInfo': function() {\n            return new LocationVenueDetailsView({\n                model: this.location,\n                application: this.options.application,\n                showAddress: true,\n                hideCutoffTime: true\n            });\n        },\n        'Shipping.Address.View': function() {\n            if (!this.isInStore) {\n                return new AddressDetailsView({\n                    model: this.address,\n                    hideDefaults: true,\n                    hideActions: true,\n                    hideSelector: true\n                });\n            }\n        },\n\n        TrackingNumbers: function() {\n            return new OrderHistoryListTrackingNumberView({\n                model: new Backbone.Model({ trackingNumbers: this.model.get('trackingnumbers') }),\n                showTrackPackagesLabel: true\n            });\n        },\n\n        'Items.Collection': function() {\n            return new BackboneCollectionView({\n                collection: this.model.get('lines'),\n                childView: TransactionLineViewsCellActionableView,\n                viewsPerRow: 1,\n                childViewOptions: {\n                    navigable: !this.options.application.isStandalone(),\n                    application: this.options.application,\n                    SummaryView: TransactionLineViewsQuantityAmountView,\n                    ActionsView: OrderHistoryItemActionsView,\n                    showTaxDetails: Configuration.get('showTaxDetailsPerLine'),\n                    showAlert: !_.isUndefined(this.options.showAlert)\n                        ? !!this.options.showAlert\n                        : true,\n                    ignorePriceVisibility: !!this.options.ignorePriceVisibility\n                }\n            });\n        }\n    },\n\n    // @method getContext @return OrderHistory.Packages.View.Context\n    getContext: function() {\n        let directions_url = '';\n\n        if (\n            this.reference_map &&\n            this.location &&\n            !this.location.isNew() &&\n            this.location.get('location')\n        ) {\n            directions_url = this.reference_map.getDirectionsUrl(\n                this.profile_model.get('storeLocator_last_search'),\n                this.location.get('location')\n            );\n        }\n\n        // @class OrderHistory.Packages.View.Context\n        return {\n            isStandalone: this.options.application.isStandalone(),\n            // @property {Model} model\n            model: this.model,\n            // @property {Boolean} showOrderAddress\n            showOrderAddress: !!(this.address && this.address.get('fullname')),\n            // @property {String} orderAddress\n            orderAddress: this.address ? this.address.get('fullname') : '',\n            // @property {Boolean} showDeliveryMethod\n            showDeliveryMethod: !!(\n                this.model.get('shipmethod') && this.model.get('shipmethod').get('name')\n            ),\n            // @property {String} deliveryMethodName\n            deliveryMethodName: this.model.get('shipmethod')\n                ? this.model.get('shipmethod').get('name')\n                : '',\n            // @property {Boolean} showDeliverySatatus\n            showDeliveryStatus:\n                !this.isInStore &&\n                !!(this.model.get('status') && this.model.get('status').internalid) &&\n                !this.model.get('date'),\n            // @property {Boolean} showPackageStatus\n            showPackageStatus:\n                !!(this.model.get('status') && this.model.get('status').name) &&\n                !this.model.get('date'),\n            // @property {String} packageStatus\n            packageStatus: this.model.get('status') && this.model.get('status').name,\n            // @property {Boolean} showDate\n            showDate: !!this.model.get('date'),\n            // @property {Boolean} showTrackingNumbers\n            showTrackingNumbers: !!this.model.get('trackingnumbers'),\n            // @property {Boolean} isPackageInStore\n            isPackageInStore: this.isInStore,\n            // @property {String} date\n            date: this.model.get('date') ? this.model.get('date') : '',\n            // @property {Number} linesItemsAmount\n            linesItemsAmount:\n                !!this.model.get('lines') &&\n                _.reduce(\n                    this.model.get('lines'),\n                    function(count, line: any) {\n                        return count + line.get('quantity');\n                    },\n                    0\n                ),\n            // @property {Boolean} showOrderLocation\n            showOrderLocation: !!this.location && !!this.location.get('name'),\n            // @property {StoreLocator.Model} orderLocation\n            orderLocation: this.location,\n            // @property {String} getDirectionsUrl\n            getDirectionsUrl: directions_url,\n            // @property {String} showGetDirectionButton\n            showGetDirectionButton: !!directions_url,\n            // @property {String} initiallyCollapsed\n            initiallyCollapsed: Utils.isPhoneDevice() ? '' : 'in',\n            // @property {String} initiallyCollapsedArrow\n            initiallyCollapsedArrow: Utils.isPhoneDevice() ? 'collapsed' : '',\n            // @property {String} targetId\n            targetId: this.model.get('internalid')\n        };\n    }\n});\n\nexport = OrderHistoryPackagesView;\n"]}