{"version":3,"sources":["GoogleTagManager.ts"],"names":[],"mappings":"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","file":"GoogleTagManager.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"GoogleTagManager\"/>\n/// <reference path=\"../../../Commons/Utilities/JavaScript/GlobalDeclarations.d.ts\" />\n/// <reference path=\"./WindowExtended.d.ts\" />\n\nimport * as _ from 'underscore';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { Configuration } from '../../SCA/JavaScript/Configuration';\n\nimport Tracker = require('../../../Commons/Tracker/JavaScript/Tracker');\nimport GoogleTagManagerNavigationHelper = require('./GoogleTagManager.NavigationHelper.Plugins.Standard');\nimport GoogleTagManagerModel = require('./GoogleTagManager.Model');\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\nimport Cookies = require('../../../Commons/Utilities/JavaScript/js.cookie');\n\n// @module GoogleTagManager\n// jshint laxcomma:true\n// @class GoogleTagManager @extends ApplicationModule Loads Google Tag Manager scripts\n\nconst win: any = window;\nconst GoogleTagManager: any = {\n    tracking_product_list: false,\n    data_layer_loaded: false,\n    data_layer_loading: false,\n    // @method doCallback Indicates if this module does a callback after some particular events\n    // @return {Boolean}\n    // ie: when you do a log-in, we need to track that event before we navigate to the new\n    // page, otherwise the track of the event could be aborted. We have a special case in\n    // which this doesn't work, for exampmle, if a browser extension blocks the Analytics\n    // tracking but not GTM, the log-in callback is never excecuted\n    doCallback: function() {\n        return !!win.google_tag_manager;\n    },\n\n    // @method trackPageview\n    // @param {String} url\n    // @return {GoogleTagManager}\n    trackPageview: function(url) {\n        if (_.isString(url)) {\n            const eventName = 'pageView';\n            const eventData = {\n                event: eventName,\n                data: {\n                    page: url\n                }\n            };\n\n            // Triggers a Backbone.Event so others can subscribe to this event and add/replace\n            // data before is send it to Google Tag Manager\n            Tracker.trigger(eventName, eventData, url);\n            this.pushData(eventData);\n        }\n\n        return this;\n    },\n\n    // @method trackHomePageview\n    // @param {String} url\n    // @return {GoogleTagManager}\n    trackHomePageview: function(url) {\n        if (_.isString(url)) {\n            const eventName = 'homeView';\n            const eventData = {\n                event: eventName,\n                data: {\n                    page: url\n                }\n            };\n\n            // Triggers a Backbone.Event so others can subscribe to this event and add/replace\n            // data before is send it to Google Tag Manager\n            Tracker.trigger(eventName, eventData, url);\n            this.pushData(eventData);\n        }\n\n        return this;\n    },\n\n    // @method trackPageviewForCart\n    // @param {String} url\n    // @return {GoogleTagManager}\n    trackPageviewForCart: function(data) {\n        if (_.isString(data.url)) {\n            const eventName = 'cartView';\n            const eventData = {\n                event: eventName,\n                data: {\n                    page: data.url,\n                    currencyCode: SC.ENVIRONMENT.currencyCodeSpecifiedOnUrl,\n                    total: data.total || '',\n                    items: []\n                }\n            };\n\n            if (data.items && data.items.length) {\n                data.items.each(function(item) {\n                    eventData.data.items.push({\n                        sku: item.get('item').get('itemid'),\n                        id: item.get('item').get('itemid'),\n                        title: item.get('item').get('displayname'),\n                        price: item.get('rate_formatted'),\n                        quantity: item.get('quantity'),\n                        image:\n                            (item.get('item').get('itemimages_detail').urls &&\n                                item.get('item').get('itemimages_detail').urls.length &&\n                                item.get('item').get('itemimages_detail').urls[0].url) ||\n                            ''\n                    });\n                });\n            }\n\n            // Triggers a Backbone.Event so others can subscribe to this event and add/replace data\n            // before is send it to Google Tag Manager\n            Tracker.trigger(eventName, eventData, data.url);\n            this.pushData(eventData);\n        }\n\n        return this;\n    },\n\n    // @method trackPageviewForCheckoutStep\n    // @param {Number} step\n    // @return {GoogleTagManager}\n    trackPageviewForCheckoutStep: function(step) {\n        const eventName = 'checkoutView';\n        const eventData = {\n            event: eventName,\n            ecommerce: {\n                checkout: {\n                    actionField: { step: step }\n                }\n            }\n        };\n\n        // Triggers a Backbone.Event so others can subscribe to this event and add/replace data\n        // before is send it to Google Tag Manager\n        Tracker.trigger(eventName, eventData);\n        this.pushData(eventData);\n\n        return this;\n    },\n\n    // @method trackNonEcomemercePageView\n    // @param {String} url\n    // @return {GoogleTagManager}\n    trackNonEcomemercePageView: function(url) {\n        if (_.isString(url)) {\n            const eventName = 'nonEcommercePageView';\n            const eventData = {\n                event: eventName,\n                data: {\n                    page: url\n                }\n            };\n\n            // Triggers a Backbone.Event so others can subscribe to this event and add/replace data\n            // before is send it to Google Tag Manager\n            Tracker.trigger(eventName, eventData, url);\n            this.pushData(eventData);\n        }\n\n        return this;\n    },\n\n    // @method trackEvent Track this actions: guest-checkout, sign-in, create-account, Reorder,\n    // add-to-cart, place-order, wishlist, proceed-to-checkout, payment-selection\n    // @param {TrackEvent} event\n    // @return {GoogleTagManager}\n    trackEvent: function(event) {\n        if (event && event.category && event.action) {\n            const eventName = event.name || 'action';\n            const eventData = {\n                event: eventName,\n                data: {\n                    category: event.category,\n                    action: event.action,\n                    label: event.page || '/' + (<any>Backbone.history).fragment,\n                    value: event.value || ''\n                },\n                eventCallback: event.callback\n            };\n\n            // Triggers a Backbone.Event so others can subscribe to this event and add/replace data\n            // before is send it to Google Tag Manager\n            Tracker.trigger(eventName, eventData, event);\n            this.pushData(eventData);\n        }\n\n        return this;\n    },\n\n    // @method trackProceedToCheckout\n    // @return {Void}\n    trackProceedToCheckout: function(callback) {\n        const event = {\n            name: 'proceedToCheckout',\n            category: 'Checkout - User Interaction',\n            action: 'Proceed To Checkout',\n            callback: callback\n        };\n        this.trackEvent(event);\n    },\n\n    // @method trackLogin\n    // @return {Void}\n    trackLogin: function(event) {\n        const eventData = {\n            name: 'login',\n            category: event.category,\n            action: event.action,\n            callback: event.callback\n        };\n        this.trackEvent(eventData);\n    },\n\n    // @method trackCheckoutAsGuest\n    // @return {Void}\n    trackCheckoutAsGuest: function(event) {\n        const eventData = {\n            name: 'checkoutAsGuest',\n            category: event.category,\n            action: event.action,\n            callback: event.callback\n        };\n        this.trackEvent(eventData);\n    },\n\n    // @method trackSelectedPayment\n    // @param {String} payment\n    // @return {Void}\n    trackSelectedPayment: function(payment) {\n        const event = {\n            name: 'selectPayment',\n            category: 'Checkout - User Interaction',\n            action: 'Select Payment Method',\n            value: payment\n        };\n        this.trackEvent(event);\n    },\n\n    // @method trackRegister\n    // @return {Void}\n    trackRegister: function(event) {\n        const eventData = {\n            name: 'register',\n            category: event.category,\n            action: event.action,\n            callback: event.callback\n        };\n        this.trackEvent(eventData);\n    },\n\n    // @method trackAddToCart\n    // @param {Transaction.Line.Model} line\n    // @return {GoogleTagManager}\n    trackAddToCart: function(line) {\n        if (line) {\n            const selected_options = line.get('options').filter(function(option) {\n                return option.get('value') && option.get('value').label;\n            });\n\n            const item = line.get('item');\n            const eventName = 'addToCart';\n            const eventData = {\n                event: eventName,\n                ecommerce: {\n                    currencyCode: SC.ENVIRONMENT.currencyCodeSpecifiedOnUrl,\n                    add: {\n                        products: [\n                            {\n                                sku: item.get('itemid'),\n                                id: item.get('itemid'),\n                                name: item.get('_name'),\n                                price: item.get('_priceDetails').onlinecustomerprice,\n                                variant: _.map(selected_options, function(option: any) {\n                                    return option.get('value').label;\n                                }).join(', '),\n                                category: this.getCategory(),\n                                quantity: line.get('quantity')\n                            }\n                        ]\n                    }\n                }\n            };\n            // Triggers a Backbone.Event so others can subscribe to this event and add/replace\n            // data before is send it to Google Tag Manager\n            Tracker.trigger(eventName, eventData, line);\n            this.pushData(eventData);\n        }\n        return this;\n    },\n\n    trackCartUpdate: function(items) {\n        if (items.length) {\n            const eventName = 'cartItemsUpdate';\n            const eventData = {\n                event: eventName,\n                data: {\n                    items: []\n                }\n            };\n            items.each(function(line: any) {\n                const item = line.get('item');\n                eventData.data.items.push({\n                    name: item.get('_name'),\n                    sku: item.get('itemid'),\n                    id: item.get('itemid'),\n                    price: line.get('rate'),\n                    amount: line.get('amount'),\n                    variant: _.map(line.get('options').toJSON(), function(option: any) {\n                        return !!option.value && option.value.label;\n                    }).join(', '),\n                    quantity: line.get('quantity')\n                });\n            });\n            // Triggers a Backbone.Event so others can subscribe to this event and add/replace\n            // data before is send it to Google Tag Manager\n            Tracker.trigger(eventName, eventData, items);\n            this.pushData(eventData);\n        }\n        return this;\n    },\n    // @method trackAddToWishlist\n    // @param {Transaction.Line.Model} line\n    // @return {GoogleTagManager}\n    trackAddToWishlist: function(line) {\n        if (line) {\n            const item = line.get('item');\n            const eventName = 'addToWishlist';\n            const eventData = {\n                event: eventName,\n                data: {\n                    action: 'Add To Wishlist',\n                    currencyCode: SC.ENVIRONMENT.currencyCodeSpecifiedOnUrl,\n                    sku: item.get('itemid'),\n                    id: item.get('itemid'),\n                    name: item.get('_name'),\n                    price: item.get('_priceDetails').onlinecustomerprice,\n                    category: 'Shopping - User Interaction',\n                    item_category: this.getCategory()\n                }\n            };\n            // Triggers a Backbone.Event so others can subscribe to this event and add/replace\n            // data before is send it to Google Tag Manager\n            Tracker.trigger(eventName, eventData, line);\n            this.pushData(eventData);\n        }\n        return this;\n    },\n\n    // @method trackTransaction\n    // https://support.google.com/tagmanager/answer/6106097?hl=en\n    // @param {Tracker.Transaction.Model} @extends Backbone.Model transaction\n    // @class Tracker.Transaction.Model\n    // @property {String} confirmationNumber\n    // @property {Number} subTotal\n    // @property {Number} total\n    // @property {Number} taxTotal\n    // @property {Number} shippingCost\n    // @property {Number} handlingCost\n    // @property {Array<{Tracker.Transaction.Items.Model}>} products\n    // @class Tracker.Transaction.Line.Model\n    // @property {String} sku\n    // @property {String} name\n    // @property {String} category\n    // @property {Number} rate\n    // @property {Number} quantity\n    // @property {String} variant\n    // @class Tracker.Transaction.Model\n    // @class GoogleTagManager\n    // @return {GoogleTagManager}\n    trackTransaction: function(transaction) {\n        const self = this;\n        const eventName = 'transaction';\n        const eventData = {\n            event: eventName,\n            ecommerce: {\n                purchase: {\n                    actionField: {\n                        id: transaction.get('confirmationNumber'),\n                        affiliation: '',\n                        revenue:\n                            transaction.get('subTotal') +\n                            transaction.get('taxTotal') +\n                            transaction.get('shippingCost') +\n                            transaction.get('handlingCost'),\n                        currency: SC.ENVIRONMENT.currencyCodeSpecifiedOnUrl,\n                        subtotal: transaction.get('subTotal'),\n                        tax: transaction.get('taxTotal'),\n                        shipping: transaction.get('shippingCost') + transaction.get('handlingCost'),\n                        coupon: []\n                    },\n                    products: []\n                }\n            }\n        };\n\n        _.each(transaction.get('promocodes'), function(promo: any) {\n            eventData.ecommerce.purchase.actionField.coupon.push(promo.code);\n        });\n\n        transaction.get('products').each(function(product) {\n            const result = self.findCategoryAndListInDataLayer(product);\n\n            eventData.ecommerce.purchase.products.push({\n                name: product.get('name'),\n                sku: product.get('id'),\n                id: product.get('id'),\n                price: product.get('rate'),\n                category: result ? result.category || '' : '',\n                variant: product.get('options'),\n                quantity: product.get('quantity')\n            });\n        });\n\n        // Triggers a Backbone.Event so others can subscribe to this event and add/replace data before is send it to Google Tag Manager\n        Tracker.trigger(eventName, eventData, transaction);\n        this.pushData(eventData);\n\n        return this;\n    },\n\n    findCategoryAndListInDataLayer: function(product) {\n        if (SC.ENVIRONMENT.GTM_DATALAYER && SC.ENVIRONMENT.GTM_DATALAYER.events) {\n            const dataLayer = SC.ENVIRONMENT.GTM_DATALAYER.events;\n            const productSku =\n                (product.get('item') && product.get('item').get('_sku')) || product.get('id');\n            if (productSku) {\n                const productClick = _.find(dataLayer, function(obj: any) {\n                    return (\n                        obj.event === 'productClick' &&\n                        obj.ecommerce &&\n                        obj.ecommerce.click &&\n                        obj.ecommerce.click.products &&\n                        productSku.indexOf(obj.ecommerce.click.products[0].id) === 0\n                    );\n                });\n\n                return {\n                    category:\n                        (productClick && productClick.ecommerce.click.products[0].category) || '',\n                    list: (productClick && productClick.ecommerce.click.actionField.list) || ''\n                };\n            }\n        }\n    },\n\n    // @method trackProductList\n    // @param {Backbone.Collection} items\n    // @param {String} listName\n    // @return {GoogleTagManager}\n    trackProductList: function(items, listName) {\n        return this.trackProductListGeneric('productList', items, listName);\n    },\n\n    // @method trackProductListEvent\n    // @param {Backbone.Collection} items\n    // @param {String} listName\n    // @return {GoogleTagManager}\n    trackProductListEvent: function(items, listName) {\n        return this.trackProductListGeneric('productListEvent', items, listName);\n    },\n\n    // @method trackProductListGeneric\n    // @param eventName string\n    // @param {Backbone.Collection} items\n    // @param {String} listName\n    // @return {GoogleTagManager}\n    trackProductListGeneric: function(eventName, items, listName) {\n        if (this.tracking_product_list) {\n            this.resetTracker();\n        }\n\n        this.tracking_product_list = true;\n        const self = this;\n        const eventData = {\n            event: eventName,\n            ecommerce: {\n                currencyCode: SC.ENVIRONMENT.currencyCodeSpecifiedOnUrl,\n                impressions: []\n            },\n            page: this.getCategory(),\n            list: listName,\n            label: listName\n        };\n\n        _.each(items.models, function(item: any, index) {\n            // We set this properties in the item so we can print them on the html, to later be read them by the trackProductClick event\n            item.set('track_productlist_position', index + 1);\n            item.set('track_productlist_category', self.getCategory());\n            item.set('track_productlist_list', listName);\n\n            eventData.ecommerce.impressions.push({\n                name: item.get('_name'),\n                sku: item.get('_sku', true),\n                id: item.get('_sku', true),\n                price: (item.get('_price') && item.get('_price').toFixed(2)) || 0.0,\n                list: item.get('track_productlist_list'),\n                position: item.get('track_productlist_position'),\n                category: item.get('track_productlist_category')\n            });\n        });\n\n        // Triggers a Backbone.Event so others can subscribe to this event and add/replace data before is send it to Google Tag Manager\n        Tracker.trigger(eventName, eventData, items);\n        this.pushData(eventData);\n\n        this.resetTracker();\n\n        this.tracking_product_list = false;\n\n        return this;\n    },\n\n    // @method trackSearchResults\n    // @param {Backbone.Collection} items\n    // @param {String} keyword\n    // @return {GoogleTagManager}\n    trackSearchResults: function(items, keyword) {\n        const self = this;\n        const eventData = {\n            event: 'searchResults',\n            data: {\n                currencyCode: SC.ENVIRONMENT.currencyCodeSpecifiedOnUrl,\n                page: this.getCategory(),\n                list: 'searchResults',\n                label: 'searchResults',\n                items: [],\n                keywords: keyword\n            }\n        };\n\n        _.each(items.models, function(item: any, index) {\n            eventData.data.items.push({\n                name: item.get('_name'),\n                sku: item.get('_sku', true),\n                id: item.get('_sku', true),\n                price: (item.get('_price') && item.get('_price').toFixed(2)) || 0.0,\n                list: 'searchResults',\n                position: index + 1,\n                category: self.getCategory()\n            });\n        });\n\n        // Triggers a Backbone.Event so others can subscribe to this event and add/replace data before is send it to Google Tag Manager\n        Tracker.trigger('searchResults', eventData, items);\n        this.pushData(eventData);\n\n        return this;\n    },\n\n    // @method trackProductClick\n    // @param {Object} item\n    // @return {GoogleTagManager}\n    trackProductClick: function(item) {\n        const eventName = 'productClick';\n        const eventData = {\n            event: eventName,\n            ecommerce: {\n                click: {\n                    actionField: { list: item.get('list') },\n                    products: [\n                        {\n                            name: item.get('name'),\n                            price: item.get('price'),\n                            sku: item.get('sku', true),\n                            id: item.get('sku', true),\n                            category: item.get('category'),\n                            position: item.get('position')\n                        }\n                    ]\n                }\n            }\n        };\n\n        // We set this item in this Tracker to later be read it by the trackProductView event\n        this.item = item;\n        // Triggers a Backbone.Event so others can subscribe to this event and add/replace data before is send it to Google Tag Manager\n        this.pushData(eventData);\n        Tracker.trigger(eventName, eventData, item);\n\n        return this;\n    },\n\n    // @method trackProductView\n    // @param {Product.Model} product\n    // @return {GoogleTagManager}\n    trackProductView: function(product) {\n        const item = product.getItem();\n\n        if (this.item && this.item.get('itemId') === item.get('_id')) {\n            item.set('category', this.item.get('category'), { silent: true });\n            item.set('list', this.item.get('list'), { silent: true });\n        }\n\n        const eventName = 'productView';\n        const selected_options = product.get('options').filter(function(option) {\n            return option.get('value') && option.get('value').label;\n        });\n        const price = product.getPrice();\n        const result = this.findCategoryAndListInDataLayer(product);\n        const eventData = {\n            event: eventName,\n            ecommerce: {\n                detail: {\n                    actionField: {\n                        list: item.get('list') || (result ? result.list : '')\n                    },\n                    products: [\n                        {\n                            name: item.get('_name'),\n                            sku: product.getSku(),\n                            id: product.getSku(),\n                            category: item.get('category') || (result ? result.category : ''), // as we do not support categories this is just the url\n                            variant: _.map(selected_options, function(option: any) {\n                                return option.get('value').label;\n                            }).join(', '),\n                            price: (price.price ? price.price : 0).toFixed(2)\n                        }\n                    ]\n                }\n            },\n            page: this.getCategory()\n        };\n\n        this.item = null;\n\n        // Triggers a Backbone.Event so others can subscribe to this event and add/replace data before is send it to Google Tag Manager\n        Tracker.trigger(eventName, eventData, item);\n        this.pushData(eventData);\n\n        return this;\n    },\n\n    // @method resetTracker Cleans all dataLayer values\n    // @return {Void}\n    resetTracker: function() {\n        if (win.google_tag_manager) {\n            win.google_tag_manager[this.configuration.id].dataLayer.reset();\n        } else {\n            win[this.configuration.dataLayerName].push({\n                event: 'dataLayerReset',\n                data: undefined,\n                eventCallback: undefined\n            });\n        }\n    },\n\n    // @method pushData\n    // @param {Object} data\n    // @return {Void}\n    pushData: function(data) {\n        const data_layer = win[this.configuration.dataLayerName];\n\n        this.win = win;\n\n        this.debouncedData = this.debouncedData || [];\n\n        data_layer.push(data);\n        this.debouncedData.push(data);\n\n        if (!this.data_layer_loaded) {\n            this.loadDataLayerRecord(win);\n        } else {\n            if (!this.saveEvent) {\n                this.saveEvent = _.debounce(\n                    _.bind(function() {\n                        this.model.saveEvent(this.debouncedData);\n                        this.debouncedData = null;\n                    }, this),\n                    200\n                );\n            }\n            this.saveEvent();\n        }\n    },\n\n    // @method getCategory\n    // @return {String}\n    getCategory: function() {\n        const options = Utils.parseUrlOptions((<any>Backbone.history).fragment);\n        const page = options.page || '';\n\n        return '/' + (<any>Backbone.history).fragment.split('?')[0] + (page ? '?page=' + page : '');\n    },\n\n    // @method addCrossDomainParameters\n    // [Decorating HTML Links](https://developers.google.com/analytics/devgiddes/collection/analyticsjs/cross-domain#decoratelinks)\n    // @param {string} url\n    // @return {String} url\n    addCrossDomainParameters: function(url) {\n        // We only need to add the parameters if the URL we are trying to go\n        // is not a sub domain of the tracking domain\n        if (_.isString(url)) {\n            win.ga(function(tracker) {\n                win.linker = win.linker || new win.gaplugins.Linker(tracker || win.ga.getAll()[0]);\n                const track_url = win.linker.decorate(url);\n\n                // This validation is due to Tracking Blockers overriding the default analytics methods\n                if (typeof track_url === 'string') {\n                    url = track_url;\n                }\n            });\n        }\n\n        return url;\n    },\n\n    // @method loadScript\n    // @return {jQuery.Promise|Void}\n    loadScript: function() {\n        return jQuery.getScript(\n            '//www.googletagmanager.com/gtm.js?id=' +\n                this.configuration.id +\n                '&l=' +\n                this.configuration.dataLayerName\n        );\n    },\n\n    loadDataLayerRecord: function(win) {\n        if (!this.data_layer_loading && !this.data_layer_loaded) {\n            const self = this;\n            let gid = win.ga && win.ga.getAll && win.ga.getAll()[0].get('_gid');\n\n            this.data_layer_loading = true;\n\n            if (!gid && Cookies.get('_gid')) {\n                gid = Cookies.get('_gid')\n                    .split('.')\n                    .slice(2, 4)\n                    .join('.');\n            }\n\n            if (gid) {\n                this.model\n                    .getDataLayer({\n                        id: gid,\n                        events: win[this.configuration.dataLayerName]\n                    })\n                    .done(function() {\n                        self.data_layer_loaded = true;\n                    });\n            } else {\n                this.data_layer_loading = false;\n            }\n        }\n    },\n    // @method mountToApp\n    // @param {ApplicationSkeleton} application\n    // @return {Void}\n    mountToApp: function(application) {\n        this.configuration = Configuration.get('tracking.googleTagManager');\n\n        if (!this.configuration || !this.configuration.id || SC.isPageGenerator()) return;\n\n        this.configuration.dataLayerName = this.configuration.dataLayerName || 'dataLayer';\n\n        win[this.configuration.dataLayerName] = [];\n\n        const layout = application.getLayout();\n\n        // Install Standard Navigation Plugins\n        layout.mouseDown.install({\n            name: 'googleTagManagerStandardNavigation',\n            priority: 20,\n            execute: function(e) {\n                return GoogleTagManagerNavigationHelper.mouseDownNavigation(layout, e);\n            }\n        });\n\n        this.model = new GoogleTagManagerModel();\n\n        win[this.configuration.dataLayerName].push({\n            'gtm.start': new Date().getTime(),\n            event: 'gtm.js'\n        });\n\n        // Please keep this statement here or the first pageView on site load\n        // will not be triggered (ApplicationSkeleton.Layout._showContent)\n        Tracker.getInstance().trackers.push(GoogleTagManager);\n\n        // the analytics script is only loaded if we are on a browser\n        application.getLayout().once('afterAppendView', function() {\n            GoogleTagManager.loadScript().fail(function(jqXhr) {\n                jqXhr.preventDefault = true;\n                console.warn('Google Tag Manager was unable to load');\n            });\n        });\n    }\n};\n\nexport = GoogleTagManager;\n"]}