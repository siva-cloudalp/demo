{"version":3,"sources":["SocialSharing.ts"],"names":[],"mappings":"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","file":"SocialSharing.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"SocialSharing\"/>\n\nimport * as _ from 'underscore';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { Configuration } from '../../../Commons/Utilities/JavaScript/Configuration';\n\nimport PluginContainer = require('../../../Commons/PluginContainer/JavaScript/PluginContainer');\nimport BrowseView = require('../../../Commons/Facets/JavaScript/Facets.Browse.View');\nimport ProductDetailsFullView = require('../../ProductDetails/JavaScript/ProductDetails.Full.View');\n\n// @class SocialSharing Responsible of showing social\n// sharing widgets in a page. It consists on plugin\n// containers and each plugin takes care of implementing\n// a particular social network. There are two plugin\n// containers one for hooking into afterAppendView and other for afterAppendToDom\n// @extends ApplicationModule\nconst SocialSharing: any = {\n    excludeFromMyAccount: true,\n    // @method getPopupOptionsStringFromObject\n    // {translates: \"this\", to: \"\"} to translates=this,to=\n    getPopupOptionsStringFromObject: function(popup_options) {\n        let popup_options_string = '';\n\n        _.each(popup_options, function(value, name) {\n            popup_options_string += ',' + name + '=' + value;\n        });\n\n        // the substring is to get rid of the leading coma\n        return popup_options_string.substring(1);\n    },\n\n    // @method setMetaTagsByConfiguration\n    setMetaTagsByConfiguration: function(self, meta_tag_configuration) {\n        _.each(meta_tag_configuration, function(fn: Function, name) {\n            const content = fn(self);\n\n            jQuery('<meta />', {\n                property: name,\n                content: content || ''\n            }).appendTo(jQuery('head'));\n        });\n    },\n\n    // @method setLinTagsByConfiguration\n    setLinkTagsByConfiguration: function(self, link_tag_configuration) {\n        _.each(link_tag_configuration, function(fn: Function, rel) {\n            const href = fn(self);\n\n            if (href) {\n                jQuery('<link />', {\n                    rel: rel,\n                    href: href\n                }).appendTo(jQuery('head'));\n            }\n        });\n    },\n\n    // @method clearMetaTagsByConfiguration\n    clearMetaTagsByConfiguration: function(meta_tag_configuration) {\n        let meta_tag;\n\n        _.each(meta_tag_configuration, function(fn, name) {\n            meta_tag = jQuery('meta[name=\"' + name + '\"]');\n            meta_tag && meta_tag.remove();\n        });\n    },\n\n    // @method clearLinkTagsByConfiguration\n    clearLinkTagsByConfiguration: function(self, link_tag_configuration) {\n        let link_tag;\n\n        _.each(link_tag_configuration, function(fn: Function, rel) {\n            if (fn(self)) {\n                link_tag = jQuery('link[rel=\"' + rel + '\"]');\n                link_tag && link_tag.remove();\n            }\n        });\n    },\n\n    // @method setMetaTags Based on the meta tags config\n    setMetaTags: function() {\n        const self = this;\n        const application = this.getApplication();\n        const current_view = application.getLayout().currentView;\n        const meta_tag_mapping_og = Configuration.metaTagMappingOg;\n        const meta_tag_mapping_twitter_product_card =\n            Configuration.metaTagMappingTwitterProductCard;\n        const meta_tag_mapping_twitter_gallery_card =\n            Configuration.metaTagMappingTwitterGalleryCard;\n        const link_tag_google_plus_authorship = Configuration.linkTagGooglePlusAuthorship;\n\n        // Clear meta tags if required\n        this.clearMetaTagsByConfiguration(meta_tag_mapping_og);\n        this.clearMetaTagsByConfiguration(meta_tag_mapping_twitter_product_card);\n        this.clearMetaTagsByConfiguration(meta_tag_mapping_twitter_gallery_card);\n\n        if (current_view instanceof ProductDetailsFullView) {\n            this.setMetaTagsByConfiguration(self, meta_tag_mapping_og);\n            this.setMetaTagsByConfiguration(self, meta_tag_mapping_twitter_product_card);\n        } else if (current_view instanceof BrowseView) {\n            // Set meta tags for BrowseView\n            this.setMetaTagsByConfiguration(self, meta_tag_mapping_twitter_gallery_card);\n        }\n\n        // In all pages clear/set Google Plus authorship\n        this.clearLinkTagsByConfiguration(self, link_tag_google_plus_authorship);\n        this.setLinkTagsByConfiguration(self, link_tag_google_plus_authorship);\n    },\n\n    // @property {PluginContainer} afterAppendView\n    afterAppendView: new PluginContainer(),\n\n    // @property {PluginContainer} afterAppendToDom\n    afterAppendToDom: new PluginContainer(),\n\n    mountToApp: function(application) {\n        const self = this;\n        const layout = application.getLayout();\n\n        _.extend(layout, {\n            getPopupOptionsStringFromObject: this.getPopupOptionsStringFromObject,\n            setMetaTags: this.setMetaTags,\n            clearLinkTagsByConfiguration: this.clearLinkTagsByConfiguration,\n            clearMetaTagsByConfiguration: this.clearMetaTagsByConfiguration,\n            setLinkTagsByConfiguration: this.setLinkTagsByConfiguration,\n            setMetaTagsByConfiguration: this.setMetaTagsByConfiguration\n        });\n\n        layout.on('afterAppendView', function() {\n            this.$el.find('[data-type=\"social-share-icons\"]').empty();\n\n            this.setMetaTags();\n\n            if (!Utils.isPageGenerator()) {\n                self.afterAppendView.executeAll(application);\n            }\n        });\n\n        layout.on('afterAppendToDom', function() {\n            if (!Utils.isPageGenerator()) {\n                self.afterAppendToDom.executeAll(application);\n            }\n        });\n    }\n};\n\nexport = SocialSharing;\n"]}