{"version":3,"sources":["PickupInStore.StoreSelector.List.Row.View.ts"],"names":[],"mappings":"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","file":"PickupInStore.StoreSelector.List.Row.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n///<amd-module name=\"PickupInStore.StoreSelector.List.Row.View\"/>\n\nimport * as pickup_in_store_store_selector_list_row_tpl from 'pickup_in_store_store_selector_list_row.tpl';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\n\nimport LocationVenueDetailsView = require('../../Location.SCA/JavaScript/Location.VenueDetails.View');\nimport LiveOrderModel = require('../../../Commons/LiveOrder/JavaScript/LiveOrder.Model');\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\nimport Cookies = require('../../../Commons/Utilities/JavaScript/js.cookie');\n\nconst PickupInStoreStoreSelectorListRowView: any = BackboneView.extend({\n\t\t\t// @property {Function} template\n    template: pickup_in_store_store_selector_list_row_tpl,\n\n\t\t\t//@property {Object} events\n    events: {\n        'click [data-store-id]': 'selectStore',\n        'show.bs.dropdown': 'setFlyoutPosition'\n    },\n\n\t\t\t// @method initialize\n    initialize: function initialize(options) {\n\t\t\t\tthis.model = options.model;\n\t\t\t\tthis.product = options.product;\n\t\t\t\tthis.application = options.application;\n\t\t\t\tthis.source = options.source;\n    },\n\n\t\t\t// @property {ChildViews} childViews\n    childViews: {\n        'PickupInStore.StoreLocationInfo': function() {\n            const self = this;\n\n\t\t\t\t\treturn new LocationVenueDetailsView({\n                model: self.model,\n                application: self.application,\n                showAddress: false\n                    });\n                }\n    },\n\n\t\t\t// @method selectStore Sets up the store according to the user's selection\n    selectStore: function selectStore(e) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tthis.product.set('location', this.model);\n\t\t\t\tthis.product.set('fulfillmentChoice', 'pickup');\n\n        Cookies.set('myStore', this.model.get('internalid'), { expires: 365 });\n\n        if (this.source && this.source === 'cart') {\n            const self = this;\n            const cart_promise = LiveOrderModel.getInstance().updateLine(this.product);\n\n            cart_promise.done(function() {\n\t \t\t\t\t\tself.options.application.getLayout().closeModal();\n\t \t\t\t\t});\n\t\t\t\t}\n    },\n\n\t\t\t// @method setFlyoutPosition Sets flyout position regarding if it should be shown up or down\n    setFlyoutPosition: function setFlyoutPosition(e) {\n        const element_link = jQuery(e.relatedTarget);\n        const element_dropdown = element_link.siblings('[data-type=\"opening-hours-flyout\"]');\n        const element_parent_list = element_link.closest('[data-type=\"store-row\"]');\n        const bottom_distance =\n            element_parent_list.offset().top +\n            element_parent_list.height() -\n            (element_link.offset().top + element_link.height());\n\n        if (bottom_distance < element_dropdown.height()) {\n            element_dropdown.addClass(\n                'pickup-in-store-store-selector-list-row-opening-hours-flyout-content-up'\n            );\n        } else {\n            element_dropdown.removeClass(\n                'pickup-in-store-store-selector-list-row-opening-hours-flyout-content-up'\n            );\n\t\t\t\t}\n    },\n\n\t\t\t// @method getContext @return {PickupInStore.StoreSelector.List.Row.View.Context}\n    getContext: function getContext() {\n        const is_store_selected =\n            parseInt(this.product.get('location').get('internalid'), 10) ===\n            parseInt(this.model.get('internalid'), 10);\n\n\t\t\t\treturn {\n\t\t\t\t\t//@property {Object} location\n            location: this.model,\n\t\t\t\t\t//@property {Boolean} showStoreAddress\n            showStoreAddress: !!this.model.get('address1'),\n\t\t\t\t\t//@property {Boolean} areSetCityAndAddress\n            areSetCityAndAddress: !!this.model.get('address1') && !!this.model.get('city'),\n\t\t\t\t\t//@property {Boolean} showCity\n            showCity: !!this.model.get('city'),\n\t\t\t\t\t//@property {Boolean} showStoresState\n            showStoreState: !!this.model.get('state'),\n\t\t\t\t\t//@property {Boolean} showZipCode\n            showZipCode: !!this.model.get('zip'),\n\t\t\t\t\t//@property {Boolean} showServiceHours\n            showServiceHours:\n                !!this.model.get('servicehours') &&\n                !!this.model.get('servicehours').length &&\n                !!this.model.get('servicehours')[0].starttime,\n\t\t\t\t\t//@property {Boolean} showPhone\n            showPhone: !!this.model.get('phone'),\n\t\t\t\t\t//@property {Boolean} storeHasStock\n            storeHasStock: this.model.get('qtyavailableforstorepickup') > 0,\n\t\t\t\t\t//@property {Boolean} isStoreSelected\n            isStoreSelected: is_store_selected\n\t\t\t\t};\n\t\t\t}\n});\n\nexport = PickupInStoreStoreSelectorListRowView;\n"]}