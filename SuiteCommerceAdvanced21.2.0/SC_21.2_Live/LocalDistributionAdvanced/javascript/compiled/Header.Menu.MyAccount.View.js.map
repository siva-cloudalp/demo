{"version":3,"sources":["Header.Menu.MyAccount.View.ts"],"names":[],"mappings":"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","file":"Header.Menu.MyAccount.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Header.Menu.MyAccount.View\"/>\n/// <reference path=\"../../../Commons/Utilities/JavaScript/GlobalDeclarations.d.ts\" />\n\nimport * as _ from 'underscore';\nimport * as header_menu_myaccount_tpl from 'header_menu_myaccount.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport { MyAccountMenu } from './MyAccountMenu';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { Configuration } from '../../../Commons/Utilities/JavaScript/Configuration';\nimport { ProductListUtils } from '../../ProductListOnline/JavaScript/ProductList.Utils';\n\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\n\nexport = BackboneView.extend({\n    template: header_menu_myaccount_tpl,\n\n    initialize: function() {\n        this.productListModule = new ProductListUtils(this.options.application);\n\n        this.isProductListEnabled = this.productListModule.isProductListEnabled();\n        this.debounced_render = _.debounce(_.bind(this.render, this), 250);\n        if (this.isProductListEnabled) {\n            this.productListsPromise = this.productListModule.getProductListsPromise();\n        } else {\n            this.productListsPromise = jQuery.Deferred();\n        }\n        MyAccountMenu.getInstance()\n            .getEmitter()\n            .on('entriesChanged', this.debounced_render);\n    },\n\n    render: function() {\n        this._render();\n\n        if (this.$('.header-menu-myaccount-level3-orders').children().length === 1) {\n            // All children menu of the order section have been removed (lack of permissions)\n            // and only the back options is present\n            this.$('.header-menu-myaccount-level2-orders').remove();\n        }\n    },\n\n    destroy: function() {\n        MyAccountMenu.getInstance()\n            .getEmitter()\n            .off('entriesChanged', this.debounced_render);\n        this._destroy();\n    },\n\n    getContext: function() {\n        let product_list_collection: any = [];\n        if (this.isProductListEnabled) {\n            product_list_collection = this.productListModule.getProductLists();\n            product_list_collection.each(function(product_list) {\n                const url =\n                    'wishlist/' +\n                    (product_list.get('internalid') || 'tmpl_' + product_list.get('templateId'));\n                product_list.set('url', url, { silent: true });\n            });\n        }\n\n        const isSCISIntegrationEnabled = Configuration.get(\n            'siteSettings.isSCISIntegrationEnabled',\n            false\n        );\n\n        // @class Header.Profile.View.Context\n        return {\n            // @property {Boolean} isProductListsEnabled\n            isProductListsEnabled: !!this.isProductListEnabled,\n            // @property {Boolean} isSingleList\n            isSingleList: !!this.productListModule.isSingleList(),\n            // @property {Boolean} isCaseModuleEnabled\n            isCaseModuleEnabled: SC && SC.ENVIRONMENT && SC.ENVIRONMENT.casesManagementEnabled,\n            // @property {Boolean} productListsReady\n            productListsReady: this.productListsPromise.state() === 'resolved',\n            // @property {ProductList.Collection|Array} productLists\n            productLists: product_list_collection,\n\n            // @property {Boolean} purchasesPermissions\n            purchasesPermissions: isSCISIntegrationEnabled\n                ? 'transactions.tranFind.1,transactions.tranPurchases.1'\n                : 'transactions.tranFind.1,transactions.tranSalesOrd.1',\n\n            // @property {Boolean} returnsPermissions\n            returnsPermissions: isSCISIntegrationEnabled\n                ? 'transactions.tranFind.1,transactions.tranPurchasesReturns.1'\n                : 'transactions.tranFind.1,transactions.tranRtnAuth.1',\n            entries: MyAccountMenu.getInstance().getEntries(),\n            // @property {Boolean} showMyAccountMenu\n            showMyAccountMenu: !(\n                this.options.application.isStandalone() &&\n                Configuration.currentTouchpoint === 'customercenter' &&\n                !Utils.isPhoneDevice()\n            )\n        };\n    }\n});\n"]}