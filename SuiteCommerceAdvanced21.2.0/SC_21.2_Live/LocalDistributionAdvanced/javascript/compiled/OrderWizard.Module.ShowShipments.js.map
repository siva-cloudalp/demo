{"version":3,"sources":["OrderWizard.Module.ShowShipments.ts"],"names":[],"mappings":"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","file":"OrderWizard.Module.ShowShipments.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"OrderWizard.Module.ShowShipments\"/>\n/// <reference path=\"../../../Commons/Utilities/JavaScript/UnderscoreExtended.d.ts\" />\n\nimport * as order_wizard_showshipments_module_tpl from 'order_wizard_showshipments_module.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { WizardStepModule } from '../../Wizard/JavaScript/Wizard.StepModule';\n\nimport { AddressDetailsView } from '../../../Commons/Address/JavaScript/Address.Details.View';\nimport OrderWizardModuleCartItemsShip = require('../../OrderWizard.Module.CartItems/JavaScript/OrderWizard.Module.CartItems.Ship');\n\n// @class OrderWizard.Module.ShowShipments @extends Wizard.Module\nexport = WizardStepModule.extend({\n    // @property {Function} template\n    template: order_wizard_showshipments_module_tpl,\n\n    // @property {Array} errors\n    errors: ['ERR_NOT_SET_SHIPPING_METHODS', 'ERR_NOT_SET_SHIPPING_ADDRESS'],\n\n    shipMethodIsRequire: {\n        errorMessage: Utils.translate('Please select a delivery method'),\n        errorCode: 'ERR_NOT_SET_SHIPPING_METHODS'\n    },\n\n    shipAddressIsRequire: {\n        errorMessage: Utils.translate('Please select a shipping address'),\n        errorCode: 'ERR_NOT_SET_SHIPPING_ADDRESS'\n    },\n\n    // @property {Object} events\n    events: {\n        'change [data-action=\"change-delivery-options\"]': 'changeDeliveryOptions'\n    },\n\n    initialize: function() {\n        WizardStepModule.prototype.initialize.apply(this, arguments);\n\n        this.application = this.wizard.application;\n        this.options.application = this.wizard.application;\n\n        this.addressSource = this.wizard.options.profile.get('addresses');\n\n        this.wizard.model.on('ismultishiptoUpdated', this.render, this);\n        this.wizard.model.on('promocodeUpdated', this.render, this);\n        this.wizard.model.on('change', this.render, this);\n    },\n\n    destroy: function destroy() {\n        this.address && this.address.off('change', this.render, this);\n        return this._destroy();\n    },\n\n    // @method isActive\n    // @return {Boolean}\n    isActive: function(): boolean {\n        return !this.model.get('ismultishipto') && this.model.getIfThereAreDeliverableItems();\n    },\n\n    isValid: function() {\n        if (this.model.shippingAddressIsRequired()) {\n            if (!this.model.get('shipmethod')) {\n                return jQuery.Deferred().reject(this.shipMethodIsRequire);\n            }\n            if (!this.model.get('shipaddress')) {\n                return jQuery.Deferred().reject(this.shipAddressIsRequire);\n            }\n        }\n\n        return jQuery.Deferred().resolve();\n    },\n\n    // @method changeDeliveryOptions\n    changeDeliveryOptions: function(e) {\n        const value = this.$(e.target).val();\n        this.model.setShipMethod(value).always(() => {\n            this.render();\n            this.step.enableNavButtons();\n        });\n        this.step.disableNavButtons();\n    },\n\n    // @property {Object} childViews\n    childViews: {\n        'Shipping.Address': function() {\n            return new AddressDetailsView({\n                hideActions: !!this.options.hide_edit_address_button,\n                hideDefaults: true,\n                hideRemoveButton: true,\n                manage: 'shipaddress',\n                model: this.addressSource.get(this.model.get('shipaddress')),\n                hideSelector: true\n            });\n        },\n        'Items.Collection': function() {\n            return new OrderWizardModuleCartItemsShip({\n                wizard: this.wizard,\n                exclude_on_skip_step: true,\n                hide_address: true,\n                show_opened_accordion: Utils.isDesktopDevice(),\n                is_accordion_primary: true,\n                show_edit_cart_button: !this.options.hide_edit_cart_button,\n                show_headers: false,\n                show_mobile: true\n            });\n        }\n    },\n\n    // @method getContext\n    // @returns {OrderWizard.Module.ShowShipments.Context}\n    getContext: function() {\n        const self = this;\n        const selected_shipmethod = this.model\n            .get('shipmethods')\n            .findWhere({ internalid: this.model.get('shipmethod') });\n        const shipping_methods = this.model.get('shipmethods').map(function(shipmethod) {\n            return {\n                name: shipmethod.get('name'),\n                rate_formatted: shipmethod.get('rate_formatted'),\n                internalid: shipmethod.get('internalid'),\n                isActive: shipmethod.get('internalid') === self.model.get('shipmethod')\n            };\n        });\n        const address_source = this.addressSource.get(this.model.get('shipaddress'));\n\n        // @class OrderWizard.Module.ShowShipments.Context\n        return {\n            // @property {LiveOrder.Model} model\n            model: this.model,\n            // @property {Boolean} showShippingInformation Indicate if the shipmethod select should be shown or not. Used when in SST all items are non shippable\n            showShippingInformation: !!this.model.shippingAddressIsRequired(),\n            // @property {Boolean} showShippingAddress\n            showShippingAddress: !!address_source,\n            // @property {String} editUrl\n            editUrl: this.options.edit_url,\n            // @property {Boolean} showEditButton\n            showEditButton: !!this.options.edit_url,\n            // @property {Boolean}\n            showSelectedShipmethod: !!selected_shipmethod,\n            // @property {Object} selectedShipmethod\n            selectedShipmethod: selected_shipmethod,\n            // @property {Array} shippingMethods\n            shippingMethods: shipping_methods,\n            // @property {Boolean} showShippingMetod\n            showShippingMetod: !this.options.hideShippingMethod,\n            // @property {String} shippingAddress\n            shippingAddress: !!address_source && address_source.get('fullname')\n        };\n    }\n});\n"]}