{"version":3,"sources":["Cart.Detailed.View.ts"],"names":[],"mappings":"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","file":"Cart.Detailed.View.js","sourcesContent":["/*\n\t© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Cart.Detailed.View\"/>\n\nimport * as _ from 'underscore';\nimport '../../jQueryExtras/JavaScript/jQuery.scStickyButton';\nimport * as cart_detailed_tpl from 'cart_detailed.tpl';\nimport * as jQuery from '../../Core/JavaScript/jQuery';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\nimport { GlobalViewsMessageView } from '../../GlobalViews/JavaScript/GlobalViews.Message.View';\n\nimport BackboneCollectionView = require('../../Backbone.CollectionView/JavaScript/Backbone.CollectionView');\nimport BackboneFormView = require('../../Backbone.FormView/JavaScript/Backbone.FormView');\nimport CartLinesView = require('./Cart.Lines.View');\nimport CartLinesFreeView = require('./Cart.Lines.Free.View');\nimport CartPromocodeNotifications = require('./Cart.Promocode.Notifications.View');\nimport CartSummaryView = require('./Cart.Summary.View');\nimport CartItemSummaryView = require('./Cart.Item.Summary.View');\nimport CartItemActionsView = require('./Cart.Item.Actions.View');\nimport LiveOrderModel = require('../../LiveOrder/JavaScript/LiveOrder.Model');\nimport Tracker = require('../../Tracker/JavaScript/Tracker');\nimport Utils = require('../../Utilities/JavaScript/Utils.js');\nimport Backbone = require('../..//Utilities/JavaScript/backbone.custom');\nimport BackboneView = require('../../BackboneExtras/JavaScript/Backbone.View');\n\nlet colapsibles_states = {};\n\n// @class Cart.Detailed.View This is the Shopping Cart view @extends Backbone.View\nexport = BackboneView.extend({\n    // @property {Function} template\n    template: cart_detailed_tpl,\n\n    enhancedEcommercePage: true,\n\n    // @property {String} title\n    title: Utils.translate('Shopping Cart'),\n\n    // @property {String} page_header\n    page_header: Utils.translate('Shopping Cart'),\n\n    // @property {Object} attributes\n    attributes: {\n        id: 'Cart.Detailed.View',\n        'data-root-component-id': 'Cart.Detailed.View'\n    },\n\n    bindings: {\n        '[name=\"zip\"]': 'zip'\n    },\n\n    // @property {Object} events\n    events: {\n        'change [data-type=\"cart-item-quantity-input\"]': 'updateItemQuantityEvent',\n        'keypress [data-type=\"cart-item-quantity-input\"]': 'updateItemQuantityEvent',\n        'submit [data-action=\"update-quantity\"]': 'updateItemQuantityFormSubmit',\n        'click [data-action=\"remove-item\"]': 'removeItem',\n        'submit form[data-action=\"estimate-tax-ship\"]': 'estimateTaxShip',\n        'click [data-action=\"remove-shipping-address\"]': 'removeShippingAddress',\n        'click [data-touchpoint=\"checkout\"]': 'trackEvent',\n        'change [data-action=\"estimate-tax-ship-country\"]': 'changeCountry'\n    },\n\n    // @method initialize\n    // @param {Cart.Detailed.View.InitializeParameters} options\n    // @return {Void}\n    initialize: function(options) {\n        this.application = options.application;\n        this.showEstimated = false;\n        this.model = LiveOrderModel.getInstance();\n        this.options.model = this.model;\n        this.standalone = options.application.isStandalone();\n        BackboneFormView.add(this);\n\n        this.model.on('change', this.render, this);\n        this.model.get('lines').on('add remove', this.render, this);\n        this.model.on('LINE_ROLLBACK', this.render, this);\n        this.model.on('promocodeNotificationShown', this.removePromocodeNotification, this);\n\n        this.on('afterCompositeViewRender', this.resetColapsiblesState, this);\n        this.on('afterCompositeViewRender', this.initPlugins, this);\n\n        this.urlOptions = Utils.parseUrlOptions(\n            (options.routerArguments && options.routerArguments[0]) || ''\n        );\n    },\n\n    beforeShowContent: function() {\n        const self = this;\n        return LiveOrderModel.loadCart().done(function() {\n            Tracker.getInstance().trackPageviewForCart({\n                url: `/${Backbone.history.fragment}`,\n                items: self.model.get(\"lines\")\n            });\n        });\n    },\n\n    // @method getBreadcrumbPages\n    // @return {BreadcrumbPage}\n    getBreadcrumbPages: function() {\n        return { href: '/cart', text: Utils.translate('Shopping Cart') };\n    },\n\n    // @method initPlugins\n    // initialize plugins\n    initPlugins: function initPlugins() {\n        if (Configuration.get('siteSettings.sitetype') === 'ADVANCED') {\n            this.$('[data-action=\"sticky\"]').scStickyButton();\n        }\n        Utils.initBxSlider(\n            this.$('[data-type=\"carousel-items\"]'),\n            Configuration.get('bxSliderDefaults')\n        );\n    },\n\n    render: function render() {\n        this.storeColapsiblesState();\n        this._render();\n        return this;\n    },\n\n    // @method hideError\n    hideError: function hideError(selector) {\n        const el = selector\n            ? selector.find('[data-type=alert-placeholder]')\n            : this.$('[data-type=alert-placeholder]');\n        el.empty();\n    },\n\n    // @method showError\n    showError: function showError(message, line, error_details) {\n        let placeholder;\n        this.hideError();\n\n        if (line) {\n            // if we detect its a rolled back item, (this i an item that was deleted\n            // but the new options were not valid and was added back to it original state)\n            // We will move all the references to the new line id\n            if (error_details && error_details.status === 'LINE_ROLLBACK') {\n                const new_line_id = error_details.newLineId;\n                line.attr('id', new_line_id);\n                line.find('[name=\"internalid\"]').attr({\n                    id: `update-internalid-${new_line_id}`,\n                    value: new_line_id\n                });\n            }\n\n            placeholder = line.find('[data-type=\"alert-placeholder\"]');\n            this.hideError(line);\n        } else {\n            placeholder = this.$('[data-type=\"alert-placeholder\"]');\n            this.hideError();\n        }\n\n        // Finds or create the placeholder for the error message\n        if (!placeholder.length) {\n            placeholder = jQuery('<div/>', {\n                'data-type': 'alert-placeholder'\n            });\n            this.$el\n                .children()\n                .first()\n                .prepend(placeholder);\n        }\n\n        const global_view_message = new GlobalViewsMessageView({\n            message: message,\n            type: 'error',\n            closable: true\n        });\n\n        // Renders the error message and into the placeholder\n        placeholder.append(global_view_message.render().$el.html());\n\n        // Re Enables all posible disableded buttons of the line or the entire view\n        if (line) {\n            line.find(':disabled').attr('disabled', false);\n        } else {\n            this.$(':disabled').attr('disabled', false);\n        }\n    },\n\n    // @method validInputValue\n    // Check if the input[type=\"number\"] has empty string or NaN value\n    // input.val() == '' && validInput == false: NaN\n    // input.val() == '' && validInput == true: empty string\n    validInputValue: function(input) {\n        // html5 validation\n        if ((input.validity && !input.validity.valid) || input.value === '') {\n            return false;\n        }\n\n        // Fallback to browsers that don't yet support html5 input validation\n        return !isNaN(input.value);\n    },\n    updateItemQuantityEvent: function(e) {\n        if (e && e.type !== 'keypress') {\n            e.preventDefault();\n        }\n        const $form = this.getItemForm(e);\n        const options = (<any>$form).serializeObject();\n        this.$el\n            .find(`#${options.internalid} a`)\n            .attr('disabled', 'disabled')\n            .addClass('cart-item-link-disabled');\n        this.debouncedUpdateItemQuantity(e);\n    },\n    getItemForm: function(e) {\n        return jQuery(e.target).closest('form');\n    },\n\n    // @method updateItemQuantity\n    // Finds the item in the cart model, updates its quantity and saves the cart model\n    updateItemQuantity: function updateItemQuantity(e) {\n        const self = this;\n        const $form = this.getItemForm(e);\n        const options = (<any>$form).serializeObject();\n        let { internalid } = options;\n        let line = this.model.get('lines').get(internalid);\n        const $input = $form.find('[name=\"quantity\"]');\n        const validInput = this.validInputValue($input[0]);\n\n        if (!line || this.isRemoving) {\n            return;\n        }\n\n        if (!validInput || options.quantity) {\n            const new_quantity = parseInt(options.quantity, 10);\n            const item = line.get('item');\n            const min_quantity = item\n                ? item.get('_minimumQuantity', true)\n                : line.get('minimumquantity');\n            const max_quantity = item\n                ? item.get('_maximumQuantity', true)\n                : line.get('maximumquantity');\n            const current_quantity = parseInt(line.get('quantity'), 10);\n\n            let new_valid_quantity = new_quantity >= min_quantity ? new_quantity : min_quantity;\n            new_valid_quantity =\n                !!max_quantity && new_quantity > max_quantity\n                    ? max_quantity\n                    : new_quantity > min_quantity\n                    ? new_quantity\n                    : min_quantity;\n\n            $input.val(new_valid_quantity);\n\n            if (new_quantity !== current_quantity) {\n                $input.val(new_valid_quantity).prop('disabled', true);\n                line.set('quantity', new_valid_quantity);\n\n                const invalid = line.validate();\n\n                if (!invalid) {\n                    const update_promise = this.model.updateLine(line, true);\n                    this.disableElementsOnPromise(update_promise, `#${internalid} button`);\n\n                    update_promise\n                        .fail(function(jqXhr) {\n                            const result = JSON.parse(jqXhr.responseText);\n                            const { errorDetails } = result;\n\n                            if (errorDetails.newLineId) {\n                                internalid = errorDetails.newLineId;\n                                // we use the new line\n                                line = self.model.get('lines').get(internalid);\n                            }\n\n                            // revert quantity to the last quantity\n                            line.set('quantity', current_quantity);\n                            self.render();\n                        })\n                        .always(function() {\n                            $input.prop('disabled', false);\n                        });\n                } else {\n                    const placeholder = this.$(`#${internalid} [data-type=\"alert-placeholder\"]`);\n                    placeholder.empty();\n\n                    _.each(invalid, function(value) {\n                        const global_view_message = new GlobalViewsMessageView({\n                            message: value,\n                            type: 'error',\n                            closable: true\n                        });\n\n                        placeholder.append(global_view_message.render().$el.html());\n                    });\n\n                    $input.prop('disabled', false);\n                    line.set('quantity', current_quantity);\n                }\n            }\n        }\n    },\n\n    debouncedUpdateItemQuantity: _.debounce(function(e) {\n        this.updateItemQuantity(e);\n    }, 1000),\n\n    // @method updateItemQuantityFormSubmit\n    updateItemQuantityFormSubmit: function updateItemQuantityFormSubmit(e) {\n        e.preventDefault();\n        this.updateItemQuantity(e);\n    },\n\n    // @method removeItem\n    // handles the click event of the remove button\n    // removes the item from the cart model and saves it.\n    removeItem: function removeItem(e) {\n        const self = this;\n        const product = this.model.get('lines').get(this.$(e.target).data('internalid'));\n        const remove_promise = this.model.removeLine(product);\n        const internalid = product.get('internalid');\n\n        this.isRemoving = true;\n        this.disableElementsOnPromise(\n            remove_promise,\n            `article[id=\"${internalid}\"] a, article[id=\"${internalid}\"] button`\n        );\n\n        remove_promise.always(function() {\n            self.isRemoving = false;\n        });\n\n        return remove_promise;\n    },\n\n    // @method estimateTaxShip\n    // Sets a fake address with country and zip code based on the options.\n    estimateTaxShip: function estimateTaxShip(e) {\n        e.preventDefault();\n\n        const options = this.$(e.target).serializeObject();\n        const self = this;\n\n        const fake_address = {\n            zip: options.zip,\n            country: options.country,\n            internalid: null\n        };\n\n        this.model\n            .cancelableTrigger('before:LiveOrder.estimateShipping', fake_address)\n            .then(function() {\n                const address_internalid = `${fake_address.zip}-${fake_address.country}-null`;\n                fake_address.internalid = address_internalid;\n                self.model.get('addresses').push(fake_address);\n                self.model.set('shipaddress', address_internalid);\n                const promise = self.saveForm(e);\n\n                if (promise) {\n                    self.swapEstimationStatus();\n                }\n\n                promise.done(function(lines) {\n                    self.model.cancelableTrigger(\n                        'after:LiveOrder.estimateShipping',\n                        _.isUndefined(lines) ? false : lines\n                    );\n                });\n            });\n    },\n\n    // @method changeEstimationStatus\n    swapEstimationStatus: function swapEstimationStatus() {\n        this.showEstimated = !this.showEstimated;\n    },\n\n    // @method removeShippingAddress\n    // sets a fake null address so it gets removed by the backend\n    removeShippingAddress: function removeShippingAddress(e) {\n        const self = this;\n        const ship_address = self.model.get('addresses');\n\n        self.model\n            .cancelableTrigger('before:LiveOrder.clearEstimateShipping', ship_address)\n            .then(function() {\n                e.preventDefault();\n                self.swapEstimationStatus();\n\n                self.model.save({\n                    shipmethod: null,\n                    shipaddress: null\n                });\n\n                self.model.cancelableTrigger('after:LiveOrder.clearEstimateShipping', true);\n            });\n    },\n\n    // @method changeCountry\n    changeCountry: function changeCountry(e) {\n        e.preventDefault();\n\n        const options = this.$(e.target).serializeObject();\n        const AddressModel = this.model.get('addresses').model;\n\n        this.model\n            .get('addresses')\n            .add(new AddressModel({ country: options.country, internalid: options.country }));\n        this.model.set({ shipaddress: options.country });\n    },\n\n    // @method resetColapsiblesState\n    // @return {Void}\n    resetColapsiblesState: function resetColapsiblesState() {\n        const self = this;\n        _.each(colapsibles_states, function(is_in, element_selector) {\n            self.$(element_selector)\n                [is_in ? 'addClass' : 'removeClass']('in')\n                .css('height', is_in ? 'auto' : '0');\n        });\n    },\n\n    // @method storeColapsiblesState\n    // @return {Void}\n    storeColapsiblesState: function() {\n        this.$('.collapse').each(function(index, element) {\n            colapsibles_states[Utils.getFullPathForElement(element)] = jQuery(element).hasClass(\n                'in'\n            );\n        });\n    },\n\n    // @method removePromocodeNotification\n    // @param String promocode_id\n    // @return {Void}\n    removePromocodeNotification: function(promocode_id) {\n        const promocode: any = _.findWhere(this.model.get('promocodes'), {\n            internalid: promocode_id\n        });\n        delete promocode.notification;\n    },\n\n    trackEvent: function() {\n        Tracker.getInstance().trackProceedToCheckout();\n    },\n\n    destroy: function() {\n        colapsibles_states = {};\n\n        this.model.off('change', this.render, this);\n        this.model.get('lines').off('add remove', this.render, this);\n        this.model.off('LINE_ROLLBACK', this.render, this);\n\n        this.off('afterCompositeViewRender', this.resetColapsiblesState, this);\n        this.off('afterCompositeViewRender', this.initPlugins, this);\n\n        this._destroy();\n    },\n\n    // @property {ChildViews} childViews\n    childViews: {\n        'Cart.Summary': function() {\n            return new CartSummaryView({\n                model: this.model,\n                showEstimated: this.showEstimated,\n                application: this.application\n            });\n        },\n        'Item.ListNavigable': function() {\n            const lines = _.filter(this.model.get('lines').models || [], function(line: any) {\n                return line.get('free_gift') !== true;\n            });\n\n            return new BackboneCollectionView({\n                collection: lines,\n                viewsPerRow: 1,\n                childView: CartLinesView,\n                childViewOptions: {\n                    navigable: !this.standalone,\n                    application: this.application,\n                    SummaryView: CartItemSummaryView,\n                    ActionsView: CartItemActionsView,\n                    showAlert: false\n                }\n            });\n        },\n\n        'Promocode.Notifications': function() {\n            const promotions = _.filter(this.model.get('promocodes') || [], function(\n                promocode: any\n            ) {\n                return promocode.notification === true;\n            });\n\n            if (promotions.length) {\n                return new BackboneCollectionView({\n                    collection: promotions,\n                    viewsPerRow: 1,\n                    childView: CartPromocodeNotifications,\n                    childViewOptions: {\n                        parentModel: this.model\n                    }\n                });\n            }\n        },\n\n        'Item.FreeGift': function() {\n            const free_gifts = _.filter(this.model.get('lines').models || [], function(line: any) {\n                return line.get('free_gift') === true;\n            });\n\n            if (free_gifts.length) {\n                return new BackboneCollectionView({\n                    collection: free_gifts,\n                    viewsPerRow: 1,\n                    childView: CartLinesFreeView,\n                    childViewOptions: {\n                        navigable: true\n                    }\n                });\n            }\n        },\n\n        'FreeGift.Info': function() {\n            let message;\n            const free_gifts = _.filter(this.model.get('lines').models || [], function(line: any) {\n                return line.get('free_gift') === true;\n            });\n\n            if (free_gifts.length === 1) {\n                message = Utils.translate(\n                    'The following item is free but it may generate shipping costs.'\n                );\n            } else if (free_gifts.length > 1) {\n                message = Utils.translate(\n                    'The following items are free but they may generate shipping costs.'\n                );\n            }\n\n            if (message) {\n                return new GlobalViewsMessageView({\n                    message: message,\n                    type: 'info',\n                    closable: false\n                });\n            }\n        }\n    },\n\n    // @method getExtraChildrenOptions Overridable method used to add params to url to open the accordion\n    // @return {Cart.Detailed.View.ExtraChildrenOptions}\n    getExtraChildrenOptions: function() {\n        // @class Cart.Detailed.View.ExtraChildrenOptions\n        return {\n            // @property {String} urlOptions\n            urlOptions: this.urlOptions\n        };\n        // @class Cart.Detailed.View\n    },\n\n    // @method getContext @return {Cart.Detailed.View.Context}\n    getContext: function() {\n        const lines = this.model.get('lines');\n        const product_count = lines.length;\n        const item_count = _.reduce(\n            lines.models,\n            function(memo, line: any) {\n                return memo + line.get('quantity');\n            },\n            0\n        );\n        let product_and_items_count = '';\n\n        if (product_count === 1) {\n            if (item_count === 1) {\n                product_and_items_count = Utils.translate('1 Product, 1 Item');\n            } else {\n                product_and_items_count = Utils.translate('1 Product, $(0) Items', item_count);\n            }\n        } else if (item_count === 1) {\n            product_and_items_count = Utils.translate('$(0) Products, 1 Item', product_count);\n        } else {\n            product_and_items_count = Utils.translate(\n                '$(0) Products, $(1) Items',\n                product_count,\n                item_count\n            );\n        }\n\n        // @class Cart.Detailed.View.Context\n        return {\n            // @property {LiveOrder.Model} model\n            model: this.model,\n            // @property {Boolean} showLines\n            showLines: !!(lines && lines.length),\n            // @property {Orderline.Collection} lines\n            lines: lines,\n            // @property {String} productsAndItemsCount\n            productsAndItemsCount: product_and_items_count,\n            // @property {Number} productCount\n            productCount: product_count,\n            // @property {Number} itemCount\n            itemCount: item_count,\n            // @property {String} pageHeader\n            pageHeader: this.page_header,\n            // @property {String} isStandalone\n            isStandalone: this.standalone\n        };\n        // @class Cart.Detailed.View\n    }\n});\n"]}