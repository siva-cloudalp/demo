{"version":3,"sources":["OrderWizard.Module.PromocodeForm.ts"],"names":[],"mappings":"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","file":"OrderWizard.Module.PromocodeForm.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"OrderWizard.Module.PromocodeForm\"/>\n\nimport * as _ from 'underscore';\nimport * as order_wizard_promocodeform_tpl from 'order_wizard_promocodeform.tpl';\nimport { Configuration } from '../../SCA/JavaScript/Configuration';\nimport { WizardStepModule } from '../../Wizard/JavaScript/Wizard.StepModule';\n\nimport CartPromocodeFormView = require('../../../Commons/Cart/JavaScript/Cart.PromocodeForm.View');\n\n// @module OrderWizard.Module.PromocodeForm\n\n// @class OrderWizard.Module.PromocodeForm @extends Wizard.Module\nexport = WizardStepModule.extend({\n    // @property {Function} template\n    template: order_wizard_promocodeform_tpl,\n\n    // @property {Object} events\n    events: {\n        'shown [data-action=\"show-promo-code-container\"]': 'onPromocodeFormShown'\n    },\n\n    // @method initialize\n    initialize: function initialize() {\n        WizardStepModule.prototype.initialize.apply(this, arguments);\n\n        this.promocodeFormComponent = new CartPromocodeFormView({\n            model: this.wizard.model,\n            application: this.wizard.application\n        });\n\n        this.promocodeFormComponent.on(\n            'applying_promocode',\n            function() {\n                this.isSaving = true;\n                this.trigger('change_enable_continue', false);\n            },\n            this\n        );\n\n        // this.promocodeFormComponent.on('apply_promocode_finished', function ()\n        this.promocodeFormComponent.on(\n            'apply_promocode_failed',\n            function() {\n                this.isSaving = false;\n                this.trigger('change_enable_continue', true);\n            },\n            this\n        );\n\n        this.promocodeFormComponent.on(\n            'apply_promocode_succeeded',\n            function() {\n                this.isSaving = false;\n                this.trigger('change_enable_continue', true);\n                this.render();\n            },\n            this\n        );\n    },\n\n    // @method render\n    // @return {Void}\n    render: function render() {\n        if (this.state === 'present' && !this.isSaving) {\n            this._render();\n            this.trigger('ready', true);\n        }\n    },\n\n    // @method onPromocodeFormShown Handles the shown of promocode form\n    // @param {jQuery.Element} e\n    // @return {Void}\n    onPromocodeFormShown: function onPromocodeFormShown(e) {\n        this.$(e.target)\n            .find('input[name=\"promocode\"]')\n            .focus();\n    },\n    // @property {Object} childViews\n    childViews: {\n        'Cart.PromocodeForm': function() {\n            return this.promocodeFormComponent;\n        }\n    },\n\n    // @method getContext\n    // @returns {OrderWizard.Module.PromocodeForm.Context}\n    getContext: function getContext() {\n        const promocodes = this.wizard.model.get('promocodes') || [];\n        const promocodes_applied = _.filter(promocodes, function(promo: any) {\n            return (\n                (promo.isautoapplied == true && promo.isvalid == true) ||\n                promo.isautoapplied == false\n            );\n        });\n\n        // @class OrderWizard.Module.PromocodeForm.Context\n        return {\n            // @property {LiveOrder.Model} model\n            model: this.wizard.model,\n            // @property {Boolean} showPromocodeForm\n            showPromocodeForm:\n                Configuration.get('promocodes.allowMultiples', true) || !promocodes_applied.length\n        };\n        // @class OrderWizard.Module.PromocodeForm\n    }\n});\n"]}