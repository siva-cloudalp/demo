{"version":3,"sources":["Facets.Browse.View.ts"],"names":[],"mappings":"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","file":"Facets.Browse.View.js","sourcesContent":["/*\n\t© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Facets.Browse.View\"/>\n\nimport * as _ from 'underscore';\nimport '../../BootstrapExtras/JavaScript/Bootstrap.Slider';\nimport * as facets_facet_browse_tpl from 'facets_facet_browse.tpl';\nimport * as Utils from '../../Utilities/JavaScript/Utils';\nimport * as jQuery from '../../Core/JavaScript/jQuery';\nimport { CategoriesModel } from '../../Categories/JavaScript/Categories.Model';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\nimport { getAdditionalFields } from '../../Categories/JavaScript/Categories.Utils';\nimport { FacetsItemsCollectionView } from './FacetsItemsCollectionView';\nimport { GlobalViewsPaginationView } from '../../GlobalViews/JavaScript/GlobalViews.Pagination.View';\nimport { AjaxRequestsKiller } from '../../AjaxRequestsKiller/JavaScript/AjaxRequestsKiller';\nimport { ProfileModel } from '../../Profile/JavaScript/Profile.Model';\n\nimport LiveOrderModel = require('../../../Commons/LiveOrder/JavaScript/LiveOrder.Model');\nimport Categories = require('../../../Commons/Categories/JavaScript/Categories');\nimport CategoriesUtils = require('../../../Commons/Categories/JavaScript/Categories.Utils');\nimport FacetsHelper = require('./Facets.Helper');\nimport FacetsModel = require('./Facets.Model');\nimport FacetsFacetedNavigationView = require('./Facets.FacetedNavigation.View');\nimport FacetsFacetsDisplayView = require('./Facets.FacetsDisplay.View');\nimport FacetsItemListDisplaySelectorView = require('./Facets.ItemListDisplaySelector.View');\nimport FacetsItemListSortSelectorView = require('./Facets.ItemListSortSelector.View');\nimport FacetsItemListShowSelectorView = require('./Facets.ItemListShowSelector.View');\nimport FacetsEmptyView = require('./Facets.Empty.View');\nimport FacetsBrowseCategoryHeadingView = require('./Facets.Browse.CategoryHeading.View');\nimport FacetsCategoryCellView = require('./Facets.CategoryCell.View');\nimport FacetsFacetedNavigationItemView = require('../../../Commons/Facets/JavaScript/Facets.FacetedNavigationItem.View');\nimport FacetsFacetedNavigationItemCategoryView = require('./Facets.FacetedNavigationItemCategory.View');\nimport Tracker = require('../../../Commons/Tracker/JavaScript/Tracker');\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\nimport BackboneCollectionView = require('../../../Commons/Backbone.CollectionView/JavaScript/Backbone.CollectionView');\n\n// statuses stores the statuses of the collapsible facets\nconst statuses = ((<any>window).statuses = {});\n// collapsable_elements stores the statuses of the collapsible elements.\n// This store elements collapsable that are not facets\n/*\n\teach object should be of the form\n\t{\n\t\tselector: '' //id of the element that will collapsed/expanded\n\t,\tcollapsed: true/false\n\t}\n\t*/\nconst collapsable_elements = ((<any>window).collapsable_elements = {});\n\n// @class Facets.Browse.View View that handles the item list @extends Backbone.View\nexport = BackboneView.extend({\n    template: facets_facet_browse_tpl,\n\n    description: Utils.translate('This is a description'),\n\n    enhancedEcommercePage: true,\n\n    attributes: {\n        id: 'facet-browse',\n        class: 'view facet-browse',\n        'data-root-component-id': 'Facets.Browse.View'\n    },\n\n    events: {\n        'click [data-toggle=\"facet-navigation\"]': 'toggleFacetNavigation',\n        'click [data-action=\"toggle-filters\"]': 'toggleFilters',\n\n        'click [data-view=\"Facets.FacetsDisplay\"] a': '_gotoFacets',\n        'click [data-view=\"Facets.FacetedNavigation\"] a': '_gotoFacets',\n        'click [data-view=\"GlobalViews.Pagination\"] a': '_gotoPage',\n        'click [data-view=\"Facets.ItemListDisplaySelector\"] a': '_gotoDisplay',\n        'change [data-view=\"Facets.ItemListShowSelector\"] select': '_gotoShow',\n        'change [data-view=\"Facets.ItemListSortSelector\"] select': '_gotoOrder'\n    },\n\n    initialize(options) {\n        this.options = options;\n        this.application = options.application;\n        this.statuses = statuses;\n        this.collapsable_elements = collapsable_elements;\n        this.translatorConfig = this.application.translatorConfig;\n\n        const fullurl = Backbone.history.fragment;\n        const url = fullurl.split('?')[0];\n\n        this.categoriesTopLevelUrl = Categories.getTopLevelCategoriesUrlComponent();\n        this.isCategoryPage = !!_.find(this.categoriesTopLevelUrl, function(categoryUrl: string) {\n            categoryUrl = Utils.correctURL(categoryUrl);\n            const caturl = Utils.correctURL(url);\n\n            return caturl.indexOf(categoryUrl) === 0;\n        });\n\n        this.model = new FacetsModel();\n        this.translator = FacetsHelper.parseUrl(\n            fullurl,\n            this.translatorConfig,\n            this.isCategoryPage\n        );\n        this.router = this.constructor.router;\n\n        this.setOptionsTranslator();\n\n        this.model.options = {\n            data: this.translator.getApiParams(),\n            killerId: AjaxRequestsKiller.getKillerId(),\n            pageGeneratorPreload: true\n        };\n\n        if (this.isCategoryPage) {\n            const categoryModel = new CategoriesModel({\n                data: { fullurl: this.translator.getCategoryUrl() },\n                killerId: AjaxRequestsKiller.getKillerId()\n            });\n\n            this.model.set('category', categoryModel);\n        }\n\n        const { itemsDisplayOptions, resultsPerPage, sortOptions } = this.application.getConfig();\n        this.itemsDisplayOptions = Utils.deepCopy(itemsDisplayOptions);\n        this.resultsPerPage = Utils.deepCopy(resultsPerPage);\n        this.sortOptions = Utils.deepCopy(sortOptions);\n\n        _.each(this.resultsPerPage, function(perPage: any) {\n            perPage.id = String(perPage.items);\n        });\n\n        this.cart = LiveOrderModel.getInstance();\n\n        this.collapsable_elements['facet-header'] = this.collapsable_elements['facet-header'] || {\n            selector: 'this.collapsable_elements[\"facet-header\"]',\n            collapsed: false\n        };\n    },\n\n    beforeShowContent: function beforeShowContent() {\n        const promise = jQuery.Deferred();\n\n        // if prices aren't to be shown we take out price related facet\n        // and clean up the url\n        if (ProfileModel.getInstance().hidePrices()) {\n            this.translator = this.translator.cloneWithoutFacetId('onlinecustomerprice');\n        }\n\n        const self = this;\n        const models = [this.model];\n        const categoryModel = this.model.get('category');\n\n        if (categoryModel) {\n            models.push(categoryModel);\n        }\n\n        jQuery.when\n            .apply(null, _.invoke(models, 'fetch', {}))\n            .then(function(facetResponse) {\n                facetResponse = categoryModel ? facetResponse[0] : facetResponse;\n\n                if (facetResponse.corrections && facetResponse.corrections.length > 0) {\n                    const unaliased_url = self.router.unaliasUrl(null, facetResponse.corrections);\n                    promise.reject();\n\n                    if (SC.ENVIRONMENT.jsEnvironment === 'server') {\n                        nsglobal.statusCode = 301;\n                        nsglobal.location = `/${unaliased_url}`;\n                    } else {\n                        Backbone.history.navigate(`#${unaliased_url}`, { trigger: true });\n                    }\n                } else {\n                    self.translator.setLabelsFromFacets(self.model.get('facets') || []);\n                    promise.resolve();\n                }\n            })\n            .fail(function(jqXhr) {\n                promise.reject();\n\n                if (`${jqXhr.status}` === '404') {\n                    self.application.getLayout().notFound();\n                }\n            });\n\n        return promise;\n    },\n\n    // @method getPagination Return the info of the current options in the PLP\n    // @return {Object}\n    getPagination: function getPagination() {\n        return {\n            currentPage: this.translator.getOptionValue('page'),\n            pageCount: this.totalPages,\n            itemCount: this.model.get('total'),\n            pageSize: parseInt(this.translator.getOptionValue('show'), 10),\n            sorting: this.translator.getOptionValue('order'),\n            display: this.translator.getOptionValue('display'),\n            filters: this._getFacetsTranslator(this.translator),\n            searchText: this.translator.getOptionValue('keywords')\n        };\n    },\n\n    _setEvent: function _setEvent(options) {\n        this.setEvent(options.eventName, options.value).fail(function() {\n            if (options.event.currentTarget.nodeName === 'SELECT') {\n                options.event.currentTarget.value = options.valueOriginal;\n            }\n\n            options.event.stopPropagation();\n            options.event.preventDefault();\n        });\n    },\n\n    _getFacetsTranslator(translator) {\n        const facets = {};\n        const allFacets = translator.getAllFacets();\n\n        _.each(allFacets, function(facet: any) {\n            facets[facet.url] = facet.value;\n        });\n\n        return facets;\n    },\n\n    _gotoFacets: function _gotoFacet(e) {\n        const url = e.currentTarget.href;\n        const translator = FacetsHelper.parseUrl(\n            url,\n            this.translator.configuration,\n            !!this.model.get('category')\n        );\n\n        this._setEvent({\n            event: e,\n            eventName: 'Filters',\n            value: this._getFacetsTranslator(translator)\n        });\n    },\n\n    _gotoDisplay: function gotoDisplay(e) {\n        const default_value = _.find(this.itemsDisplayOptions, function(result: any) {\n            return result.isDefault;\n        }).id;\n        const display = Utils.getParameterByName(e.currentTarget.href, 'display') || default_value;\n\n        this._setEvent({ event: e, eventName: 'Display', value: display });\n    },\n\n    _gotoShow: function gotoShow(e) {\n        const original = this.translator.getUrl();\n        const default_value = _.find(this.resultsPerPage, function(result: any) {\n            return result.isDefault;\n        }).id;\n        const show =\n            parseInt(Utils.getParameterByName(e.currentTarget.value, 'show'), 10) || default_value;\n\n        this._setEvent({\n            event: e,\n            eventName: 'PageSize',\n            value: show,\n            valueOriginal: original\n        });\n    },\n\n    _gotoOrder: function gotoOrder(e) {\n        const original = this.translator.getUrl();\n        const default_value = _.find(this.sortOptions, function(result: any) {\n            return result.isDefault;\n        }).id;\n        const order = Utils.getParameterByName(e.currentTarget.value, 'order') || default_value;\n\n        this._setEvent({\n            event: e,\n            eventName: 'Sorting',\n            value: order,\n            valueOriginal: original\n        });\n    },\n\n    _gotoPage: function gotoPage(e) {\n        const order = parseInt(Utils.getParameterByName(e.currentTarget.href, 'page'), 10) || 1;\n\n        this._setEvent({ event: e, eventName: 'CurrentPage', value: order });\n    },\n\n    setEvent: function setEvent(event_name, value) {\n        const self = this;\n        const pagination = this.getPagination();\n\n        pagination[`set${event_name}`] = value;\n\n        return this.model\n            .cancelableTrigger(`before:FacetModel.set${event_name}`, pagination)\n            .done(function() {\n                Backbone.history.once('route', function() {\n                    const pagination = self.getPagination();\n\n                    pagination[event_name.charAt(0).toLowerCase() + event_name.slice(1)] = value;\n                    self.model.cancelableTrigger(`after:FacetModel.set${event_name}`, pagination);\n                });\n            });\n    },\n\n    // @method toggleFilters\n    toggleFilters(e) {\n        e.preventDefault();\n\n        const current_target = jQuery(e.currentTarget);\n\n        this.collapsable_elements['facet-header'].collapsed = !this.collapsable_elements[\n            'facet-header'\n        ].collapsed;\n\n        current_target.find('.filter-icon').toggleClass('icon-chevron-up');\n\n        current_target\n            .parents('[data-type=\"accordion\"]')\n            .toggleClass('well')\n            .toggleClass('facet-header-white-well')\n            .find('[data-type=\"accordion-body\"]')\n            .stop()\n            .slideToggle();\n    },\n\n    // @method getPath\n    getPath() {\n        const base_url = `${window.location.protocol}//${window.location.hostname}`;\n        let canonical = `/${Backbone.history.fragment.split('?')[0]}`;\n        if (this.model.get('category')) {\n            const category_canonical =\n                this.model.get('category').get('canonical') ||\n                this.model.get('category').get('fullurl');\n            if (canonical.indexOf(category_canonical) !== 0) {\n                canonical = category_canonical;\n            }\n        }\n\n        return (canonical.indexOf('/') === 0 ? base_url : '') + canonical;\n    },\n\n    // @method getCanonical\n    getCanonical() {\n        let canonical_url = this.getPath();\n        const current_page = this.translator.getOptionValue('page');\n\n        if (current_page > 1) {\n            canonical_url += `?page=${current_page}`;\n        }\n\n        return canonical_url;\n    },\n\n    // @method getRelPrev\n    getRelPrev() {\n        let previous_page_url = this.getPath();\n        const current_page = this.translator.getOptionValue('page');\n\n        if (current_page > 1) {\n            if (current_page === 2) {\n                return previous_page_url;\n            }\n\n            if (current_page > 2) {\n                return (previous_page_url += `?page=${current_page - 1}`);\n            }\n        }\n\n        return null;\n    },\n\n    // @method getRelNext\n    getRelNext() {\n        let next_page_url = this.getPath();\n        const current_page = this.translator.getOptionValue('page');\n\n        if (current_page < this.totalPages) {\n            return (next_page_url += `?page=${current_page + 1}`);\n        }\n\n        return null;\n    },\n\n    // @method formatFacetTitle: accepts a facet object and returns a string formatted to be displayed on the document's title according with user facet configuration property titleToken\n    // @param {Object} facet @returns {String}\n    formatFacetTitle(facet) {\n        const defaults = {\n            range: '$(2): $(0) to $(1)',\n            multi: '$(1): $(0)',\n            single: '$(1): $(0)'\n        };\n\n        if (!facet.config.titleToken) {\n            facet.config.titleToken = defaults[facet.config.behavior] || defaults.single;\n        }\n        if (_.isFunction(facet.config.titleToken)) {\n            return facet.config.titleToken(facet);\n        }\n        if (facet.config.behavior === 'range') {\n            return Utils.translate(\n                facet.config.titleToken,\n                facet.value.to,\n                facet.value.from,\n                facet.config.name\n            );\n        }\n        if (facet.config.behavior === 'multi') {\n            const buffer = [];\n            _.each(facet.value, function(val) {\n                buffer.push(val);\n            });\n            return Utils.translate(facet.config.titleToken, buffer.join(', '), facet.config.name);\n        }\n        const value = this.translator.getLabelForValue(facet.config.id, facet.value);\n\n        return Utils.translate(facet.config.titleToken, value, facet.config.name);\n    },\n\n    // @method getTitle overrides Backbone.Views.getTitle\n    getTitle() {\n        if (this.title) {\n            return this.title;\n        }\n\n        const { facets } = this.translator;\n        const category = this.model.get('category');\n        let title = category\n            ? category.get('pagetitle') || _.pluck(this.getBreadcrumbPages(), 'text').join(' > ')\n            : this.title;\n\n        if (facets && facets.length) {\n            const buffer = [];\n            let facet = null;\n\n            for (let i = 0; i < facets.length; i++) {\n                facet = facets[i];\n                buffer.push(this.formatFacetTitle(facet));\n\n                if (i < facets.length - 1) {\n                    buffer.push(facet.config.titleSeparator || ', ');\n                }\n            }\n\n            title = title ? `${title} - ` : '';\n\n            const { searchTitlePrefix, searchTitleSuffix } = this.application.getConfig();\n            title = (searchTitlePrefix || '') + buffer.join('') + (searchTitleSuffix || '');\n        } else if (this.translator.getOptionValue('keywords')) {\n            title = Utils.translate(\n                'Search results for \"$(0)\"',\n                this.translator.getOptionValue('keywords')\n            );\n        } else {\n            const { defaultSearchTitle } = this.application.getConfig();\n            title = title || defaultSearchTitle || '';\n        }\n\n        // Update the meta tag 'twitter:title'\n        this.setMetaTwitterTitle(title);\n\n        return title;\n    },\n\n    // @method getMetaDescription Get view's SEO attributes @return {String}\n    getMetaDescription() {\n        const category = this.model.get('category');\n\n        return (category && category.get('metadescription')) || this.metaDescription;\n    },\n\n    // @method getMetaKeywords @return {String}\n    getMetaKeywords() {\n        const category = this.model.get('category');\n\n        return (category && category.get('metakeywords')) || this.metaKeywords;\n    },\n\n    getAddToHead() {\n        const category = this.model.get('category');\n\n        return (category && category.get('addtohead')) || this.addToHead;\n    },\n\n    // @method setMetaTwitterTitle @param {Strnig}title\n    setMetaTwitterTitle(title) {\n        const seo_twitter_title = jQuery('meta[name=\"twitter:title\"]');\n        seo_twitter_title && seo_twitter_title.attr('content', title);\n    },\n\n    // @method setOptionsTranslator Set up the default option for displaying the facets.\n    // If we are in a small device, we've got to omit the 'grid' display option,\n    // for it is not showing in this kind of devices. We must change it for 'table'\n    setOptionsTranslator() {\n        if (this.translator.options.display === 'grid' && Utils.isPhoneDevice()) {\n            this.translator.options.display = 'table';\n        }\n    },\n\n    // @method showContent overrides Backbone.View.showContent to works with the title to find the proper wording and calls the layout.showContent\n    showContent() {\n        // If its a free text search it will work with the title\n        const self = this;\n        let keywords = this.translator.getOptionValue('keywords');\n        const resultCount = this.model.get('total');\n\n        if (keywords) {\n            keywords = decodeURIComponent(keywords);\n\n            if (resultCount > 0) {\n                this.subtitle =\n                    resultCount > 1\n                        ? Utils.translate('Results for \"$(0)\"', keywords)\n                        : Utils.translate('Result for \"$(0)\"', keywords);\n            } else {\n                this.subtitle = Utils.translate(\n                    'We couldn\\'t find any items that match \"$(0)\"',\n                    keywords\n                );\n            }\n        }\n\n        this.totalPages = Math.ceil(resultCount / this.translator.getOptionValue('show'));\n\n        return this.application\n            .getLayout()\n            .showContent(this)\n            .done(function() {\n                if ((<any>jQuery.fn).scPush) {\n                    self.$el.find('[data-action=\"pushable\"]').scPush({ target: 'tablet' });\n                }\n                });\n    },\n\n    render() {\n        let list_type = 'Facets';\n\n        if (this.model.get('category')) {\n            list_type = 'Category';\n        } else if (this.translator.getOptionValue('keywords')) {\n            list_type = 'Search';\n        }\n\n        Tracker.getInstance().trackProductList(this.model.get('items'), list_type);\n\n        this._render();\n    },\n\n    // @method getBreadcrumbPages\n    // It will generate an array suitable to pass it to the breadcrumb macro\n    // It looks in the category facet value\n    // @return {Array<Object>}\n    getBreadcrumbPages() {\n        const breadcrumb = [];\n\n        if (this.model.get('category')) {\n            const list = this.model.get('category').get('breadcrumb');\n            const self = this;\n\n            _.each(list, function(bread: any) {\n                breadcrumb.push({\n                    text: bread.name,\n                    href: bread.fullurl,\n                    additionalFields: getAdditionalFields(\n                        self.model.get('category').attributes,\n                        'categories.breadcrumb.fields'\n                    )\n                });\n            });\n\n            return breadcrumb;\n        }\n        if (this.translator.getOptionValue('keywords')) {\n            breadcrumb.push({\n                href: '#',\n                text: Utils.translate('Search Results')\n            });\n        } else {\n            breadcrumb.push({\n                href: this.application.translatorConfig.fallbackUrl\n                    ? `/${this.application.translatorConfig.fallbackUrl}`\n                    : '#',\n                text: Utils.translate('Shop')\n            });\n        }\n\n        return breadcrumb;\n    },\n\n    // @method toggleFacetNavigation Hides/Shows the facet navigation area\n    toggleFacetNavigation() {\n        this.$el.toggleClass('narrow-by');\n        this.toggleNavigationListener(this.$el.hasClass('narrow-by'));\n    },\n\n    // @method toggleNavigationListener\n    // adds/removes event listeners to the HTML to hide the facet navigation area\n    // @param {Boolean} isOn\n    toggleNavigationListener(isOn) {\n        const self = this;\n        let touch_started = null;\n\n        // turn listeners on\n        if (isOn) {\n            jQuery('html')\n                // we save the time when the touchstart happened\n                .on('touchstart.narrow-by', function() {\n                    touch_started = new Date().getTime();\n                })\n                // code for touchend and mousdown is the same\n                .on('touchend.narrow-by mousedown.narrow-by', function(e) {\n                    // if there wasn't a touch event, or the time difference between\n                    // touch start and touch end is less that 200 miliseconds\n                    // (this is to allow scrolling without closing the facet navigation area)\n                    if (!touch_started || new Date().getTime() - touch_started < 200) {\n                        const $target = jQuery(e.target);\n\n                        // if we are not touching the narrow by button or the facet navigation area\n                        if (\n                            !$target.closest('[data-toggle=\"facet-navigation\"]').length &&\n                            !$target.closest('#faceted-navigation').length\n                        ) {\n                            // we hide the navigation\n                            self.toggleFacetNavigation();\n                        }\n                    }\n                });\n        } else {\n            jQuery('html')\n                // if the navigation area is hidden, we remove the event listeners from the HTML\n                .off('mousedown.narrow-by touchstart.narrow-by touchend.narrow-by');\n        }\n    },\n\n    contextData: {\n        itemList() {\n            return Utils.deepCopy(this.model.get('items'));\n        },\n        category() {\n            return Utils.deepCopy(this.model.get('category'));\n        }\n    },\n\n    childViews: {\n        'Facets.FacetedNavigation': function(options) {\n            const exclude = _.map((options.excludeFacets || '').split(','), function(\n                facet_id_to_exclude: any\n            ) {\n                return String(facet_id_to_exclude).trim();\n            });\n            const has_categories = !!(this.category && this.category.categories);\n            const has_items = this.model.get('items').length;\n            const has_facets =\n                has_items && this.model.get('facets') && this.model.get('facets').length;\n            const applied_facets = this.translator.cloneWithoutFacetId('category').facets;\n            const has_applied_facets = applied_facets.length;\n\n            return new FacetsFacetedNavigationView({\n                categoryItemId: this.category && this.category.itemid,\n                clearAllFacetsLink: this.translator.cloneWithoutFacets().getUrl(),\n                hasCategories: has_categories,\n                hasItems: has_items,\n\n                // facets box is removed if don't find items\n                hasFacets: has_facets,\n\n                hasCategoriesAndFacets: has_categories && has_facets,\n\n                // Categories are not a real facet, so lets remove those\n                appliedFacets: applied_facets,\n\n                hasFacetsOrAppliedFacets: has_facets || has_applied_facets,\n\n                // ,\ttranslatorUrl: this.translator.getUrl()\n                translator: this.translator,\n\n                // ,\ttranslatorConfig: this.options.translatorConfig\n                facets: _.filter(this.model.get('facets'), function(facet: any) {\n                    return !_.contains(exclude, facet.id);\n                }),\n\n                totalProducts: this.model.get('total'),\n                keywords: this.translator.getOptionValue('keywords')\n            });\n        },\n\n        'Facets.FacetsDisplay': function() {\n            const facets = this.translator\n                .cloneWithoutFacetId('category')\n                .getAllFacets()\n                .sort(function(a, b) {\n                    return b.config.priority - a.config.priority;\n                });\n\n            return new FacetsFacetsDisplayView({\n                facets,\n                translator: this.translator\n            });\n        },\n\n        'Facets.ItemListDisplaySelector': function() {\n            return new FacetsItemListDisplaySelectorView({\n                configClasses: 'pull-right',\n                options: this.itemsDisplayOptions,\n                translator: this.translator\n            });\n        },\n\n        'Facets.ItemListSortSelector': function() {\n            return new FacetsItemListSortSelectorView({\n                options: this.sortOptions,\n                translator: this.translator\n            });\n        },\n        // Show 'XX products per page' View\n        'Facets.ItemListShowSelector': function() {\n            return new FacetsItemListShowSelectorView({\n                options: this.resultsPerPage,\n                translator: this.translator\n            });\n        },\n        // Extra Facet filter View\n        'Facets.FacetedNavigation.Item': function(options) {\n            const facet_config = this.translator.getFacetConfig(options.facetId);\n            const contructor_options: any = {\n                model: new Backbone.Model(\n                    _.findWhere(this.model.get('facets'), { id: options.facetId })\n                ),\n                translator: this.translator\n            };\n\n            if (facet_config.template) {\n                contructor_options.template = facet_config.template;\n            }\n\n            return new FacetsFacetedNavigationItemView(contructor_options);\n        },\n        'Facets.Items': function() {\n            const self = this;\n            const display_option: any = _.find(this.itemsDisplayOptions, function(option) {\n                return option.id === self.translator.getOptionValue('display');\n            });\n            return new FacetsItemsCollectionView({\n                application: this.application,\n                keywords: this.translator.getOptionValue('keywords'),\n                collection: this.model.get('items').models,\n                viewsPerRow: parseInt(display_option.columns, 10),\n                cellViewTemplate: display_option.template\n            });\n        },\n        'Facets.Items.Empty': function() {\n            return new FacetsEmptyView({\n                keywords: this.translator.getOptionValue('keywords')\n            });\n        },\n        'GlobalViews.Pagination': function() {\n            const { translator } = this;\n\n            return new GlobalViewsPaginationView(\n                _.extend(\n                    {\n                        currentPage: translator.getOptionValue('page'),\n                        totalPages: this.totalPages,\n                        pager(page) {\n                            return translator.cloneForOption('page', page).getUrl();\n                        }\n                    },\n                    Configuration.defaultPaginationSettings\n                )\n            );\n        },\n\n        'Facets.Browse.CategoryHeading': function() {\n            return new FacetsBrowseCategoryHeadingView({\n                model: this.model.get('category'),\n                showDescription:\n                    this.translator.cloneWithoutFacetId('category').getAllFacets().length === 0\n            });\n        },\n\n        'Facets.CategoryCells': function() {\n            console.log(this,\"facets-browes\");\n            \n            return new BackboneCollectionView({\n                childView: FacetsCategoryCellView,\n                collection: this.model.get('category')\n                    ? this.model.get('category').get('categories')\n                    : []\n            });\n        },\n\n        'Facets.CategorySidebar': function() {\n            return new FacetsFacetedNavigationItemCategoryView({\n                model: this.model.get('category'),\n                categoryUrl: this.translator.getCategoryUrl()\n            });\n        }\n    },\n\n    // @method getContext @returns {Facets.Browse.View.Context}\n    getContext() {\n        const hasSelectedFacets = this.translator.cloneWithoutFacetId('category').getAllFacets()\n            .length;\n        const hasSubcategories = this.model.get('category')\n            ? this.model.get('category').get('categories').length\n            : false;\n        const hasItems = this.model.get('items') && this.model.get('items').length > 0;\n\n        // @class Facets.Browse.View.Context\n        return {\n            // @property {Number} total\n            total: this.model.get('total'),\n            // @property {Boolean} isTotalProductsOne\n            isTotalProductsOne: this.model.get('total') === 1,\n            // @property {String} title\n            title: this.getTitle(),\n            // @property {Boolean} hasItemsAndFacets\n            hasItemsAndFacets: !!(\n                hasItems &&\n                this.model.get('facets') &&\n                this.model.get('facets').length\n            ),\n            // @property {Boolean} collapseHeader\n            collapseHeader: !!this.collapsable_elements['facet-header'].collapsed,\n            // @property {String} keywords\n            keywords: this.translator.getOptionValue('keywords'),\n            // @property {Boolean} showResults\n            showResults: _.isNull(this.translator.getOptionValue('keywords'))\n                ? true\n                : this.model.get('total') > 0,\n            // @property {Boolean} isEmptyList\n            isEmptyList: this.model.get('total') <= 0,\n\n            // @property {Boolean} isCategory\n            isCategory: !!this.model.get('category'),\n\n            // @property {Boolean} showItems\n            showItems:\n                hasItems ||\n                (!hasItems && hasSelectedFacets) ||\n                !(!hasItems && !hasSelectedFacets && hasSubcategories)\n        };\n        // @class Facets.Browse.View\n    }\n});\n"]}