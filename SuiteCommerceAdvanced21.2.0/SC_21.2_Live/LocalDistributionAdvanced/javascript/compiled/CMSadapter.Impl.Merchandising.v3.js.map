{"version":3,"sources":["CMSadapter.Impl.Merchandising.v3.ts"],"names":[],"mappings":"AAAA;;;;;EAKE;;;IAQF;;;;MAIE;IAEF,IAAM,4BAA4B,GAAG,UAAS,WAAW,EAAE,GAAG;QAC1D,2BAA2B,CAAC,IAAI,CAAC,IAAI,EAAE,WAAW,EAAE,GAAG,CAAC,CAAC;IAC7D,CAAC,CAAC;IAEF,4BAA4B,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,2BAA2B,CAAC,SAAS,CAAC,CAAC;IAE9F,4BAA4B,CAAC,SAAS,CAAC,YAAY,GAAG,SAAS,YAAY;QACvE,oEAAoE;QACpE,IAAM,IAAI,GAAG,IAAI,CAAC;QAElB,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,gBAAgB,EAAE,UAAS,OAAO;YAC1C,IAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;YACnD,IAAM,OAAO,GAAG,EAAE,CAAC;YAEnB,IAAI,IAAI,EAAE;gBACN,IAAI,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,UAAS,KAAK;oBAC/B,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,UAAS,IAAS;wBAC5B,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;4BACnC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;yBACtC;oBACL,CAAC,CAAC,CAAC;oBAEH,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;gBAC7B,CAAC,CAAC,CAAC;aACN;iBAAM;gBACH,OAAO,CAAC,OAAO,EAAE,CAAC;aACrB;QACL,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,gBAAgB,EAAE,UAAS,OAAO;YAC1C,IAAM,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;YACjD,IAAM,OAAO,GAAG,EAAE,CAAC;YAEnB,IAAI,GAAG,EAAE;gBACL,IAAM,OAAO,GAAG,GAAG,CAAC,WAAW,EAAE,CAAC;gBAElC,IAAI,OAAO,IAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE;oBACpD,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;iBACzC;aACJ;YAED,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC;IACP,CAAC,CAAC;IAEF,OAAS,4BAA4B,CAAC","file":"CMSadapter.Impl.Merchandising.v3.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"CMSadapter.Impl.Merchandising.v3\"/>\n\nimport * as _ from 'underscore';\n\nimport CMSadapterImplMerchandising = require('./CMSadapter.Impl.Merchandising');\n\n/*\n@module CMSadapter\n\n@class CMSadapter.Impl.Merchandising.v3\n*/\n\nconst CMSadapterImplMerchandising3 = function(application, CMS) {\n    CMSadapterImplMerchandising.call(this, application, CMS);\n};\n\nCMSadapterImplMerchandising3.prototype = Object.create(CMSadapterImplMerchandising.prototype);\n\nCMSadapterImplMerchandising3.prototype.listenForCMS = function listenForCMS() {\n    // CMS listeners - CMS tells us to do something, could fire anytime.\n    const self = this;\n\n    self.CMS.on('cart:items:get', function(promise) {\n        const cart = self.application.getComponent('Cart');\n        const linesId = [];\n\n        if (cart) {\n            cart.getLines().then(function(lines) {\n                _.each(lines, function(line: any) {\n                    if (line.item && line.item.internalid) {\n                        linesId.push(line.item.internalid);\n                    }\n                });\n\n                promise.resolve(linesId);\n            });\n        } else {\n            promise.resolve();\n        }\n    });\n\n    self.CMS.on('page:items:get', function(promise) {\n        const pdp = self.application.getComponent('PDP');\n        const linesId = [];\n\n        if (pdp) {\n            const product = pdp.getItemInfo();\n\n            if (product && product.item && product.item.internalid) {\n                linesId.push(product.item.internalid);\n            }\n        }\n\n        promise.resolve(linesId);\n    });\n};\n\nexport = CMSadapterImplMerchandising3;\n"]}