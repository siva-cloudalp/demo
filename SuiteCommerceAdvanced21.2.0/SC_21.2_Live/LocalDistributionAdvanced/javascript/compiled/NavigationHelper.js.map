{"version":3,"sources":["NavigationHelper.ts"],"names":[],"mappings":"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","file":"NavigationHelper.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"NavigationHelper\"/>\n\nimport * as _ from 'underscore';\nimport * as Utils from '../../Utilities/JavaScript/Utils';\nimport * as jQuery from '../../Core/JavaScript/jQuery';\n\nimport Session = require('../../Session/JavaScript/Session');\nimport PluginContainer = require('../../PluginContainer/JavaScript/PluginContainer');\n\n// NavigationHelper intersect all clicks on a elements and computes what to do, if navigate using backbone or navigate away\n// support data-touchpoint for indicating a target touchpoint by name and data-keep-options for keeping current url options in the link.\n\n// @class NavigationHelper uses different PluginContainer, each for handling different types of user events globally.\n// itself is a Plugin container where specific tasks (like handling data-touchpoint links or open links in new modals are implemented by specific plugins)\n// Basically each registered plugin will have the opportunity of performing some operation over the link's href attribute\n// @extends ApplicationModule\nconst NavigationHelper: any = {\n    mountToApp: function(application) {\n        // @module ApplicationSkeleton @class ApplicationSkeleton.Layout\n        const Layout = application.getLayout();\n\n        _.extend(Layout, {\n            // @method isTargetBlank Indicate if the target link of the event e is blank or not. IMPORTANT: This functions does NOT take into a account the button press\n            // @param {jQuery.Event} e jQuery event\n            // @returns {Boolean} result\n            isTargetBlank: function(e) {\n                return (\n                    e.ctrlKey || e.metaKey || jQuery(e.currentTarget).attr('target') === '_blank'\n                );\n            },\n\n            // @method getUrl Returns the target URL of the clicked object from the navigation context\n            // @param {NavigationContext} context\n            // @return {String}\n            getUrl: function(context) {\n                if (Utils.oldIE()) {\n                    return context.target_data.href;\n                }\n\n                return context.target_href;\n            },\n\n            // @method setUrl Set the URL to the jQuery element taking into account backward compatibility con old IE browsers\n            // @param {jQuery} $element\n            // @param {String} url\n            // @return {Void}\n            setUrl: function($element, url) {\n                $element.attr('href', url);\n\n                if (Utils.oldIE()) {\n                    $element.data('href', url);\n                }\n            },\n\n            // @method generateNavigationContext Generate the navigation context object\n            // @param {jQuery.Event} e jQuery event param\n            // @return {NavigationContext}\n            generateNavigationContext: function(e) {\n                const $target = jQuery(e.currentTarget);\n                const touchpoints = Session.get('touchpoints');\n                const target_data = $target.data();\n                const target_touchpoint =\n                    (touchpoints ? touchpoints[target_data.touchpoint] : '') || '';\n                const { hashtag } = target_data;\n                const target_href = $target.attr('href');\n                const clean_hashtag = hashtag && hashtag.replace('#', '');\n\n                // @class NavigationContext\n                return {\n                    // @property {Object} target_data An object where each property is one of the data attributes of the target element\n                    target_data: target_data,\n                    // @property {String} target_href\n                    target_href: target_href,\n                    // @property {String} target_touchpoint\n                    target_touchpoint: target_touchpoint,\n                    // @property {String} original_touchpoint\n                    original_touchpoint: target_data.touchpoint,\n                    // @property {String} hashtag\n                    hashtag: hashtag,\n                    // @property {String} url\n                    url: '',\n                    // @property {String} clean_hashtag\n                    clean_hashtag: clean_hashtag,\n                    // @property {jQuery} $target\n                    $target: $target\n                };\n                // @class NavigationHelper\n            },\n\n            /// //////////////////////////////\n            //\t\tPLUGINS DEFINITION\n            /// //////////////////////////////\n\n            // @property {PluginContainer} touchStart plugin container that handles the global touch start event\n            touchStart: new PluginContainer(),\n            // @property {PluginContainer} touchMove plugin container that handles the global touch move event\n            touchMove: new PluginContainer(),\n            // @property {PluginContainer} mouseDown plugin container that handles the global mouseDown event\n            mouseDown: new PluginContainer(),\n            // @property {PluginContainer} click plugin container that handles the global click event\n            click: new PluginContainer(),\n            // @property {PluginContainer} touchEnd plugin container that handles the global touchEnd event\n            touchEnd: new PluginContainer(),\n            // @property {PluginContainer} mouseUp plugin container that handles the global mouseUp event\n            mouseUp: new PluginContainer(),\n\n            // @method executeTouchStart execute all touchStart plugins\n            // @param {jQuery.Event} e\n            executeTouchStart: function(e) {\n                this.touchStart.executeAll(e);\n            },\n\n            // @method executeTouchStart execute all touchMove plugins\n            // @param {jQuery.Event} e\n            executeTouchMove: function(e) {\n                this.touchMove.executeAll(e);\n            },\n\n            // @method executeTouchStart execute all mouseUp plugins\n            // @param {jQuery.Event} e\n            executeMouseUp: function(e) {\n                this.mouseUp.executeAll(e);\n            },\n\n            // @method executeTouchStart execute all touchEnd plugins\n            // @param {jQuery.Event} e\n            executeTouchEnd: function(e) {\n                this.touchEnd.executeAll(e);\n            },\n\n            // @method executeTouchStart execute all mouseDown plugins\n            // @param {jQuery.Event} e\n            executeMouseDown: function(e) {\n                this.mouseDown.executeAll(e);\n            },\n\n            // @method executeTouchStart execute all click plugins\n            // @param {jQuery.Event} e\n            executeClick: function(e) {\n                if (!(this.$(e.target).closest('.bx-viewport').length && e.isTrigger)) {\n                    // ISSUE 631704. this condition prevent bx slider to trigger \n                    // clicks after touchend and pointerup events.\n                    // TODO: remove this condition and remove click trigger at the end\n                    // of touchend handler of bxslider, only after we get ownership of this library\n                    this.click.executeAll(e);\n                }\n            }\n        });\n\n        // Adds event listeners to the layout\n        _.extend(Layout.events, {\n            // touchpoints, this needs to be before the other click event, so they are computed early\n            'touchstart a:not([data-navigation=\"ignore-click\"])': 'executeTouchStart',\n            'mousedown a:not([data-navigation=\"ignore-click\"])': 'executeMouseDown',\n            'click a:not([data-navigation=\"ignore-click\"])': 'executeClick',\n            'mouseup a:not([data-navigation=\"ignore-click\"])': 'executeMouseUp',\n            'touchend a:not([data-navigation=\"ignore-click\"])': 'executeTouchEnd',\n            'touchmove a:not([data-navigation=\"ignore-click\"])': 'executeTouchMove'\n        });\n\n        // Default Navigation Plugins\n        Layout.touchMove.install({\n            name: 'detectTouchMovement',\n            priority: 10,\n            execute: function(e) {\n                if (jQuery(e.currentTarget).data('touchpoint')) {\n                    Layout.isTouchMoveEvent = true;\n                }\n                return e;\n            }\n        });\n    }\n};\n\nexport = NavigationHelper;\n"]}