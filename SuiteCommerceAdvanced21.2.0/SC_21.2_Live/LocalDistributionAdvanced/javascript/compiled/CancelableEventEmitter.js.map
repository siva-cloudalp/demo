{"version":3,"sources":["CancelableEventEmitter.ts"],"names":[],"mappings":"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","file":"CancelableEventEmitter.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"CancelableEventEmitter\"/>\n// @Typescript-partial\n\nimport * as _ from 'underscore';\nimport * as jQuery from './jQuery';\nimport { deepCopy } from '../../Utilities/JavaScript/Utils';\n\ntype FunctionPropertyNames<T> = { [K in keyof T]: T[K] extends Function ? K : never }[keyof T];\ntype FunctionProperties<T> = Pick<T, FunctionPropertyNames<T>>;\n\nexport interface CancelableEventEmitter<T extends FunctionProperties<T>> {\n    on<E extends FunctionPropertyNames<T>>(eventName: E, callback: T[E]);\n    emit<E extends FunctionPropertyNames<T>>(\n        eventName: E,\n        ...args: Parameters<T[E]>\n    ): JQuery.Promise<any>;\n    emitUnsafe<E extends FunctionPropertyNames<T>>(\n        eventName: E,\n        ...args: Parameters<T[E]>\n    ): JQuery.Promise<any>;\n    off<E extends FunctionPropertyNames<T>>(eventName: E, callback: T[E]): void;\n    enable<E extends FunctionPropertyNames<T>>(eventName: E): void;\n    disable<E extends FunctionPropertyNames<T>>(eventName: E): void;\n}\n\nexport class DefaultCancelableEventEmitter<T extends FunctionProperties<T>>\n    implements CancelableEventEmitter<T> {\n    private readonly listeners: any;\n    private readonly disabledListeners: any;\n\n    public constructor() {\n        this.listeners = {};\n        this.disabledListeners = {};\n    }\n\n    private getEventListeners(eventName) {\n        return this.listeners[eventName];\n    }\n\n    public on<E extends FunctionPropertyNames<T>>(eventName: E, callback: T[E]): void {\n        if (!_.find(this.getEventListeners(eventName), listener => listener === callback)) {\n            this.listeners[eventName] = this.listeners[eventName] || [];\n            this.listeners[eventName].push(callback);\n        }\n    }\n\n    public off<E extends FunctionPropertyNames<T>>(eventName: E, callback: T[E]): void {\n        if (this.listeners[eventName]) {\n            const index = this.listeners[eventName].indexOf(callback);\n            if (index >= 0) {\n                this.listeners[eventName].splice(index, 1);\n            }\n        }\n    }\n\n    private getSafeParameters(args: any[]): any[] {\n        return args !== undefined ? args : deepCopy(args);\n    }\n\n    private internalEmit<E extends FunctionPropertyNames<T>>(\n        eventName: E,\n        safe: boolean,\n        ...args: Parameters<T[E]>\n    ): JQuery.Promise<any> {\n        const promises = _.map(this.getEventListeners(eventName), (listener: any) => {\n            try {\n                const parameters: any = safe ? _.map(args, this.getSafeParameters) : args;\n                return listener(...parameters);\n            } catch (error) {\n                return jQuery.Deferred().reject(error);\n            }\n        });\n\n        return jQuery.when(...promises);\n    }\n\n    public emit<E extends FunctionPropertyNames<T>>(\n        eventName: E,\n        ...args: Parameters<T[E]>\n    ): JQuery.Promise<any> {\n        return this.internalEmit(eventName, true, ...args);\n    }\n\n    public emitUnsafe<E extends FunctionPropertyNames<T>>(\n        eventName: E,\n        ...args: Parameters<T[E]>\n    ): JQuery.Promise<any> {\n        return this.internalEmit(eventName, false, ...args);\n    }\n\n    public enable<E extends FunctionPropertyNames<T>>(eventName: E): void {\n        if (!_.isEmpty(this.disabledListeners[eventName])) {\n            this.listeners[eventName] = _.union(\n                this.listeners[eventName],\n                this.disabledListeners[eventName]\n            );\n            this.disabledListeners[eventName] = [];\n        }\n    }\n\n    public disable<E extends FunctionPropertyNames<T>>(eventName: E): void {\n        if (_.isEmpty(this.disabledListeners[eventName])) {\n            this.disabledListeners[eventName] = this.listeners[eventName];\n            this.listeners[eventName] = [];\n        }\n    }\n}\n"]}