{"version":3,"sources":["StoreLocator.Results.View.ts"],"names":[],"mappings":"AAAA;;;;;EAKE;;;IAeF,IAAM,uBAAuB,GAAQ,YAAY,CAAC,MAAM,CAAC;QACrD,QAAQ,EAAE,yBAAyB;QAEnC,MAAM,EAAE;YACJ,gCAAgC,EAAE,YAAY;YAC9C,iCAAiC,EAAE,YAAY;YAC/C,yCAAyC,EAAE,cAAc;SAC5D;QAED,qBAAqB;QACrB,0BAA0B;QAC1B,UAAU,EAAE,SAAS,UAAU,CAAC,OAAO;YACnC,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC;YACvC,IAAI,CAAC,aAAa,GAAG,OAAO,CAAC,aAAa,CAAC;YAE3C,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC;YAErC,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,KAAK,CAAC,aAAa,EAAE,IAAI,KAAK,CAAC,cAAc,EAAE,CAAC;YAElE,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;YAC/C,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QACrD,CAAC;QAED,uBAAuB;QACvB,oBAAoB;QACpB,YAAY,EAAE,SAAS,YAAY,CAAC,CAAC;YACjC,CAAC,CAAC,cAAc,EAAE,CAAC;YAEnB,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;YACxB,uDAAuD;YACvD,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QACzC,CAAC;QAED,QAAQ,EAAE,SAAS,QAAQ;YACvB,IAAI,CAAC,MAAM,EAAE,CAAC;YAEd,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACf,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE;oBACxB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;iBAC5B;qBAAM;oBACH,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;iBAC7B;aACJ;QACL,CAAC;QAED,iBAAiB;QACjB,MAAM,EAAE,SAAS,MAAM;YACnB,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE;gBACxB,IAAI,CAAC,OAAO,EAAE,CAAC;gBAEf,IAAI,IAAI,CAAC,QAAQ,EAAE;oBACf,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC;oBAClB,IAAI,CAAC,UAAU,EAAE,CAAC;iBACrB;aACJ;iBAAM;gBACH,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC;aACpB;QACL,CAAC;QAED,qBAAqB;QACrB,oBAAoB;QACpB,UAAU,EAAE,SAAS,UAAU,CAAC,CAAC;YAC7B,IAAM,UAAU,GAAG,IAAI,CAAC,CAAC,CAAC,yBAAyB,CAAC,CAAC;YACrD,IAAM,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,wBAAwB,CAAC,CAAC;YACnD,IAAM,OAAO,GAAG,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;YAEtC,IAAI,OAAO,IAAI,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,UAAU,EAAE;gBAClD,UAAU,CAAC,IAAI,EAAE,CAAC;gBAClB,SAAS,CAAC,IAAI,EAAE,CAAC;gBAEjB,IAAI,CAAC,CAAC,CAAC,2BAA2B,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;gBAC1D,IAAI,CAAC,CAAC,CAAC,0BAA0B,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;gBAEtD,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC;gBAE9B,IAAM,IAAI,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,mBAAmB,CAAC,CAAC;gBAEzD,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,CAAC;aAC1E;iBAAM;gBACH,SAAS,CAAC,IAAI,EAAE,CAAC;gBACjB,UAAU,CAAC,IAAI,EAAE,CAAC;gBAElB,IAAI,CAAC,CAAC,CAAC,0BAA0B,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;gBACzD,IAAI,CAAC,CAAC,CAAC,2BAA2B,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;aAC1D;QACL,CAAC;QAED,gCAAgC;QAChC,UAAU,EAAE;YACR,WAAW,EAAE;gBACT,OAAO,IAAI,sBAAsB,CAAC;oBAC9B,UAAU,EAAE,IAAI,CAAC,UAAU;oBAC3B,SAAS,EAAE,oBAAoB;oBAC/B,gBAAgB,EAAE;wBACd,aAAa,EAAE,IAAI,CAAC,aAAa;wBACjC,QAAQ,EAAE,IAAI,CAAC,QAAQ;qBAC1B;iBACJ,CAAC,CAAC;YACP,CAAC;YACD,qBAAqB,EAAE;gBACnB,IAAI,CAAC,eAAe,GAAG,IAAI,mBAAmB,CAAC;oBAC3C,UAAU,EAAE,IAAI,CAAC,UAAU;oBAC3B,WAAW,EAAE,IAAI,CAAC,WAAW;oBAC7B,aAAa,EAAE,IAAI,CAAC,aAAa;iBACpC,CAAC,CAAC;gBAEH,OAAO,IAAI,CAAC,eAAe,CAAC;YAChC,CAAC;SACJ;QAED,qBAAqB;QACrB,6CAA6C;QAC7C,UAAU,EAAE,SAAS,UAAU;YAC3B,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,EAAE,CAAC;YAClD,4CAA4C;YAC5C,OAAO;gBACH,iCAAiC;gBACjC,UAAU,EAAE,QAAQ,IAAI,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;gBAChE,iCAAiC;gBACjC,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM;gBACnC,0CAA0C;gBAC1C,mBAAmB,EACf,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,mBAAmB,EAAE;gBAC3E,8BAA8B;gBAC9B,OAAO,EAAE,IAAI,CAAC,QAAQ;gBACtB,gCAAgC;gBAChC,UAAU,EAAE,6BAAa,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,cAAc;aAC3F,CAAC;QACN,CAAC;KACJ,CAAC,CAAC;IAEH,OAAS,uBAAuB,CAAC","file":"StoreLocator.Results.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"StoreLocator.Results.View\"/>\n// //@module StoreLocator.Results.View\n\nimport * as store_locator_results_tpl from 'store_locator_results.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { Configuration } from '../../SCA/JavaScript/Configuration';\n\nimport StoreLocatorListView = require('./StoreLocator.List.View');\nimport StoreLocatorMapView = require('./StoreLocator.Map.View');\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\nimport BackboneCollectionView = require('../../../Commons/Backbone.CollectionView/JavaScript/Backbone.CollectionView');\n\nconst StoreLocatorResultsView: any = BackboneView.extend({\n    template: store_locator_results_tpl,\n\n    events: {\n        'click [data-action=\"show-map\"]': 'toggleView',\n        'click [data-action=\"show-list\"]': 'toggleView',\n        'click [data-action=\"sc-pusher-dismiss\"]': 'refineSearch'\n    },\n\n    // @method initialize\n    // @param {Object} options\n    initialize: function initialize(options) {\n        this.application = options.application;\n        this.reference_map = options.reference_map;\n\n        this.collection = options.collection;\n\n        this.isDevice = !!Utils.isPhoneDevice() || Utils.isTabletDevice();\n\n        this.collection.on('reset', this.render, this);\n        this.collection.on('reset', this.showPush, this);\n    },\n\n    // @method refineSearch\n    // @param {Object} e\n    refineSearch: function refineSearch(e) {\n        e.preventDefault();\n\n        this.collection.reset();\n        // this.profileModel.unset('storeLocator_last_search');\n        this.reference_map.setPosition(null);\n    },\n\n    showPush: function showPush() {\n        this.render();\n\n        if (this.isDevice) {\n            if (this.collection.length) {\n                this.$el.trigger('open');\n            } else {\n                this.$el.trigger('close');\n            }\n        }\n    },\n\n    // @method render\n    render: function render() {\n        if (this.collection.length) {\n            this._render();\n\n            if (this.isDevice) {\n                this.$el.scPush();\n                this.toggleView();\n            }\n        } else {\n            this.$el.empty();\n        }\n    },\n\n    // @method toggleView\n    // @param {Object} e\n    toggleView: function toggleView(e) {\n        const $list_view = this.$('[data-type=\"list-view\"]');\n        const $map_view = this.$('[data-type=\"map-view\"]');\n        const $target = e && this.$(e.target);\n\n        if ($target && $target.data('action') === 'show-map') {\n            $list_view.hide();\n            $map_view.show();\n\n            this.$('[data-action=\"show-list\"]').removeClass('active');\n            this.$('[data-action=\"show-map\"]').addClass('active');\n\n            this.mapViewInstance.render();\n\n            const $map = this.mapViewInstance.$('[data-type=\"map\"]');\n\n            $map.css('height', jQuery(window).innerHeight() - $map.position().top);\n        } else {\n            $map_view.hide();\n            $list_view.show();\n\n            this.$('[data-action=\"show-map\"]').removeClass('active');\n            this.$('[data-action=\"show-list\"]').addClass('active');\n        }\n    },\n\n    // @property {Object} childViews\n    childViews: {\n        LocatorList: function() {\n            return new BackboneCollectionView({\n                collection: this.collection,\n                childView: StoreLocatorListView,\n                childViewOptions: {\n                    reference_map: this.reference_map,\n                    isDevice: this.isDevice\n                }\n            });\n        },\n        ResultStoreLocatorMap: function() {\n            this.mapViewInstance = new StoreLocatorMapView({\n                collection: this.collection,\n                application: this.application,\n                reference_map: this.reference_map\n            });\n\n            return this.mapViewInstance;\n        }\n    },\n\n    // @method getContext\n    // @return StoreLocator.Location.View.Context\n    getContext: function getContext() {\n        const position = this.reference_map.getPosition();\n        // @Class StoreLocator.Location.View.Context\n        return {\n            // @property {Boolean} myposition\n            myposition: position && position.address ? position.address : '',\n            // @property {Number} totalStores\n            totalStores: this.collection.length,\n            // @property {Boolean} showLocalizationMap\n            showLocalizationMap:\n                this.isDevice && this.reference_map.configuration.showLocalizationMap(),\n            // @property {Boolean} showMap\n            showMap: this.isDevice,\n            // @property {String} touchpoint\n            touchpoint: Configuration.get('siteSettings.isHttpsSupported') ? 'home' : 'storelocator'\n        };\n    }\n});\n\nexport = StoreLocatorResultsView;\n"]}