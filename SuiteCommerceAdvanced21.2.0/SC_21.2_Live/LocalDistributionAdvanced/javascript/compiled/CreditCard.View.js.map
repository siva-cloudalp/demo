{"version":3,"sources":["CreditCard.View.ts"],"names":[],"mappings":"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","file":"CreditCard.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"CreditCard.View\"/>\n// @module CreditCard\n\nimport * as _ from 'underscore';\nimport * as creditcard_tpl from 'creditcard.tpl';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\n\nimport CreditCardEditFormSecurityCodeView = require('./CreditCard.Edit.Form.SecurityCode.View');\nimport BackboneFormView = require('../../Backbone.FormView/JavaScript/Backbone.FormView');\nimport BackboneView = require('../../BackboneExtras/JavaScript/Backbone.View');\n\n// @class CreditCard.View @extends Backbone.View\nconst CreditCardView: any = BackboneView.extend({\n    template: creditcard_tpl,\n\n    initialize: function(options) {\n        this.options = options;\n\n        if (this.options.showSecurityCodeForm) {\n            this.model.set('hasSecurityCode', true);\n\n            this.bindings = {\n                '[name=\"ccsecuritycode\"]': 'ccsecuritycode'\n            };\n\n            this.events = {\n                'submit form': 'doNothing'\n            };\n\n            BackboneFormView.add(this);\n        }\n    },\n\n    childViews: {\n        'CreditCard.Edit.Form.SecurityCode': function() {\n            return new CreditCardEditFormSecurityCodeView({\n                error: this.options.securityNumberError,\n                showCreditCardHelp: this.options.showCreditCardHelp,\n                creditCardHelpTitle: this.options.creditCardHelpTitle\n            });\n        }\n    },\n\n    doNothing: function(e) {\n        e.preventDefault();\n    },\n\n    // @method getContext @return CreditCard.View\n    getContext: function() {\n        const payment_methods = Configuration.get('siteSettings.paymentmethods');\n        const payment_method: any = this.model.get('paymentmethod').key\n            ? _.findWhere(payment_methods, { key: this.model.get('paymentmethod').key })\n            : _.findWhere(payment_methods, {\n                  internalid: this.model.get('paymentmethod').internalid\n              });\n        const icon = payment_method && payment_method.imagesrc && payment_method.imagesrc[0];\n        const expiration_month = this.model.get('expmonth');\n        const expiration_year = !!this.model.get('expyear') && this.model.get('expyear').slice(2);\n        const isSelected =\n            this.options.hideSelector ||\n            this.model.get('internalid') === this.options.selectedCreditCardId;\n\n        // @class CreditCard.View\n        return {\n            // @property {String} creditCartId\n            creditCartId: this.model.get('internalid'),\n            // @property {Boolean} showSecurityCodeForm\n            showSecurityCodeForm: !!this.options.showSecurityCodeForm && isSelected,\n            // @property {String} showCreditCardImage\n            showCreditCardImage: !!icon,\n            // @property {String} creditCardImageUrl\n            creditCardImageUrl: icon || '',\n            // @property {String} paymentName\n            paymentName: this.model.get('paymentmethod').name,\n            // @property {String} ccnumber\n            ccnumber: this.model.get('ccnumber').substring(this.model.get('ccnumber').length - 4),\n            // @property {String} ccname\n            ccname: this.model.get('ccname') || '',\n            // @property {String} expirationDate\n            expirationDate:\n                (expiration_month < 10 ? '0' : '') + expiration_month + '/' + expiration_year,\n            // @property {Boolean} showDefaults\n            showDefaults: !!this.options.showDefaults,\n            // @property {Boolean} isDefaultCreditCard\n            isDefaultCreditCard: this.model.get('ccdefault') === 'T',\n            // @property {Boolean} showSelect\n            showSelect: !!this.options.showSelect,\n            // @property {String} selectMessage\n            selectMessage: this.options.selectMessage,\n            // @property {Boolean} showActions\n            showActions: !!this.options.showActions,\n            // @property {Boolean} isSelected\n            isSelected: isSelected,\n            // @property {Boolean} showSelector\n            showSelector: !this.options.hideSelector,\n            // @property {Boolean} isNewPaymentMethod\n            isNewPaymentMethod: this.model.get('internalid') < 0\n        };\n    }\n});\n\nexport = CreditCardView;\n"]}