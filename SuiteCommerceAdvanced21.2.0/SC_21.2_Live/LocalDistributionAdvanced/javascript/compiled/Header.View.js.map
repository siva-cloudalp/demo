{"version":3,"sources":["Header.View.ts"],"names":[],"mappings":"AAAA;;;;;EAKE;;;IAwBF,OAAS,YAAY,CAAC,MAAM,CAAC;QACzB,QAAQ,EAAE,UAAU;QAEpB,MAAM,EAAE;YACJ,uCAAuC,EAAE,gBAAgB;YACzD,2CAA2C,EAAE,aAAa;YAC1D,2CAA2C,EAAE,aAAa;YAC1D,yCAAyC,EAAE,aAAa;SAC3D;QAED,UAAU,EAAE;YACR,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;YAC5D,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC;QAChD,CAAC;QACD,uBAAuB;QACvB,iBAAiB;QACjB,YAAY,EAAE;YACV,IAAI,CAAC,CAAC,CAAC,yBAAyB,CAAC;iBAC5B,MAAM,EAAE;iBACR,QAAQ,CAAC,MAAM,CAAC,CAAC;QAC1B,CAAC;QACD,4EAA4E;QAC5E,cAAc,EAAE,UAAS,EAAE;YACvB,EAAE,IAAI,EAAE,CAAC,cAAc,EAAE,CAAC;YAC1B,mDAAmD;YACnD,IAAI,CAAC,CAAC,CAAC,iCAAiC,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;YAChE,IAAI,CAAC,CAAC,CAAC,0BAA0B,CAAC,CAAC,MAAM,EAAE,CAAC;YAC5C,IAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC,CAAC,cAAc,EAAE,CAAC;QAC7D,CAAC;QACD,8FAA8F;QAC9F,cAAc,EAAE;YACZ,2BAA2B;YAC3B,IAAI,CAAC,CAAC,CAAC,0BAA0B,CAAC,CAAC,IAAI,EAAE,CAAC;QAC9C,CAAC;QACD,8FAA8F;QAC9F,oBAAoB,EAAE;YAClB,IAAI,IAAI,CAAC,CAAC,CAAC,iCAAiC,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBACtD,IAAI,IAAI,GAAG,QAAQ,CAAC,OAAO,CAAC,WAAW,EAAE,IAAI,EAAE,CAAC;gBAChD,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC9E,IAAM,OAAO,GAAG,IAAI,KAAK,EAAE,IAAI,IAAI,KAAK,GAAG,CAAC;gBAE5C,IAAI,KAAK,CAAC,aAAa,EAAE,KAAK,SAAS,IAAI,OAAO,EAAE;oBAChD,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;iBACnC;qBAAM;oBACH,qCAAqC;oBACrC,IAAI,CAAC,cAAc,EAAE,CAAC;iBACzB;aACJ;QACL,CAAC;QAED,aAAa,EAAE;YAAA,iBAed;YAdW,IAAA,UAAU,GAAK,IAAI,WAAT,CAAU;YAC5B,8DAA8D;YAC9D,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,YAAY,EAAE,IAAI,KAAK,CAAC,aAAa,EAAE,EAAE;gBACnE,UAAU,CAAC,aAAa,CAAC,GAAG;oBACxB,IAAM,iBAAiB,GAAG,CAAC,CAAC,MAAM,CAC9B;wBACI,WAAW,EAAE,KAAI,CAAC,OAAO,CAAC,WAAW;qBACxC,EACD,KAAI,CAAC,OAAO,CAAC,wBAAwB,IAAI,EAAE,CAC9C,CAAC;oBACF,OAAO,IAAI,cAAc,CAAC,iBAAiB,CAAC,CAAC;gBACjD,CAAC,CAAC;aACL;YACD,OAAO,UAAU,CAAC;QACtB,CAAC;QACD,sBAAsB;QACtB,iBAAiB;QACjB,WAAW,EAAE;YACT,MAAM,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,uBAAuB,CAAC,CAAC;QACtD,CAAC;QAED,sBAAsB;QACtB,iBAAiB;QACjB,WAAW,EAAE,UAAS,CAAC;YACnB,IAAI,CAAC,CAAC,MAAM,CAAC,OAAO,KAAK,GAAG,EAAE;gBAC1B,IAAI,IAAI,CAAC,UAAU,EAAE;oBACjB,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;iBACzC;gBACD,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;gBACnC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;aACtC;YACD,MAAM,CAAC,OAAO,CAAC,CAAC,WAAW,CAAC,uBAAuB,CAAC,CAAC;QACzD,CAAC;QAED,UAAU,EAAE;YACR,iBAAiB,EAAE;gBACf,OAAO,IAAI,kBAAkB,EAAE,CAAC;YACpC,CAAC;YACD,wBAAwB,EAAE;gBACtB,OAAO,IAAI,yBAAyB,EAAE,CAAC;YAC3C,CAAC;YACD,gBAAgB,EAAE;gBACd,IAAM,uBAAuB,GAAG,EAAE,CAAC,WAAW,CAAC,YAAY,CAAC,iBAAiB,KAAK,GAAG,CAAC;gBACtF,IAAM,UAAU,GAAG,4BAAY,CAAC,WAAW,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,GAAG,CAAC;gBACxE,IAAI,CAAC,uBAAuB,IAAI,UAAU,EAAE;oBACxC,IAAM,2BAA2B,GAAG,CAAC,CAAC,MAAM,CACxC;wBACI,iBAAiB,EAAE,IAAI;wBACvB,WAAW,EAAE,IAAI,CAAC,WAAW;qBAChC,EACD,IAAI,CAAC,OAAO,CAAC,wBAAwB,IAAI,EAAE,CAC9C,CAAC;oBACF,OAAO,IAAI,iBAAiB,CAAC,2BAA2B,CAAC,CAAC;iBAC7D;gBACD,OAAO,IAAI,CAAC;YAChB,CAAC;YACD,aAAa,EAAE;gBACX,OAAO,IAAI,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAC5C,CAAC;YACD,qBAAqB,EAAE;gBACnB,OAAO,IAAI,2BAA2B,EAAE,CAAC;YAC7C,CAAC;YACD,yBAAyB,EAAE;gBACvB,OAAO,IAAI,+BAA+B,EAAE,CAAC;YACjD,CAAC;SACJ;QAED,qBAAqB;QACrB,gCAAgC;QAChC,UAAU,EAAE,SAAS,UAAU;YAC3B,IAAM,WAAW,GAAG,EAAE,CAAC,WAAW,CAAC;YACnC,IAAM,UAAU,GAAG,4BAAY,CAAC,WAAW,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,GAAG,CAAC;YACxE,IAAM,cAAc,GAAG,CAAC,CAAC,CACrB,WAAW,CAAC,cAAc;gBAC1B,WAAW,CAAC,cAAc,CAAC,MAAM,GAAG,CAAC;gBACrC,CAAC,CACG,WAAW,CAAC,YAAY,KAAK,WAAW;oBACxC,CAAC,UAAU,IAAI,WAAW,CAAC,YAAY,KAAK,UAAU,CAAC,CAC1D,CACJ,CAAC;YAEF,IAAM,eAAe,GACjB,WAAW,CAAC,mBAAmB;gBAC/B,WAAW,CAAC,mBAAmB,CAAC,MAAM,GAAG,CAAC;gBAC1C,CAAC,6BAAa,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;YAEzD,6BAA6B;YAC7B,OAAO;gBACH,mCAAmC;gBACnC,YAAY,EAAE,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE;gBAC7C,uCAAuC;gBACvC,gBAAgB,EACZ,CAAC,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE;oBAChC,CAAC,IAAI,CAAC,WAAW,CAAC,gBAAgB,EAAE,IAAI,UAAU,CAAC;gBACvD,yCAAyC;gBACzC,YAAY,EAAE,4BAAY,CAAC,WAAW,EAAE;gBACxC,oCAAoC;gBACpC,aAAa,EAAE,cAAc;gBAC7B,qCAAqC;gBACrC,cAAc,EAAE,eAAe;gBAC/B,gDAAgD;gBAChD,yBAAyB,EAAE,cAAc,IAAI,eAAe;gBAC5D,iDAAiD;gBACjD,0BAA0B,EAAE,cAAc,IAAI,eAAe;gBAC7D,uCAAuC;gBACvC,gBAAgB,EAAE,6BAAa,CAAC,iBAAiB,KAAK,MAAM;gBAC5D,oCAAoC;gBACpC,cAAc,EAAE,6BAAa,CAAC,GAAG,CAAC,gCAAgC,EAAE,KAAK,CAAC;oBACtE,CAAC,CAAC,6BAAa,CAAC,iBAAiB;oBACjC,CAAC,CAAC,UAAU;gBAChB,oCAAoC;gBACpC,aAAa,EAAE,KAAK,CAAC,aAAa,EAAE;aACvC,CAAC;YACF,qBAAqB;QACzB,CAAC;QAED,qFAAqF;QACrF,iBAAiB;QACjB,OAAO,EAAE;YACL,YAAY,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;YACtD,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;QAC3D,CAAC;KACJ,CAAC,CAAC","file":"Header.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Header.View\"/>\n/// <reference path=\"../../../Commons/Utilities/JavaScript/GlobalDeclarations.d.ts\" />\n\nimport * as _ from 'underscore';\nimport * as header_tpl from 'header.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { Configuration } from '../../../Commons/Utilities/JavaScript/Configuration';\nimport { ProfileModel } from '../../../Commons/Profile/JavaScript/Profile.Model';\n\nimport HeaderLogoView = require('./Header.Logo.View');\nimport HeaderMiniCartView = require('./Header.MiniCart.View');\nimport HeaderMiniCartSummaryView = require('./Header.MiniCartSummary.View');\nimport HeaderProfileView = require('./Header.Profile.View');\nimport HeaderMenuView = require('./Header.Menu.View');\nimport GlobalViewsHostSelectorView = require('../../../Commons/GlobalViews/JavaScript/GlobalViews.HostSelector.View');\nimport GlobalViewsCurrencySelectorView = require('../../../Commons/GlobalViews/JavaScript/GlobalViews.CurrencySelector.View');\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\n\n// @module Header\n// @class Header.View @extends BackboneView\nexport = BackboneView.extend({\n    template: header_tpl,\n\n    events: {\n        'click [data-action=\"show-sitesearch\"]': 'showSiteSearch', // Keeping to be backward compatible\n        'click [data-action=\"header-sidebar-show\"]': 'showSidebar',\n        'click [data-action=\"header-sidebar-hide\"]': 'hideSidebar',\n        'click [data-type=\"header-sidebar-menu\"]': 'hideSidebar'\n    },\n\n    initialize: function(): void {\n        Backbone.history.on('all', this.verifyShowSiteSearch, this);\n        this.application = this.options.application;\n    },\n    // @method showMiniCart\n    // @return {Void}\n    showMiniCart: function(): void {\n        this.$('[data-type=\"mini-cart\"]')\n            .parent()\n            .addClass('open');\n    },\n    // Keeping this here to be backward compatible with themes prior to 2018.2.0\n    showSiteSearch: function(ev): void {\n        ev && ev.preventDefault();\n        // This add a class 'active' to change button color\n        this.$('[data-action=\"show-sitesearch\"]').toggleClass('active');\n        this.$('[data-type=\"SiteSearch\"]').toggle();\n        this.getChildViewInstance('SiteSearch').showSiteSearch();\n    },\n    // Keeping this here to be backward compatible with themes prior to 2018.2.0, do not use this!\n    hideSiteSearch: function(): void {\n        // This hide Sitesearch div\n        this.$('[data-type=\"SiteSearch\"]').hide();\n    },\n    // Keeping this here to be backward compatible with themes prior to 2018.2.0, do not use this!\n    verifyShowSiteSearch: function(): void {\n        if (this.$('[data-action=\"show-sitesearch\"]').length > 0) {\n            let hash = Backbone.history.getFragment() || '';\n            hash = hash.indexOf('?') === -1 ? hash : hash.substring(0, hash.indexOf('?'));\n            const is_home = hash === '' || hash === '/';\n\n            if (Utils.getDeviceType() !== 'desktop' && is_home) {\n                this.showSiteSearch(null, true);\n            } else {\n                // This hide sitesearch when navigate\n                this.hideSiteSearch();\n            }\n        }\n    },\n\n    getChildViews: function() {\n        const { childViews } = this;\n        // condition to prevent showing the desktop menu in standalone\n        if (!this.options.application.isStandalone() || Utils.isPhoneDevice()) {\n            childViews['Header.Menu'] = (): any => {\n                const headerViewOptions = _.extend(\n                    {\n                        application: this.options.application\n                    },\n                    this.options.headerProfileViewOptions || {}\n                );\n                return new HeaderMenuView(headerViewOptions);\n            };\n        }\n        return childViews;\n    },\n    // @method showSidebar\n    // @return {Void}\n    showSidebar: function(): void {\n        jQuery('#main').addClass('header-sidebar-opened');\n    },\n\n    // @method hideSidebar\n    // @return {Void}\n    hideSidebar: function(e): void {\n        if (e.target.tagName === 'A') {\n            if (this.activeLink) {\n                this.activeLink.removeClass('active');\n            }\n            this.activeLink = jQuery(e.target);\n            this.activeLink.addClass('active');\n        }\n        jQuery('#main').removeClass('header-sidebar-opened');\n    },\n\n    childViews: {\n        'Header.MiniCart': function() {\n            return new HeaderMiniCartView();\n        },\n        'Header.MiniCartSummary': function() {\n            return new HeaderMiniCartSummaryView();\n        },\n        'Header.Profile': function() {\n            const password_protected_site = SC.ENVIRONMENT.siteSettings.siteloginrequired === 'T';\n            const isLoggedIn = ProfileModel.getInstance().get('isLoggedIn') === 'T';\n            if (!password_protected_site || isLoggedIn) {\n                const header_profile_view_options = _.extend(\n                    {\n                        showMyAccountMenu: true,\n                        application: this.application\n                    },\n                    this.options.headerProfileViewOptions || {}\n                );\n                return new HeaderProfileView(header_profile_view_options);\n            }\n            return null;\n        },\n        'Header.Logo': function() {\n            return new HeaderLogoView(this.options);\n        },\n        'Global.HostSelector': function() {\n            return new GlobalViewsHostSelectorView();\n        },\n        'Global.CurrencySelector': function() {\n            return new GlobalViewsCurrencySelectorView();\n        }\n    },\n\n    // @method getContext\n    // @return {Header.View.Context}\n    getContext: function getContext() {\n        const environment = SC.ENVIRONMENT;\n        const isLoggedIn = ProfileModel.getInstance().get('isLoggedIn') === 'T';\n        const show_languages = !!(\n            environment.availableHosts &&\n            environment.availableHosts.length > 1 &&\n            !(\n                environment.SCTouchpoint === 'myaccount' ||\n                (isLoggedIn && environment.SCTouchpoint === 'checkout')\n            )\n        );\n\n        const show_currencies =\n            environment.availableCurrencies &&\n            environment.availableCurrencies.length > 1 &&\n            !Configuration.get('header.notShowCurrencySelector');\n\n        // @class Header.View.Context\n        return {\n            // @property {Boolean} isStandalone\n            isStandalone: this.application.isStandalone(),\n            // @property {Boolean} isReorderEnabled\n            isReorderEnabled:\n                !this.application.isStandalone() ||\n                (this.application.isReorderEnabled() && isLoggedIn),\n            // @property {Profile.Model} profileModel\n            profileModel: ProfileModel.getInstance(),\n            // @property {Boolean} showLanguages\n            showLanguages: show_languages,\n            // @property {Boolean} showCurrencies\n            showCurrencies: show_currencies,\n            // @property {Boolean} showLanguagesOrCurrencies\n            showLanguagesOrCurrencies: show_languages || show_currencies,\n            // @property {Boolean} showLanguagesAndCurrencies\n            showLanguagesAndCurrencies: show_languages && show_currencies,\n            // @property {Boolean} isHomeTouchpoint\n            isHomeTouchpoint: Configuration.currentTouchpoint === 'home',\n            // @property {String} cartTouchPoint\n            cartTouchPoint: Configuration.get('modulesConfig.Cart.startRouter', false)\n                ? Configuration.currentTouchpoint\n                : 'viewcart',\n            // @property {Boolean} isPhoneDevice\n            isPhoneDevice: Utils.isPhoneDevice()\n        };\n        // @class Header.View\n    },\n\n    // @method destroy Override default destroy method to clean navigation event handlers\n    // @return {Void}\n    destroy: function(): void {\n        BackboneView.prototype.destroy.apply(this, arguments);\n        Backbone.history.off('all', this.verifyShowSiteSearch);\n    }\n});\n"]}