{"version":3,"sources":["Facets.FacetedNavigationItem.View.ts"],"names":[],"mappings":"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","file":"Facets.FacetedNavigationItem.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"Facets.FacetedNavigationItem.View\"/>\n\nimport * as _ from 'underscore';\nimport '../../BootstrapExtras/JavaScript/Bootstrap.Slider';\nimport * as facets_faceted_navigation_item_tpl from 'facets_faceted_navigation_item.tpl';\nimport * as Utils from '../../Utilities/JavaScript/Utils';\nimport * as jQuery from '../../Core/JavaScript/jQuery';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\n\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\n\n// @module Facets\nexport = BackboneView.extend({\n    template: facets_faceted_navigation_item_tpl,\n\n    events: {\n        'click [data-action=\"see-more\"]': 'toggleSeeMoreLess',\n        'slide div[data-toggle=\"slider\"]': 'updateRangeValues',\n        'stop div[data-toggle=\"slider\"]': 'updateRangeSelection'\n    },\n\n    initialize: function() {\n        this.facetId = this.model.get('url') || this.model.get('id');\n        this.facet_config = this.options.translator.getFacetConfig(this.facetId);\n\n        // this values is configured in the Configuration File (SCA.Shopping.Configuration)\n        if (this.facet_config.template) {\n            this.template = this.facet_config.template;\n        }\n        this.on('afterViewRender', this.renderFacets, this);\n    },\n\n    // @method renderFacets\n    renderFacets: function() {\n        this.sliders = this.$('[data-toggle=\"slider\"]').slider();\n        this.$('[data-collapsed=\"true\"]').hide();\n    },\n\n    destroy: function() {\n        if (this.sliders.data('slider')) {\n            this.sliders.data('slider').stopListen();\n        }\n\n        BackboneView.prototype.destroy.apply(this, arguments);\n    },\n\n    toggleSeeMoreLess: function(event) {\n        const target = jQuery(event.currentTarget);\n        const target_see_more = target.find('[data-type=\"see-more\"]');\n        const target_see_less = target.find('[data-type=\"see-less\"]');\n        const target_was_expanded = !!target.data('collapsed');\n\n        if (target_was_expanded) {\n            target_see_more.show();\n            target_see_less.hide();\n        } else {\n            target_see_more.hide();\n            target_see_less.show();\n        }\n\n        target.data('collapsed', !target_was_expanded);\n    },\n\n    // @method updateRangeValues\n    // Talks to the Bootstrap.Slider.js\n    // Displays the numbers under the slider while you are slider\n    updateRangeValues: function(e, slider) {\n        const { parser } = this.options.translator.getFacetConfig(this.facetId);\n        const start = _.isFunction(parser) ? parser(slider.values.low, true) : slider.values.low;\n        const end = _.isFunction(parser) ? parser(slider.values.high, false) : slider.values.high;\n\n        this.$el\n            .find('span[data-range-indicator=\"start\"]')\n            .html(start)\n            .end()\n            .find('span[data-range-indicator=\"end\"]')\n            .html(end);\n    },\n\n    // @method updateRangeSelection\n    // Talks to the Bootstrap.Slider.js\n    // Once the user releases the Slider controller this takes care of\n    // generating a new url and of navigating to it\n    updateRangeSelection: function(e, slider) {\n        const { translator } = this.options;\n        // the currently selected slider values\n        const slider_values = slider.values;\n        // currently selected values for that facet\n        const facet_values = translator.getFacetValue(this.facetId);\n        // available values for that facet\n        const values = _.map(this.model.get('values'), function(item: any) {\n            return parseFloat(item.url);\n        });\n\n        // if the low selected value equals the minimum available value\n        // and the high selected value equals the maximum available value\n        if (_.min(values) === slider_values.low && _.max(values) === slider_values.high) {\n            // then we remove the facet from the selection\n            Backbone.history.navigate(translator.cloneWithoutFacetId(this.facetId).getUrl(), {\n                trigger: true\n            });\n        }\n        // else, if there are not values selected OR\n        // the selected from value is different than the slider low value OR\n        // the selected to value is different than the slider high value\n        else if (\n            !facet_values ||\n            parseFloat(facet_values.from) !== slider_values.low ||\n            parseFloat(facet_values.to) !== slider_values.high\n        ) {\n            // then we navigate to that page\n            Backbone.history.navigate(\n                translator\n                    .cloneForFacetId(this.facetId, {\n                        from: slider_values.low.toFixed(2),\n                        to: slider_values.high.toFixed(2)\n                    })\n                    .getUrl(),\n                {\n                    trigger: true\n                }\n            );\n        }\n    },\n\n    // @method getContext @return {Facets.FacetedNavigationItem.View.Context}\n    getContext: function() {\n        const facet_id = this.facetId;\n        const { translator } = this.options;\n        const { facet_config } = this;\n        const values = [];\n        let range_min = 0;\n        let range_max = 0;\n        let range_from = 0;\n        let range_from_label = '';\n        let range_to = 0;\n        let range_to_label = '';\n        let range_values = [];\n        let max_items;\n        let display_values;\n        let extra_values = [];\n        let show_facet;\n        let show_remove_link;\n        // fixes the selected items\n        let selected_values = this.options.translator.getFacetValue(facet_id) || [];\n\n        selected_values = _.isArray(selected_values) ? selected_values : [selected_values];\n        show_remove_link = !!selected_values.length;\n\n        // Prepears the values for display\n        const original_values = _.isArray(this.model.get('values'))\n            ? this.model.get('values')\n            : [this.model.get('values')];\n\n        if (facet_config.behavior !== 'range') {\n            _.each(original_values, function(value: any) {\n                if (value.url !== '') {\n                    value.isActive = _.contains(selected_values, value.url);\n                    value.link = translator.cloneForFacetId(facet_id, value.url).getUrl();\n                    value.displayName =\n                        value.label || decodeURIComponent(value.url) || Utils.translate('(none)');\n                    value.color = '';\n                    value.isColorTile = false;\n                    value.image = {};\n                    value.isImageTile = false;\n\n                    if (facet_config.colors) {\n                        value.color =\n                            facet_config.colors[value.label] || facet_config.colors.defaultColor;\n                        if (_.isObject(value.color)) {\n                            value.image = value.color;\n                            value.color = '';\n                            value.isImageTile = true;\n                        } else {\n                            value.isColorTile = true;\n                        }\n                    }\n\n                    values.push(value);\n                }\n            });\n\n            max_items = facet_config.max || values.length;\n            display_values = _.first(values, max_items);\n            _(display_values).each(function(value: any) {\n                value.isLightColor = _.contains(\n                    Configuration.get('layout.lightColors', []),\n                    value.label\n                );\n            });\n            extra_values = _.rest(values, max_items);\n            show_facet = !!values.length;\n        } // if (facet_config.behavior === 'range')\n        else {\n            range_values = _.map(original_values, function(item: any) {\n                return parseFloat(item.url);\n            });\n\n            range_min = _.min(range_values);\n            range_max = _.max(range_values);\n\n            show_facet = range_max > range_min;\n            show_remove_link =\n                this.model.get('max') !== range_max || this.model.get('min') !== range_min;\n\n            const translator_value = translator.getFacetValue(facet_id) || {\n                from: range_min,\n                to: range_max\n            };\n            range_from = translator_value.from;\n            range_to = translator_value.to;\n\n            range_to_label = _.isFunction(facet_config.parser)\n                ? facet_config.parser(range_to, false)\n                : range_to;\n            range_from_label = _.isFunction(facet_config.parser)\n                ? facet_config.parser(range_from, false)\n                : range_from;\n        }\n\n        // @class Facets.FacetedNavigationItem.View.Context\n        const context = {\n            // @property {String} htmlId\n            htmlId: _.uniqueId('facetList_'),\n            // @property {String} facetId\n            facetId: facet_id,\n            // @property {Boolean} showFacet\n            showFacet: show_facet,\n            // @property {Boolean} showHeading\n            showHeading: _.isBoolean(facet_config.showHeading) ? facet_config.showHeading : true,\n            // @property {Boolean} isUncollapsible\n            isUncollapsible: !!facet_config.uncollapsible,\n            // @property {Boolean} isCollapsed\n            isCollapsed: !this.facet_config.uncollapsible && this.facet_config.collapsed,\n            // @property {Boolean} isMultiSelect\n            isMultiSelect: facet_config.behavior === 'multi',\n            // @property {Boolean} showRemoveLink\n            showRemoveLink: show_remove_link,\n            // @property {String} removeLink\n            removeLink: translator.cloneWithoutFacetId(facet_id).getUrl(),\n            // @property {String} facetDisplayName\n            facetDisplayName: facet_config.name || facet_id,\n            // @property {Array<Object>} values\n            values: values,\n            // @property {Array<Object>} displayValues\n            displayValues: display_values,\n            // @property {Array<Object>} extraValues\n            extraValues: extra_values,\n            // @property {Boolean} showExtraValues\n            showExtraValues: !!extra_values.length,\n            // @property {Boolean} isRange\n            isRange: facet_config.behavior === 'range',\n            // @property {Array<Number>} rangeValues\n            rangeValues: range_values,\n            // @property {Number} rangeMin\n            rangeMin: range_min,\n            // @property {Number} rangeMax\n            rangeMax: range_max,\n            // @property {Number} rangeFrom\n            rangeFrom: range_from,\n            // @property {String} rangeFromLabel\n            rangeFromLabel: range_from_label,\n            // @property {Number} rangeTo\n            rangeTo: range_to,\n            // @property {String} rangeToLabel\n            rangeToLabel: range_to_label\n        };\n\n        // @class Facets.FacetedNavigationItem.View\n        return context;\n    }\n});\n"]}