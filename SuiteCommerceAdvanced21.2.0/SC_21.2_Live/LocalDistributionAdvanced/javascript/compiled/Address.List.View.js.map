{"version":3,"sources":["Address.List.View.ts"],"names":[],"mappings":"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","file":"Address.List.View.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n// @module Address\n/// <amd-module name=\"Address.List.View\"/>\n/// <reference path=\"../../Utilities/JavaScript/GlobalDeclarations.d.ts\" />\n\nimport '../../Backbone.CompositeView/JavaScript/Backbone.CompositeView';\nimport * as address_list_tpl from 'address_list.tpl';\nimport * as backbone_collection_view_cell_tpl from 'backbone_collection_view_cell.tpl';\nimport * as backbone_collection_view_row_tpl from 'backbone_collection_view_row.tpl';\n// This require is from folder Advanced. InStore does not use this file, so this may not affect.\nimport * as paymentinstrument_creditcard_edit_tpl from 'paymentinstrument_creditcard_edit.tpl';\nimport * as Utils from '../../Utilities/JavaScript/Utils';\nimport * as jQuery from '../../Core/JavaScript/jQuery';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\nimport { ProfileModel } from '../../Profile/JavaScript/Profile.Model';\n\nimport BackboneView = require('../../BackboneExtras/JavaScript/Backbone.View');\nimport Backbone = require('../../Utilities/JavaScript/backbone.custom');\nimport BackboneCollectionView = require('../../Backbone.CollectionView/JavaScript/Backbone.CollectionView');\nimport GlobalViewsConfirmationView = require('../../GlobalViews/JavaScript/GlobalViews.Confirmation.View');\nimport { AddressDetailsView } from './Address.Details.View';\n\n// @class Address.List.View List profile's addresses @extend Backbone.View\nconst AddressListView: any = BackboneView.extend({\n    template: address_list_tpl,\n\n    page_header: Utils.translate('Address Book'),\n\n    title: Utils.translate('Address Book'),\n\n    attributes: {\n        id: 'AddressBook',\n        class: 'AddressListView'\n    },\n\n    events: {\n        'click [data-action=\"remove\"]': 'removeAddress'\n    },\n\n    initialize: function() {\n        this.profileModel = ProfileModel.getInstance();\n        this.collection = this.profileModel.get('addresses');\n\n        this.collection.on(\n            'reset sync add remove change destroy',\n            function() {\n                if (this.collection.length) {\n                    this.collection.sort();\n                    this.render();\n                } else {\n                    Backbone.history.navigate('#addressbook/new', { trigger: true });\n                }\n            },\n            this\n        );\n    },\n\n    destroy: function destroy() {\n        this.collection.off(null, null, this);\n\n        this._destroy();\n    },\n\n    beforeShowContent: function beforeShowContent() {\n        const promise = jQuery.Deferred();\n\n        if (this.profileModel.get('isLoggedIn') !== 'T') {\n            promise.reject();\n            this.application.getLayout().notFound();\n        } else if (!this.collection.length) {\n            promise.reject();\n            Backbone.history.navigate('#addressbook/new', { trigger: true });\n        } else {\n            promise.resolve();\n        }\n\n        return promise;\n    },\n\n    // @method getAddressesToShow returns a copy of the addresses collection including the new address button available to show\n    getAddressesToShow: function() {\n        let addresses_to_show;\n\n        if (this.collection && !!this.collection.length) {\n            addresses_to_show = paymentinstrument_creditcard_edit_tpl\n                ? this.collection.getCollectionForRendering()\n                : this.collection;\n        }\n\n        return addresses_to_show ? addresses_to_show.models : [];\n    },\n\n    childViews: {\n        'Addresses.Collection': function() {\n            return new BackboneCollectionView({\n                childView: AddressDetailsView,\n                collection: this.getAddressesToShow(),\n                viewsPerRow:\n                    this.itemsPerRow ||\n                    (Utils.isDesktopDevice() ? 3 : Utils.isTabletDevice() ? 2 : 1),\n                cellTemplate: backbone_collection_view_cell_tpl,\n                rowTemplate: backbone_collection_view_row_tpl,\n                childViewOptions: this.getAddressListOptions()\n            });\n        }\n    },\n\n    getAddressListOptions: function() {\n        return {\n            showSelect: false,\n            selectMessage: this.selectMessage || '',\n            hideDefaults: false,\n            hideSelector: true\n        };\n    },\n\n    // @method getSelectedMenu\n    getSelectedMenu: function() {\n        return 'addressbook';\n    },\n    // @method getBreadcrumbPages\n    getBreadcrumbPages: function() {\n        return {\n            text: this.title,\n            href: '/addressbook'\n        };\n    },\n    // remove address\n    removeAddress: function(e: any) {\n        e.preventDefault();\n\n        const deleteConfirmationView = new GlobalViewsConfirmationView({\n            callBack: this.removeAddressModel,\n            callBackParameters: {\n                context: this,\n                addressId: jQuery(e.target).data('id')\n            },\n            title: Utils.translate('Remove Address'),\n            body: Utils.translate('Are you sure you want to delete this address?'),\n            autohide: true\n        });\n\n        this.options.application.getLayout().showInModal(deleteConfirmationView);\n    },\n\n    removeAddressModel: function(options: any) {\n        options.context.collection.get(options.addressId).destroy({ wait: true });\n    },\n\n    // @method getContext @return {Address.List.View.Context}\n    getContext: function() {\n        // @class Address.List.View.Context\n        return {\n            // @property {String} pageHeader\n            pageHeader: this.page_header,\n            // @property {Boolean} isAddressCollectionLengthGreaterThan0\n            isAddressCollectionLengthGreaterThan0: this.collection.length > 0,\n            // @property {Boolean} showBackToAccount\n            showBackToAccount: Configuration.get('siteSettings.sitetype') === 'STANDARD'\n        };\n    }\n});\n\nexport = AddressListView;\n"]}