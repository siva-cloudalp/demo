{"version":3,"sources":["SocialSharing.Plugins.AddThis.ts"],"names":[],"mappings":"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","file":"SocialSharing.Plugins.AddThis.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"SocialSharing.Plugins.AddThis\"/>\n/// <reference path=\"../../../Commons/Utilities/JavaScript/GlobalDeclarations.d.ts\" />\n\nimport * as _ from 'underscore';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { Configuration } from '../../../Commons/Utilities/JavaScript/Configuration';\n\nimport SocialSharing = require('./SocialSharing');\n\n// @class SocialSharing.AddThis @extends ApplicationModule\nconst addthisPlugin: any = {\n    excludeFromMyAccount: true,\n    // @method refreshAddThisElements\n    // re-writes the DOM of the AddThis elements\n    refreshAddThisElements: function() {\n        if (typeof addthis === 'undefined' || !jQuery('[data-type=\"share-in-add-this\"]').length) {\n            return;\n        }\n\n        const metaTagMappingOg = Configuration.get('metaTagMappingOg');\n        let innerHTML = '';\n\n        _.each(Configuration.get('addThis.servicesToShow'), function(name, code) {\n            innerHTML += '<a class=\"addthis_button_' + code + '\">' + name + '</a>';\n        });\n\n        const share_options = {\n            url: metaTagMappingOg['og:url'](this),\n            title: metaTagMappingOg['og:title'](this),\n            description: metaTagMappingOg['og:description'](this)\n        };\n\n        jQuery('[data-type=\"share-in-add-this\"]').each(function() {\n            if (this) {\n                const $this = jQuery(this);\n                $this.html(innerHTML).addClass(Configuration.get('addThis.toolboxClass'));\n                addthis.toolbox(this, Configuration.get('addThis.options'), share_options);\n            }\n        });\n    },\n\n    mountToApp: function(application) {\n        if (Configuration.get('addThis.enable')) {\n            const layout = application.getLayout();\n\n            // This are mostly related to the dom, or to events, so we add them in the layout\n            _.extend(layout, {\n                refreshAddThisElements: this.refreshAddThisElements,\n                addthis_script_loaded: false\n            });\n\n            // @class SocialSharing.AddThis.Plugin @extends ApplicationModule\n            const plugin = {\n                name: 'addthisPlugin',\n                priority: 10,\n                execute: function(application) {\n                    const layout = application.getLayout();\n\n                    if (!jQuery('[data-type=\"share-in-add-this\"]').length) {\n                        layout.$el\n                            .find('[data-type=\"social-share-icons\"]')\n                            .append(\n                                '<div href=\"#\" class=\"add-this-btn\" data-type=\"share-in-add-this\"></div>'\n                            );\n                    }\n\n                    if (jQuery('[data-type=\"share-in-add-this\"]').length) {\n                        if (!layout.addthis_script_loaded) {\n                            layout.addthis_script_loaded = true;\n                            const addthis_script_url =\n                                (document.location.protocol === 'https:' ? 'https://' : 'http://') +\n                                's7.addthis.com/js/300/addthis_widget.js#domready=1';\n                            // avoid on SEO and start addthis library\n                            SC.ENVIRONMENT.jsEnvironment === 'browser' &&\n                                jQuery.getScript(addthis_script_url, function() {\n                                    layout.refreshAddThisElements();\n                                });\n                        } else {\n                            // Then addthis plugins are called\n                            layout.refreshAddThisElements();\n                        }\n                    }\n                }\n            };\n\n            SocialSharing.afterAppendView.install(plugin);\n            SocialSharing.afterAppendToDom.install(plugin);\n        }\n    }\n};\n\nexport = addthisPlugin;\n"]}