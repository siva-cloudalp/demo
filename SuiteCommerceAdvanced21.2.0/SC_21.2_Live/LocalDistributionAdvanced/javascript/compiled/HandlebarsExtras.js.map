{"version":3,"sources":["HandlebarsExtras.ts"],"names":[],"mappings":"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","file":"HandlebarsExtras.js","sourcesContent":["/*\n\tÂ© 2020 NetSuite Inc.\n\tUser may not copy, modify, distribute, or re-bundle or otherwise make available this code;\n\tprovided, however, if you are an authorized user with a NetSuite account or log-in, you\n\tmay use this code subject to the terms that govern your access and use.\n*/\n\n/// <amd-module name=\"HandlebarsExtras\"/>\n/// <reference path=\"../../Utilities/JavaScript/UnderscoreExtended.d.ts\"/>\n\nimport * as _ from 'underscore';\nimport * as Utils from '../../Utilities/JavaScript/Utils';\nimport * as jQuery from '../../Core/JavaScript/jQuery';\nimport { Configuration } from '../../Utilities/JavaScript/Configuration';\n\nimport Handlebars = require('../../Utilities/JavaScript/Handlebars');\nimport Backbone = require('../../Utilities/JavaScript/backbone.custom');\n\nHandlebars.registerHelper('getThemeAssetsPathWithDefault', function(img_path, default_img_path) {\n    if (img_path && img_path === Utils.getAbsoluteUrlOfNonManagedResources('')) {\n        img_path = null;\n    }\n\n    // If the theme path provided by the template's context is an url\n    // (and not a relative path) I'll use it as it's\n    // This is used for the local devtool in order to serve the assets locally\n    if (Utils.isUrlAbsolute(this._theme_path) && !img_path) {\n        return this._theme_path + default_img_path;\n    }\n\n    return Utils.getThemeAbsoluteUrlOfNonManagedResources(default_img_path, img_path);\n});\n\nHandlebars.registerHelper('getThemeAssetsPath', function(default_img_path) {\n    return Handlebars.helpers.getThemeAssetsPathWithDefault.apply(this, [null, default_img_path]);\n});\n\nHandlebars.registerHelper('getExtensionAssetsPathWithDefault', function(\n    img_path,\n    default_img_path\n) {\n    if (img_path && img_path !== Utils.getAbsoluteUrl()) {\n        return img_path;\n    }\n\n    // If the extension path provided by the template's context is an url (and not a relative path) I'll use it as it's\n    // This is used for the local devtool in order to serve the assets locally\n    if (Utils.isUrlAbsolute(this._extension_path)) {\n        return this._extension_path + default_img_path;\n    }\n\n    img_path = (this._extension_path || '') + default_img_path;\n    return Utils.getAbsoluteUrl(img_path);\n});\n\nHandlebars.registerHelper('getExtensionAssetsPath', function(default_img_path) {\n    return Handlebars.helpers.getExtensionAssetsPathWithDefault.apply(this, [\n        null,\n        default_img_path\n    ]);\n});\n\nHandlebars.registerHelper('translate', function() {\n    // NOTE: translate returns a safe string\n    return new Handlebars.SafeString(Utils.translate.apply(_, arguments));\n});\n\nHandlebars.registerHelper('highlightKeyword', function(text, keyword) {\n    // NOTE: highlightKeyword returns a safe string\n    return new Handlebars.SafeString(Utils.highlightKeyword(text, keyword));\n});\n\nconst objectToAttributesFn = function() {\n    // Note: object to attributes\n    return new Handlebars.SafeString(Utils.objectToAtrributes(this, ''));\n};\n\nHandlebars.registerHelper('objectToAtrributes', objectToAttributesFn);\nHandlebars.registerHelper('objectToAttributes', objectToAttributesFn);\n\n// define our own each helper with support for backbone collections\nHandlebars.registerHelper('each', function(context, options) {\n    let ret = '';\n    const iterable = context instanceof Backbone.Collection ? context.models : context;\n    const length = (iterable && iterable.length) || 0;\n\n    for (let i = 0, j = length; i < j; i++) {\n        ret += options.fn(iterable[i], {\n            data: {\n                first: i === 0,\n                last: i === iterable.length - 1,\n                index: i,\n                indexPlusOne: i + 1\n            }\n        });\n    }\n\n    if (!length) {\n        ret = options.inverse(this);\n    }\n\n    return ret;\n});\n\nHandlebars.registerHelper('resizeImage', function(url, size) {\n    url =\n        url ||\n        Utils.getThemeAbsoluteUrlOfNonManagedResources(\n            'img/no_image_available.jpeg',\n            Configuration.get('imageNotAvailable')\n        );\n    const mapped_size = Configuration['imageSizeMapping.' + size] || size;\n    return Utils.resizeImage(SC.ENVIRONMENT.siteSettings.imagesizes || [], url, mapped_size);\n});\n\nHandlebars.registerHelper('trimHtml', function(htmlString, length) {\n    let htmlStringSelector;\n\n    try {\n        htmlStringSelector = jQuery(htmlString);\n    } catch (e) {}\n\n    const trimmedString =\n        htmlStringSelector && htmlStringSelector.length > 0\n            ? String(htmlStringSelector.text()).trim()\n            : String(htmlString).trim();\n    let moreContent = '';\n\n    if (trimmedString.length > length) {\n        moreContent = '...';\n    }\n\n    return trimmedString.substring(0, length) + moreContent;\n});\n\n// Helper 'breaklines' places <br/> tags instead of the newlines provided by backend\n// Used in messages in Quotes, Return, Case, Review.\nHandlebars.registerHelper('breaklines', function(text) {\n    text = Handlebars.Utils.escapeExpression(text || '');\n    text = text.replace(/(\\r\\n|\\n|\\r|\\u0005)/gm, '<br/>');\n    return new Handlebars.SafeString(text);\n});\n\n// Helper 'ifEqual' works like if (v1 == v2) {} else {}\nHandlebars.registerHelper('ifEquals', function(v1, v2, options) {\n    /* jslint eqeq: true*/\n    if (v1 == v2) {\n        return options.fn(this);\n    }\n    return options.inverse(this);\n});\n\n// Helper 'unlessEqual' works like if (v1 != v2) {} else {}\nHandlebars.registerHelper('unlessEquals', function(v1, v2, options) {\n    /* jslint eqeq: false*/\n    if (v1 != v2) {\n        return options.fn(this);\n    }\n    return options.inverse(this);\n});\n\nHandlebars.registerHelper('formatCurrency', function(amount, symbol) {\n    // Handlebars sets an object as the last arguement.\n    // If formatCurrency was called with one argument, second argument won't be the expected string symbol\n    if (typeof symbol === 'string') {\n        return Utils.formatCurrency(amount, symbol);\n    }\n    return Utils.formatCurrency(amount);\n});\n\nHandlebars.registerHelper('if_even', function(conditional, options) {\n    if (conditional % 2 === 0) {\n        return options.fn(this);\n    }\n    return options.inverse(this);\n});\n\nHandlebars.registerHelper('if_odd', function(conditional, options) {\n    return conditional % 2 !== 0 ? options.fn(this) : options.inverse(this);\n});\n"]}